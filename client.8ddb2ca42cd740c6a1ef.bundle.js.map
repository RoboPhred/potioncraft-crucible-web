{"version":3,"file":"client.8ddb2ca42cd740c6a1ef.bundle.js","mappings":"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","sources":["webpack://potioncraft-crucible-web/./src/components/Button/Button.module.css?a282","webpack://potioncraft-crucible-web/./src/components/Checkbox/Checkbox.module.css?4fe9","webpack://potioncraft-crucible-web/./src/components/ColorButton/ColorButton.module.css?be06","webpack://potioncraft-crucible-web/./src/components/Divider/Divider.module.css?9c3e","webpack://potioncraft-crucible-web/./src/components/FieldBox/FieldBox.module.css?0c66","webpack://potioncraft-crucible-web/./src/components/Flow/Flow.module.css?c7c3","webpack://potioncraft-crucible-web/./src/components/ImageField/ImageField.module.css?cbc0","webpack://potioncraft-crucible-web/./src/components/MapEditorToolbar/MapEditorToolbar.module.css?6ae1","webpack://potioncraft-crucible-web/./src/components/MapEditorToolbar/components/EntitiesDropButton/EntitiesDropButton.module.css?7761","webpack://potioncraft-crucible-web/./src/components/MapEditor/MapEditor.module.css?4c56","webpack://potioncraft-crucible-web/./src/components/MapEditor/components/DragPreview/DragPreview.module.css?695a","webpack://potioncraft-crucible-web/./src/components/MapEditor/components/MapCanvas.module.css?0101","webpack://potioncraft-crucible-web/./src/components/MapEditor/components/MapWidgets/MapWidgets.module.css?039a","webpack://potioncraft-crucible-web/./src/components/MapEditor/components/PanZoomHandler/PanZoomHandler.module.css?8fc8","webpack://potioncraft-crucible-web/./src/components/Menus/Menus.module.css?27a7","webpack://potioncraft-crucible-web/./src/components/Modal/Modal.module.css?d409","webpack://potioncraft-crucible-web/./src/components/Page/Page.module.css?94f5","webpack://potioncraft-crucible-web/./src/components/TextArea/TextArea.module.css?4a29","webpack://potioncraft-crucible-web/./src/components/TextBox/TextBox.module.css?3cb2","webpack://potioncraft-crucible-web/./src/components/TitleBar/TitleBar.module.css?c6e3","webpack://potioncraft-crucible-web/./src/components/Tooltip/Tooltip.module.css?a017","webpack://potioncraft-crucible-web/./src/components/Tree/Tree.module.css?3368","webpack://potioncraft-crucible-web/./src/pages/home/views/NoPackageView/NoPackageView.module.css?3027","webpack://potioncraft-crucible-web/./src/pages/home/views/PackageView/PackageView.module.css?1ff0","webpack://potioncraft-crucible-web/./src/pages/potionbase-mapeditor/components/MapWindow/MapWindow.module.css?c6c6","webpack://potioncraft-crucible-web/./src/pages/potionbase/PotionBasePage.module.css?30d0","webpack://potioncraft-crucible-web/./src/pages/potionbase/components/PotionBaseColor/PotionBaseColor.module.css?d3ff","webpack://potioncraft-crucible-web/./src/pages/potionbase/components/PotionBaseDescription/PotionBaseDescription.module.css?1293","webpack://potioncraft-crucible-web/./src/pages/potionbase/components/PotionBaseIcons/PotionBaseIcons.module.css?1dd7","webpack://potioncraft-crucible-web/./src/pages/potionbase/components/PotionBaseName/PotionBaseName.module.css?2bed","webpack://potioncraft-crucible-web/./src/pages/potionbase/components/PotionBaseTooltipImage/PotionBaseTooltipImage.module.css?6fea","webpack://potioncraft-crucible-web/./src/pages/potionbottle/PotionBottlePage.module.css?8ffd","webpack://potioncraft-crucible-web/./src/pages/potionbottle/components/PotionBottleLiquidEditor/PotionBottleLiquidEditor.module.css?c1ab","webpack://potioncraft-crucible-web/./src/pages/potioneffect/PotionEffectPage.module.css?7b59","webpack://potioncraft-crucible-web/./src/pages/potioneffect/components/PotionEffectColor/PotionEffectColor.module.css?35ee","webpack://potioncraft-crucible-web/./src/actions/editors/commit-queue.ts","webpack://potioncraft-crucible-web/./src/actions/editors/commit.ts","webpack://potioncraft-crucible-web/./src/actions/initialize.ts","webpack://potioncraft-crucible-web/./src/actions/map-editor/entity-delete.ts","webpack://potioncraft-crucible-web/./src/actions/map-editor/entity-insert.ts","webpack://potioncraft-crucible-web/./src/actions/map-editor/entity-offset.ts","webpack://potioncraft-crucible-web/./src/actions/map-editor/entity-prototype-instantiate.ts","webpack://potioncraft-crucible-web/./src/actions/map-editor/map-clear.ts","webpack://potioncraft-crucible-web/./src/actions/map-editor/map-import-template.ts","webpack://potioncraft-crucible-web/./src/actions/map-editor/map-receive.ts","webpack://potioncraft-crucible-web/./src/actions/map-editor/modifierkeys-changed.ts","webpack://potioncraft-crucible-web/./src/actions/map-editor/mouse-down.ts","webpack://potioncraft-crucible-web/./src/actions/map-editor/mouse-move.ts","webpack://potioncraft-crucible-web/./src/actions/map-editor/mouse-out.ts","webpack://potioncraft-crucible-web/./src/actions/map-editor/mouse-up.ts","webpack://potioncraft-crucible-web/./src/actions/map-editor/pan.ts","webpack://potioncraft-crucible-web/./src/actions/map-editor/rendered.ts","webpack://potioncraft-crucible-web/./src/actions/map-editor/select-clear.ts","webpack://potioncraft-crucible-web/./src/actions/map-editor/select-entity.ts","webpack://potioncraft-crucible-web/./src/actions/map-editor/selection-delete.ts","webpack://potioncraft-crucible-web/./src/actions/map-editor/tool-radius-set.ts","webpack://potioncraft-crucible-web/./src/actions/map-editor/tool-set.ts","webpack://potioncraft-crucible-web/./src/actions/map-editor/viewport-resize.ts","webpack://potioncraft-crucible-web/./src/actions/map-editor/zoom.ts","webpack://potioncraft-crucible-web/./src/actions/navigation/navtree-expanded-set.ts","webpack://potioncraft-crucible-web/./src/actions/packages/package-data-set-byid.ts","webpack://potioncraft-crucible-web/./src/actions/packages/package-data-set.ts","webpack://potioncraft-crucible-web/./src/actions/packages/package-idobject-new.ts","webpack://potioncraft-crucible-web/./src/actions/packages/package-load-error.ts","webpack://potioncraft-crucible-web/./src/actions/packages/package-load-file.ts","webpack://potioncraft-crucible-web/./src/actions/packages/package-new.ts","webpack://potioncraft-crucible-web/./src/actions/packages/package-receive.ts","webpack://potioncraft-crucible-web/./src/actions/packages/package-resource-set-byid.ts","webpack://potioncraft-crucible-web/./src/actions/packages/package-save.ts","webpack://potioncraft-crucible-web/./src/actions/potion-bases/map-edit.ts","webpack://potioncraft-crucible-web/./src/actions/set-language.ts","webpack://potioncraft-crucible-web/./src/arrays.ts","webpack://potioncraft-crucible-web/./src/canvas.ts","webpack://potioncraft-crucible-web/./src/components/AbstractFileLoadButton.tsx","webpack://potioncraft-crucible-web/./src/components/AutoPopper.tsx","webpack://potioncraft-crucible-web/./src/components/Button/Button.tsx","webpack://potioncraft-crucible-web/./src/components/Button/LinkButton.tsx","webpack://potioncraft-crucible-web/./src/components/Button/index.ts","webpack://potioncraft-crucible-web/./src/components/Checkbox/Checkbox.tsx","webpack://potioncraft-crucible-web/./src/components/Checkbox/index.ts","webpack://potioncraft-crucible-web/./src/components/ColorButton/ColorButton.tsx","webpack://potioncraft-crucible-web/./src/components/ColorButton/index.ts","webpack://potioncraft-crucible-web/./src/components/CommitTextArea.tsx","webpack://potioncraft-crucible-web/./src/components/CommitTextBox.tsx","webpack://potioncraft-crucible-web/./src/components/DefaultTitlebarContent.tsx","webpack://potioncraft-crucible-web/./src/components/Divider/Divider.tsx","webpack://potioncraft-crucible-web/./src/components/Divider/index.ts","webpack://potioncraft-crucible-web/./src/components/EnsurePackageLoaded.tsx","webpack://potioncraft-crucible-web/./src/components/FieldBox/FieldBox.tsx","webpack://potioncraft-crucible-web/./src/components/FieldBox/index.ts","webpack://potioncraft-crucible-web/./src/components/Flow/Flow.tsx","webpack://potioncraft-crucible-web/./src/components/Flow/index.ts","webpack://potioncraft-crucible-web/./src/components/IdObjectResourceField/IdObjectResourceField.tsx","webpack://potioncraft-crucible-web/./src/components/IdObjectResourceField/index.ts","webpack://potioncraft-crucible-web/./src/components/ImageField/ImageField.tsx","webpack://potioncraft-crucible-web/./src/components/ImageField/index.ts","webpack://potioncraft-crucible-web/./src/components/MapEditorToolbar/MapEditorToolBar.tsx","webpack://potioncraft-crucible-web/./src/components/MapEditorToolbar/components/BonesDropButton.tsx","webpack://potioncraft-crucible-web/./src/components/MapEditorToolbar/components/EntitiesDropButton/EntitiesDropButton.tsx","webpack://potioncraft-crucible-web/./src/components/MapEditorToolbar/components/EntitiesDropButton/EntitiesDropList.tsx","webpack://potioncraft-crucible-web/./src/components/MapEditorToolbar/components/EntitiesDropButton/index.ts","webpack://potioncraft-crucible-web/./src/components/MapEditorToolbar/components/PotionEffectsDropButton.tsx","webpack://potioncraft-crucible-web/./src/components/MapEditorToolbar/components/VortexesDropButton.tsx","webpack://potioncraft-crucible-web/./src/components/MapEditorToolbar/index.ts","webpack://potioncraft-crucible-web/./src/components/MapEditor/MapEditor.tsx","webpack://potioncraft-crucible-web/./src/components/MapEditor/components/DragPreview/DragPreview.tsx","webpack://potioncraft-crucible-web/./src/components/MapEditor/components/DragPreview/index.ts","webpack://potioncraft-crucible-web/./src/components/MapEditor/components/MapCanvas.tsx","webpack://potioncraft-crucible-web/./src/components/MapEditor/components/MapWidgets/MapWidgets.tsx","webpack://potioncraft-crucible-web/./src/components/MapEditor/components/MapWidgets/index.ts","webpack://potioncraft-crucible-web/./src/components/MapEditor/components/PanZoomHandler/PanZoomHandler.tsx","webpack://potioncraft-crucible-web/./src/components/MapEditor/components/PanZoomHandler/index.ts","webpack://potioncraft-crucible-web/./src/components/MapEditor/index.ts","webpack://potioncraft-crucible-web/./src/components/MapEditor/keymap.ts","webpack://potioncraft-crucible-web/./src/components/Menus/DividerMenuItem.tsx","webpack://potioncraft-crucible-web/./src/components/Menus/Menu.tsx","webpack://potioncraft-crucible-web/./src/components/Menus/MenuCloseContext.tsx","webpack://potioncraft-crucible-web/./src/components/Menus/MenuItem.tsx","webpack://potioncraft-crucible-web/./src/components/Menus/SubMenuItem.tsx","webpack://potioncraft-crucible-web/./src/components/Modal/Modal.tsx","webpack://potioncraft-crucible-web/./src/components/Modal/index.ts","webpack://potioncraft-crucible-web/./src/components/PackageContentTree.tsx","webpack://potioncraft-crucible-web/./src/components/PackageMenuButton.tsx","webpack://potioncraft-crucible-web/./src/components/Page/Page.tsx","webpack://potioncraft-crucible-web/./src/components/Page/index.ts","webpack://potioncraft-crucible-web/./src/components/Popper/Popper.tsx","webpack://potioncraft-crucible-web/./src/components/Popper/PopperChildContext.tsx","webpack://potioncraft-crucible-web/./src/components/Popper/index.ts","webpack://potioncraft-crucible-web/./src/components/TextArea/TextArea.tsx","webpack://potioncraft-crucible-web/./src/components/TextArea/index.ts","webpack://potioncraft-crucible-web/./src/components/TextBox/TextBox.tsx","webpack://potioncraft-crucible-web/./src/components/TextBox/index.ts","webpack://potioncraft-crucible-web/./src/components/TitleBar/TitleBar.tsx","webpack://potioncraft-crucible-web/./src/components/TitleBar/index.ts","webpack://potioncraft-crucible-web/./src/components/Tooltip/Tooltip.tsx","webpack://potioncraft-crucible-web/./src/components/Tree/LinkTreeItem.tsx","webpack://potioncraft-crucible-web/./src/components/Tree/Tree.tsx","webpack://potioncraft-crucible-web/./src/components/Tree/TreeChildContext.tsx","webpack://potioncraft-crucible-web/./src/components/Tree/TreeItem.tsx","webpack://potioncraft-crucible-web/./src/drag-items/new-entity.ts","webpack://potioncraft-crucible-web/./src/entities/consts.ts","webpack://potioncraft-crucible-web/./src/entities/defs/DangerZonePart/DangerZonePart.ts","webpack://potioncraft-crucible-web/./src/entities/defs/DangerZonePart/index.ts","webpack://potioncraft-crucible-web/./src/entities/defs/ExperienceBonus.ts","webpack://potioncraft-crucible-web/./src/entities/defs/PotionEffect.ts","webpack://potioncraft-crucible-web/./src/entities/defs/Vortex.ts","webpack://potioncraft-crucible-web/./src/entities/defs/index.ts","webpack://potioncraft-crucible-web/./src/entities/index.ts","webpack://potioncraft-crucible-web/./src/entities/tiles/index.ts","webpack://potioncraft-crucible-web/./src/fp-set.ts","webpack://potioncraft-crucible-web/./src/geometry.ts","webpack://potioncraft-crucible-web/./src/history.ts","webpack://potioncraft-crucible-web/./src/hooks/use-action.ts","webpack://potioncraft-crucible-web/./src/hooks/use-array-state.ts","webpack://potioncraft-crucible-web/./src/hooks/use-boolean-state.ts","webpack://potioncraft-crucible-web/./src/hooks/use-component-bounds.ts","webpack://potioncraft-crucible-web/./src/hooks/use-native-event.ts","webpack://potioncraft-crucible-web/./src/hooks/use-outside-mouse-event.ts","webpack://potioncraft-crucible-web/./src/hooks/use-selector.ts","webpack://potioncraft-crucible-web/./src/index.tsx","webpack://potioncraft-crucible-web/./src/link-utils.ts","webpack://potioncraft-crucible-web/./src/map-templates/index.ts","webpack://potioncraft-crucible-web/./src/modifier-keys.ts","webpack://potioncraft-crucible-web/./src/object-utils.ts","webpack://potioncraft-crucible-web/./src/pages/home/HomePage.tsx","webpack://potioncraft-crucible-web/./src/pages/home/index.ts","webpack://potioncraft-crucible-web/./src/pages/home/views/LoadErrorView.tsx","webpack://potioncraft-crucible-web/./src/pages/home/views/LoadingPackageView.tsx","webpack://potioncraft-crucible-web/./src/pages/home/views/NoPackageView/NoPackageView.tsx","webpack://potioncraft-crucible-web/./src/pages/home/views/NoPackageView/index.ts","webpack://potioncraft-crucible-web/./src/pages/home/views/PackageView/PackageView.tsx","webpack://potioncraft-crucible-web/./src/pages/home/views/PackageView/index.ts","webpack://potioncraft-crucible-web/./src/pages/ingredient-list/IngredientsListPage.tsx","webpack://potioncraft-crucible-web/./src/pages/ingredient-list/index.ts","webpack://potioncraft-crucible-web/./src/pages/potionbase-list/PotionBaseListPage.tsx","webpack://potioncraft-crucible-web/./src/pages/potionbase-list/index.ts","webpack://potioncraft-crucible-web/./src/pages/potionbase-mapeditor/PotionBaseMapEditorPage.tsx","webpack://potioncraft-crucible-web/./src/pages/potionbase-mapeditor/components/MapMenuButton.tsx","webpack://potioncraft-crucible-web/./src/pages/potionbase-mapeditor/components/MapWindow/MapWindow.tsx","webpack://potioncraft-crucible-web/./src/pages/potionbase-mapeditor/components/MapWindow/index.ts","webpack://potioncraft-crucible-web/./src/pages/potionbase-mapeditor/index.ts","webpack://potioncraft-crucible-web/./src/pages/potionbase/PotionBasePage.tsx","webpack://potioncraft-crucible-web/./src/pages/potionbase/components/PotionBaseColor/PotionBaseColor.tsx","webpack://potioncraft-crucible-web/./src/pages/potionbase/components/PotionBaseColor/index.ts","webpack://potioncraft-crucible-web/./src/pages/potionbase/components/PotionBaseDescription/PotionBaseDescription.tsx","webpack://potioncraft-crucible-web/./src/pages/potionbase/components/PotionBaseIcons/PotionBaseIcons.tsx","webpack://potioncraft-crucible-web/./src/pages/potionbase/components/PotionBaseName/PotionBaseName.tsx","webpack://potioncraft-crucible-web/./src/pages/potionbase/components/PotionBaseTooltipImage/PotionBaseTooltipImage.tsx","webpack://potioncraft-crucible-web/./src/pages/potionbase/index.ts","webpack://potioncraft-crucible-web/./src/pages/potionbottle-list/PotionBottleListPage.tsx","webpack://potioncraft-crucible-web/./src/pages/potionbottle-list/index.ts","webpack://potioncraft-crucible-web/./src/pages/potionbottle/PotionBottlePage.tsx","webpack://potioncraft-crucible-web/./src/pages/potionbottle/components/PotionBottleForeground.tsx","webpack://potioncraft-crucible-web/./src/pages/potionbottle/components/PotionBottleIcon.tsx","webpack://potioncraft-crucible-web/./src/pages/potionbottle/components/PotionBottleLiquidEditor/PotionBottleLiquidEditor.tsx","webpack://potioncraft-crucible-web/./src/pages/potionbottle/components/PotionBottleLiquidEditor/index.ts","webpack://potioncraft-crucible-web/./src/pages/potionbottle/components/PotionBottleMask.tsx","webpack://potioncraft-crucible-web/./src/pages/potionbottle/index.ts","webpack://potioncraft-crucible-web/./src/pages/potioneffect-list/PotionEffectListPage.tsx","webpack://potioncraft-crucible-web/./src/pages/potioneffect-list/index.ts","webpack://potioncraft-crucible-web/./src/pages/potioneffect/PotionEffectPage.tsx","webpack://potioncraft-crucible-web/./src/pages/potioneffect/components/PotionEffectColor/PotionEffectColor.tsx","webpack://potioncraft-crucible-web/./src/pages/potioneffect/components/PotionEffectColor/index.ts","webpack://potioncraft-crucible-web/./src/pages/potioneffect/components/PotionEffectIcon.tsx","webpack://potioncraft-crucible-web/./src/pages/potioneffect/components/PotionEffectName.tsx","webpack://potioncraft-crucible-web/./src/pages/potioneffect/index.ts","webpack://potioncraft-crucible-web/./src/paths.ts","webpack://potioncraft-crucible-web/./src/reducer/index.ts","webpack://potioncraft-crucible-web/./src/reducer/priorities.ts","webpack://potioncraft-crucible-web/./src/reducer/utils.ts","webpack://potioncraft-crucible-web/./src/root.tsx","webpack://potioncraft-crucible-web/./src/routes.tsx","webpack://potioncraft-crucible-web/./src/runtime-env.ts","webpack://potioncraft-crucible-web/./src/selection-mode.ts","webpack://potioncraft-crucible-web/./src/services/commit-queue/saga/commit-queue.ts","webpack://potioncraft-crucible-web/./src/services/commit-queue/saga/index.ts","webpack://potioncraft-crucible-web/./src/services/i18n/components/I18NProvider.tsx","webpack://potioncraft-crucible-web/./src/services/i18n/i18n.ts","webpack://potioncraft-crucible-web/./src/services/i18n/persist.ts","webpack://potioncraft-crucible-web/./src/services/i18n/reducer/index.ts","webpack://potioncraft-crucible-web/./src/services/i18n/reducer/set-language.ts","webpack://potioncraft-crucible-web/./src/services/i18n/selectors/language.ts","webpack://potioncraft-crucible-web/./src/services/i18n/state-utils.ts","webpack://potioncraft-crucible-web/./src/services/i18n/state.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/damage/reducer/editor-rendered.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/damage/reducer/editor-viewport.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/damage/reducer/entity-delete.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/damage/reducer/entity-insert.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/damage/reducer/entity-offset.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/damage/reducer/entity-prototype-instantiate.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/damage/reducer/index.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/damage/reducer/map-clear.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/damage/reducer/map-import-template.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/damage/reducer/map-receive.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/damage/reducer/select-clear.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/damage/reducer/select-entity.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/damage/selector/damage.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/damage/state-utils.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/damage/state.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/entities/reducer/entity-delete.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/entities/reducer/entity-insert.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/entities/reducer/entity-offset.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/entities/reducer/index.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/entities/reducer/map-clear.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/entities/reducer/map-import-template.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/entities/reducer/map-receive.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/entities/reducer/prototype-instantiate.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/entities/regions.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/entities/selectors/entities.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/entities/selectors/prototypes.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/entities/selectors/render-resources.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/entities/state-utils.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/entities/state.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/mouse/reducer/index.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/mouse/reducer/modifierkeys-changed.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/mouse/reducer/mouse-down.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/mouse/reducer/mouse-move.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/mouse/reducer/mouse-out.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/mouse/reducer/mouse-up.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/mouse/reducer/tool-radius-set.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/mouse/reducer/tool-set.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/mouse/selectors/drag-move.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/mouse/selectors/drag-select.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/mouse/selectors/tools.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/mouse/selectors/viewport.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/mouse/selectors/world-coords.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/mouse/state-utils.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/mouse/state.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/reducer/index.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/reducer/mapeditor-map-edit.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/reducer/package-new.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/reducer/package-receive.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/saga/editor-commit.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/saga/index.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/saga/map-modify.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/saga/mapeditor-map-edit.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/selection/reducer/entity-delete.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/selection/reducer/index.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/selection/reducer/select-clear.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/selection/reducer/select-entity.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/selection/reducer/selection-delete.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/selection/selectors/selection.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/selection/state-utils.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/selection/state.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/selectors.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/state-utils.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/state.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/view/hooks/use-client-to-world.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/view/reducer/index.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/view/reducer/pan.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/view/reducer/viewport-resize.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/view/reducer/zoom.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/view/selectors/coordinate-mapping.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/view/selectors/view.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/view/selectors/viewport.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/view/state-utils.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/view/state.ts","webpack://potioncraft-crucible-web/./src/services/map-editor/view/utils.ts","webpack://potioncraft-crucible-web/./src/services/navigation/reducer/index.ts","webpack://potioncraft-crucible-web/./src/services/navigation/reducer/navtree-expanded-set.ts","webpack://potioncraft-crucible-web/./src/services/navigation/selectors.ts","webpack://potioncraft-crucible-web/./src/services/navigation/state-utils.ts","webpack://potioncraft-crucible-web/./src/services/navigation/state.ts","webpack://potioncraft-crucible-web/./src/services/package/hooks/use-idobject-resource.ts","webpack://potioncraft-crucible-web/./src/services/package/hooks/use-load-package.ts","webpack://potioncraft-crucible-web/./src/services/package/reducer/index.ts","webpack://potioncraft-crucible-web/./src/services/package/reducer/package-data-set-byid.ts","webpack://potioncraft-crucible-web/./src/services/package/reducer/package-data-set.ts","webpack://potioncraft-crucible-web/./src/services/package/reducer/package-idobject-new.ts","webpack://potioncraft-crucible-web/./src/services/package/reducer/package-load-error.ts","webpack://potioncraft-crucible-web/./src/services/package/reducer/package-load-file.ts","webpack://potioncraft-crucible-web/./src/services/package/reducer/package-new.ts","webpack://potioncraft-crucible-web/./src/services/package/reducer/package-receive.ts","webpack://potioncraft-crucible-web/./src/services/package/reducer/package-resource-set-byid.ts","webpack://potioncraft-crucible-web/./src/services/package/saga/index.ts","webpack://potioncraft-crucible-web/./src/services/package/saga/package-load-file.ts","webpack://potioncraft-crucible-web/./src/services/package/saga/package-save.ts","webpack://potioncraft-crucible-web/./src/services/package/selectors/package.ts","webpack://potioncraft-crucible-web/./src/services/package/selectors/resources.ts","webpack://potioncraft-crucible-web/./src/services/package/state-utils.ts","webpack://potioncraft-crucible-web/./src/services/package/state.ts","webpack://potioncraft-crucible-web/./src/services/reducer.ts","webpack://potioncraft-crucible-web/./src/services/saga.ts","webpack://potioncraft-crucible-web/./src/services/state-utils.ts","webpack://potioncraft-crucible-web/./src/services/state.ts","webpack://potioncraft-crucible-web/./src/services/yaml/api.ts","webpack://potioncraft-crucible-web/./src/state/index.ts","webpack://potioncraft-crucible-web/./src/state/utils.ts","webpack://potioncraft-crucible-web/./src/store/components/StoreProvider.tsx","webpack://potioncraft-crucible-web/./src/store/devtool-sanitizer.ts","webpack://potioncraft-crucible-web/./src/store/persist.ts","webpack://potioncraft-crucible-web/./src/store/saga.ts","webpack://potioncraft-crucible-web/./src/store/store.ts","webpack://potioncraft-crucible-web/./src/styles/index.ts","webpack://potioncraft-crucible-web/./src/text-encoding.ts"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"button\":\"button--AisLs\",\"button-content\":\"button-content--KzVM6\",\"disabled\":\"disabled--v8v84\",\"button--size-small\":\"button--size-small--LL1uc\",\"button--variant-primary\":\"button--variant-primary--2NXnj\",\"button--variant-default\":\"button--variant-default--DXnZG\",\"button--variant-text\":\"button--variant-text--W2TEX\",\"button--variant-menu\":\"button--variant-menu--aFzH4\"};","// extracted by mini-css-extract-plugin\nexport default {\"checkbox-input\":\"checkbox-input--uHHvS\",\"checkbox-icon\":\"checkbox-icon--ycch5\",\"checkbox-label\":\"checkbox-label--xUJLs\"};","// extracted by mini-css-extract-plugin\nexport default {\"colorbutton-svg\":\"colorbutton-svg--nh4hD\",\"colorbutton-label\":\"colorbutton-label--RSpGm\"};","// extracted by mini-css-extract-plugin\nexport default {\"divider\":\"divider--lKbkM\",\"divider--horizontal\":\"divider--horizontal--B2Vr8\",\"divider--vertical\":\"divider--vertical--lwqfu\",\"divider-line\":\"divider-line--DfWwB\"};","// extracted by mini-css-extract-plugin\nexport default {\"fieldbox\":\"fieldbox--rmVj8\",\"fieldbox-label\":\"fieldbox-label--pny0n\",\"fieldbox-content\":\"fieldbox-content--BKQJp\"};","// extracted by mini-css-extract-plugin\nexport default {\"flow--vertical\":\"flow--vertical--REOIz\"};","// extracted by mini-css-extract-plugin\nexport default {\"imagefield\":\"imagefield--mO_g5\",\"imagefield-upload\":\"imagefield-upload--HqT6h\",\"imagefield--has-image\":\"imagefield--has-image--tq1HW\",\"imagefield-image-container\":\"imagefield-image-container--Ox1pi\"};","// extracted by mini-css-extract-plugin\nexport default {\"map-toolbar\":\"map-toolbar--I9E7w\",\"map-toolbar-entities\":\"map-toolbar-entities--On_Rc\"};","// extracted by mini-css-extract-plugin\nexport default {\"entities-drop-button\":\"entities-drop-button--UK6Mc\",\"entities-drop-list\":\"entities-drop-list--e8Odv\",\"entities-drop-list-item\":\"entities-drop-list-item--ueJbI\"};","// extracted by mini-css-extract-plugin\nexport default {\"map-editor\":\"map-editor--kUf0l\",\"hotkeys-container\":\"hotkeys-container--SGx4q\",\"map-editor-container\":\"map-editor-container--TqInP\",\"map-editor-item\":\"map-editor-item--zUxb3\"};","// extracted by mini-css-extract-plugin\nexport default {\"drag-preview\":\"drag-preview--FZPs4\"};","// extracted by mini-css-extract-plugin\nexport default {\"map-canvas\":\"map-canvas--v5nim\"};","// extracted by mini-css-extract-plugin\nexport default {\"map-widgets\":\"map-widgets--oakLP\"};","// extracted by mini-css-extract-plugin\nexport default {\"pan-zoom-handler\":\"pan-zoom-handler--afGPu\"};","// extracted by mini-css-extract-plugin\nexport default {\"menu\":\"menu--TLS_C\",\"menu-item\":\"menu-item--TCx3P\",\"menu-item--disabled\":\"menu-item--disabled--scw6v\",\"menu-item-content\":\"menu-item-content--oAHNE\",\"menu-item-text\":\"menu-item-text--ypKRN\",\"menu-item-secondary\":\"menu-item-secondary--RZxVA\",\"menu-item-icon\":\"menu-item-icon--VLMV_\",\"menu-divider\":\"menu-divider--B1Pmy\"};","// extracted by mini-css-extract-plugin\nexport default {\"modal\":\"modal--hTXcZ\",\"modal-content\":\"modal-content--CRmm7\",\"modal-autofocus\":\"modal-autofocus--ibvEW\"};","// extracted by mini-css-extract-plugin\nexport default {\"page\":\"page--LVMNK\",\"page-content\":\"page-content--m0AM_\",\"package-content\":\"package-content--TH1h2\",\"page-children\":\"page-children--j6e6d\"};","// extracted by mini-css-extract-plugin\nexport default {\"textarea\":\"textarea--akhKg\",\"textarea-edge-left\":\"textarea-edge-left--Bbone\",\"textarea-edge-right\":\"textarea-edge-right--iVFwW\",\"textarea-wrapper\":\"textarea-wrapper--LNJqP\",\"textarea-input\":\"textarea-input--A7Nah\"};","// extracted by mini-css-extract-plugin\nexport default {\"textbox-input\":\"textbox-input--u9Oc8\"};","// extracted by mini-css-extract-plugin\nexport default {\"titlebar\":\"titlebar--iQnDM\",\"titlebar-heading\":\"titlebar-heading--CKvDN\",\"titlebar-divider\":\"titlebar-divider--K1ZmQ\",\"titlebar-title\":\"titlebar-title--tRYGh\"};","// extracted by mini-css-extract-plugin\nexport default {\"tooltip\":\"tooltip--Km6UU\",\"tooltip-arrow\":\"tooltip-arrow--YCNPE\"};","// extracted by mini-css-extract-plugin\nexport default {\"tree\":\"tree--bfK4V\",\"tree-item\":\"tree-item--uHp4J\",\"tree-item-chevron\":\"tree-item-chevron--NYlbP\",\"tree-item-nochevron\":\"tree-item-nochevron--pp5pJ\",\"tree-item-content\":\"tree-item-content--P2OzT\",\"tree-item-content--selected\":\"tree-item-content--selected--NHhZr\",\"tree-item-label\":\"tree-item-label--NR835\",\"tree-item-children\":\"tree-item-children--gPKj0\"};","// extracted by mini-css-extract-plugin\nexport default {\"text\":\"text--EnZYC\"};","// extracted by mini-css-extract-plugin\nexport default {\"package-editor-content\":\"package-editor-content--9h2wd\",\"package-editor-field\":\"package-editor-field--QEYLj\"};","// extracted by mini-css-extract-plugin\nexport default {\"map-window-container\":\"map-window-container--vwVI2\",\"map-window-editor\":\"map-window-editor--K747t\",\"map-window-toolbar\":\"map-window-toolbar--c5f47\"};","// extracted by mini-css-extract-plugin\nexport default {\"potionbase-editor-content\":\"potionbase-editor-content--l6JRm\",\"potionbase-editor-overview\":\"potionbase-editor-overview--nN3hX\",\"potioncraft-editor-description\":\"potioncraft-editor-description--HJBbm\",\"potionbase-editor-icons\":\"potionbase-editor-icons--yQj1t\",\"potionbase-editor-settings\":\"potionbase-editor-settings--OKTRZ\",\"potionbase-editor-map\":\"potionbase-editor-map--vUVeX\"};","// extracted by mini-css-extract-plugin\nexport default {\"potionbase-liquidcolor\":\"potionbase-liquidcolor--caDp5\"};","// extracted by mini-css-extract-plugin\nexport default {\"potionbasedescription\":\"potionbasedescription--vED2n\",\"potionbasedescription-input\":\"potionbasedescription-input--stzBi\"};","// extracted by mini-css-extract-plugin\nexport default {\"potionbaseicons\":\"potionbaseicons--TNKqO\",\"potionbaseicons-imagefield\":\"potionbaseicons-imagefield--jGVji\",\"potionbaseicons-imagetext\":\"potionbaseicons-imagetext--OAnBt\"};","// extracted by mini-css-extract-plugin\nexport default {\"potionbasename-input\":\"potionbasename-input--CV82N\"};","// extracted by mini-css-extract-plugin\nexport default {\"potionbasetooltipimage\":\"potionbasetooltipimage--DrlVG\"};","// extracted by mini-css-extract-plugin\nexport default {\"potionbottle-content\":\"potionbottle-content--R3cLe\",\"potionbottle-section\":\"potionbottle-section--W_OL0\",\"potionbottle-icon\":\"potionbottle-icon--PAYxc\",\"potionbottle-bottleart\":\"potionbottle-bottleart--RAYx_\",\"potionbottle-section-item\":\"potionbottle-section-item--shrye\",\"potionbottle-section-title\":\"potionbottle-section-title--OpqOg\",\"potionbottle-section-art\":\"potionbottle-section-art--uF13G\"};","// extracted by mini-css-extract-plugin\nexport default {\"liquidpreview\":\"liquidpreview--dpdwS\",\"liquidpreview-art\":\"liquidpreview-art--c0Lxt\",\"liquidpreview-label\":\"liquidpreview-label--DlPlQ\",\"liquidpreview-effect\":\"liquidpreview-effect--hNkha\",\"liquidpreview-effect-1\":\"liquidpreview-effect-1--_A0ON\",\"liquidpreview-effect-2\":\"liquidpreview-effect-2--yGQ_q\",\"liquidpreview-effect-3\":\"liquidpreview-effect-3--wDJV9\",\"liquidpreview-effect-4\":\"liquidpreview-effect-4--BQe3L\",\"liquidpreview-effect-5\":\"liquidpreview-effect-5--UHGrC\",\"liquidpreview-assets\":\"liquidpreview-assets--JoVrq\"};","// extracted by mini-css-extract-plugin\nexport default {\"potioneffect-content\":\"potioneffect-content--bh_6r\"};","// extracted by mini-css-extract-plugin\nexport default {\"potioncolor-button\":\"potioncolor-button--MhxPN\"};","import { AnyAction } from \"redux\";\r\n\r\nexport const ACTION_EDITOR_COMMIT_QUEUE = \"editor-commit-queue\" as const;\r\nexport const editorCommitQueue = () => ({\r\n  type: ACTION_EDITOR_COMMIT_QUEUE,\r\n});\r\nexport type EditorCommitQueueAction = ReturnType<typeof editorCommitQueue>;\r\nexport function isEditorCommitQueueAction(\r\n  action: AnyAction\r\n): action is EditorCommitQueueAction {\r\n  return action.type === ACTION_EDITOR_COMMIT_QUEUE;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nexport const ACTION_EDITOR_COMMIT = \"editor-commit\" as const;\r\nexport const editorCommit = () => ({\r\n  type: ACTION_EDITOR_COMMIT,\r\n});\r\n\r\nexport type EditorCommitAction = ReturnType<typeof editorCommit>;\r\nexport function isEditorCommitAction(\r\n  action: AnyAction\r\n): action is EditorCommitAction {\r\n  return action.type === ACTION_EDITOR_COMMIT;\r\n}\r\n","export const ACTION_INITIALIZE = \"@initialize\" as const;\r\nexport const initialize = () => ({\r\n  type: ACTION_INITIALIZE,\r\n});\r\n","import { AnyAction } from \"redux\";\r\n\r\nimport { asArray, MaybeArray } from \"@/arrays\";\r\n\r\nexport const ACTION_MAPEDITOR_ENTITY_DELETE =\r\n  \"mapeditor-entity-delete\" as const;\r\nexport const mapEditorEntityDelete = (entityKeys: MaybeArray<string>) => ({\r\n  type: ACTION_MAPEDITOR_ENTITY_DELETE,\r\n  payload: {\r\n    entityKeys: asArray(entityKeys),\r\n  },\r\n});\r\nexport type MapEditorEntityDeleteAction = ReturnType<\r\n  typeof mapEditorEntityDelete\r\n>;\r\nexport function isMapEditorEntityDeleteAction(\r\n  action: AnyAction\r\n): action is MapEditorEntityDeleteAction {\r\n  return action.type === ACTION_MAPEDITOR_ENTITY_DELETE;\r\n}\r\n","import { AnyAction } from \"redux\";\r\nimport mapKeys from \"lodash/mapKeys\";\r\nimport { v4 as uuidV4 } from \"uuid\";\r\n\r\nimport { asArray, MaybeArray } from \"@/arrays\";\r\nimport { MapEntity } from \"@/map-config\";\r\n\r\nexport const ACTION_MAPEDITOR_ENTITY_INSERT = \"mapeditor-entity-insert\";\r\nexport const mapEditorEntityInsert = (entity: MaybeArray<MapEntity>) => ({\r\n  type: ACTION_MAPEDITOR_ENTITY_INSERT,\r\n  payload: { entities: mapKeys(asArray(entity), (x) => uuidV4()) },\r\n});\r\nexport type MapEditorEntityInsertAction = ReturnType<\r\n  typeof mapEditorEntityInsert\r\n>;\r\nexport function isMapEditorEntityInsertAction(\r\n  action: AnyAction\r\n): action is MapEditorEntityInsertAction {\r\n  return action.type === ACTION_MAPEDITOR_ENTITY_INSERT;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nimport { asArray, MaybeArray } from \"@/arrays\";\r\n\r\nexport const ACTION_MAPEDITOR_ENTITY_OFFSET =\r\n  \"mapeditor-entity-offset\" as const;\r\nexport const mapEditorEntityOffset = (\r\n  entityKeys: MaybeArray<string>,\r\n  offsetX: number,\r\n  offsetY: number\r\n) => ({\r\n  type: ACTION_MAPEDITOR_ENTITY_OFFSET,\r\n  payload: {\r\n    entityKeys: asArray(entityKeys),\r\n    offsetX,\r\n    offsetY,\r\n  },\r\n});\r\nexport type MapEditorEntityOffsetAction = ReturnType<\r\n  typeof mapEditorEntityOffset\r\n>;\r\nexport function isMapEditorEntityOffsetAction(\r\n  action: AnyAction\r\n): action is MapEditorEntityOffsetAction {\r\n  return action.type === ACTION_MAPEDITOR_ENTITY_OFFSET;\r\n}\r\n","import { AnyAction } from \"redux\";\r\nimport { v4 as uuidV4 } from \"uuid\";\r\n\r\nimport { Point } from \"@/geometry\";\r\nimport { MapEntityPrototype } from \"@/map-config\";\r\n\r\nexport const ACTION_MAPEDITOR_ENTITY_PROTOTYPE_INSTANTIATE =\r\n  \"mapeditor-prototype-instantiate\" as const;\r\nexport const mapEditorEntityPrototypeInstantiate = (\r\n  prototype: MapEntityPrototype,\r\n  worldPos: Point\r\n) => ({\r\n  type: ACTION_MAPEDITOR_ENTITY_PROTOTYPE_INSTANTIATE,\r\n  payload: { prototype, worldPos, entityKey: uuidV4() },\r\n});\r\nexport type MapEditorEntityPrototypeInstantiateAction = ReturnType<\r\n  typeof mapEditorEntityPrototypeInstantiate\r\n>;\r\nexport function isMapEditorEntityPrototypeInstantiateAction(\r\n  action: AnyAction\r\n): action is MapEditorEntityPrototypeInstantiateAction {\r\n  return action.type === ACTION_MAPEDITOR_ENTITY_PROTOTYPE_INSTANTIATE;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nexport const ACTION_MAPEDITOR_MAP_CLEAR = \"mapeditor-map-clear\" as const;\r\nexport const mapEditorMapClear = () => ({\r\n  type: ACTION_MAPEDITOR_MAP_CLEAR,\r\n});\r\nexport type MapEditorMapClearAction = ReturnType<typeof mapEditorMapClear>;\r\nexport function isMapEditorMapClearAction(\r\n  action: AnyAction\r\n): action is MapEditorMapClearAction {\r\n  return action.type === ACTION_MAPEDITOR_MAP_CLEAR;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nimport { TemplatesByName } from \"@/map-templates\";\r\n\r\nexport const ACTION_MAPEDITOR_MAP_IMPORT_TEMPLATE =\r\n  \"mapeditor-map-import-template\" as const;\r\nexport const mapEditorMapImportTemplate = (\r\n  templateId: keyof typeof TemplatesByName\r\n) => ({\r\n  type: ACTION_MAPEDITOR_MAP_IMPORT_TEMPLATE,\r\n  payload: {\r\n    templateId,\r\n  },\r\n});\r\nexport type MapEditorMapImportTemplateAction = ReturnType<\r\n  typeof mapEditorMapImportTemplate\r\n>;\r\nexport function isMapEditorMapImportTemplateAction(\r\n  action: AnyAction\r\n): action is MapEditorMapImportTemplateAction {\r\n  return action.type === ACTION_MAPEDITOR_MAP_IMPORT_TEMPLATE;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nimport { MapEntity } from \"@/map-config\";\r\n\r\nexport const ACTION_MAPEDITOR_MAP_RECEIVE = \"mapeditor-map-receive\" as const;\r\nexport const mapEditorMapReceive = (entities: MapEntity[]) => ({\r\n  type: ACTION_MAPEDITOR_MAP_RECEIVE,\r\n  payload: { entities },\r\n});\r\nexport type MapEditorMapReceiveAction = ReturnType<typeof mapEditorMapReceive>;\r\nexport function isMapEditorMapReceiveAction(\r\n  action: AnyAction\r\n): action is MapEditorMapReceiveAction {\r\n  return action.type === ACTION_MAPEDITOR_MAP_RECEIVE;\r\n}\r\n","import { ModifierKeys } from \"@/modifier-keys\";\r\nimport { AnyAction } from \"redux\";\r\n\r\nexport const ACTION_MAPEDITOR_MODIFIERKEYS_CHANGED =\r\n  \"mapeditor-modifierkeys-changed\" as const;\r\nexport const mapEditorModifierKeysChanged = (modifiers: ModifierKeys) => ({\r\n  type: ACTION_MAPEDITOR_MODIFIERKEYS_CHANGED,\r\n  payload: { modifiers },\r\n});\r\nexport type MapEditorModifierKeysChangedAction = ReturnType<\r\n  typeof mapEditorModifierKeysChanged\r\n>;\r\nexport function isMapEditorModifierKeysChangedAction(\r\n  action: AnyAction\r\n): action is MapEditorModifierKeysChangedAction {\r\n  return action.type === ACTION_MAPEDITOR_MODIFIERKEYS_CHANGED;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nimport { Point } from \"@/geometry\";\r\nimport { ModifierKeys } from \"@/modifier-keys\";\r\n\r\nexport const ACTION_MAPEDITOR_MOUSE_DOWN = \"mapeditor-mouse-down\" as const;\r\nexport const mapEditorMouseDown = (\r\n  viewportPos: Point,\r\n  modifierKeys: ModifierKeys\r\n) => ({\r\n  type: ACTION_MAPEDITOR_MOUSE_DOWN,\r\n  payload: { viewportPos, modifierKeys },\r\n});\r\nexport type MapEditorMouseDownAction = ReturnType<typeof mapEditorMouseDown>;\r\nexport function isMapEditorMouseDownAction(\r\n  action: AnyAction\r\n): action is MapEditorMouseDownAction {\r\n  return action.type === ACTION_MAPEDITOR_MOUSE_DOWN;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nimport { Point } from \"@/geometry\";\r\nimport { ModifierKeys } from \"@/modifier-keys\";\r\n\r\nexport const ACTION_MAPEDITOR_MOUSE_MOVE = \"mapeditor-mouse-move\" as const;\r\nexport const mapEditorMouseMove = (\r\n  viewportPos: Point,\r\n  modifierKeys: ModifierKeys\r\n) => ({\r\n  type: ACTION_MAPEDITOR_MOUSE_MOVE,\r\n  payload: { viewportPos, modifierKeys },\r\n});\r\nexport type MapEditorMouseMoveAction = ReturnType<typeof mapEditorMouseMove>;\r\nexport function isMapEditorMouseMoveAction(\r\n  action: AnyAction\r\n): action is MapEditorMouseMoveAction {\r\n  return action.type === ACTION_MAPEDITOR_MOUSE_MOVE;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nexport const ACTION_MAPEDITOR_MOUSE_OUT = \"mapeditor-mouse-out\" as const;\r\nexport const mapEditorMouseOut = () => ({\r\n  type: ACTION_MAPEDITOR_MOUSE_OUT,\r\n});\r\nexport type MapEditorMouseOutAction = ReturnType<typeof mapEditorMouseOut>;\r\nexport function isMapEditorMouseOutAction(\r\n  action: AnyAction\r\n): action is MapEditorMouseOutAction {\r\n  return action.type === ACTION_MAPEDITOR_MOUSE_OUT;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nimport { Point } from \"@/geometry\";\r\nimport { ModifierKeys } from \"@/modifier-keys\";\r\n\r\nexport const ACTION_MAPEDITOR_MOUSE_UP = \"mapeditor-mouse-up\" as const;\r\nexport const mapEditorMouseUp = (\r\n  viewportPos: Point,\r\n  modifierKeys: ModifierKeys\r\n) => ({\r\n  type: ACTION_MAPEDITOR_MOUSE_UP,\r\n  payload: { viewportPos, modifierKeys },\r\n});\r\nexport type MapEditorMouseUpAction = ReturnType<typeof mapEditorMouseUp>;\r\nexport function isMapEditorMouseUpAction(\r\n  action: AnyAction\r\n): action is MapEditorMouseUpAction {\r\n  return action.type === ACTION_MAPEDITOR_MOUSE_UP;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nexport const ACTION_MAPEDITOR_PAN = \"mapeditor-pan\" as const;\r\nexport const mapEditorPan = (xOffset: number, yOffset: number) => ({\r\n  type: ACTION_MAPEDITOR_PAN,\r\n  payload: { x: xOffset, y: yOffset },\r\n});\r\nexport type MapEditorPanAction = ReturnType<typeof mapEditorPan>;\r\nexport function isMapEditorPanAction(\r\n  action: AnyAction\r\n): action is MapEditorPanAction {\r\n  return action.type === ACTION_MAPEDITOR_PAN;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nexport const ACTION_MAPEDITOR_RENDERED = \"mapeditor-rendered\" as const;\r\nexport const mapEditorRendered = () => ({\r\n  type: ACTION_MAPEDITOR_RENDERED,\r\n});\r\nexport function isMapEditorRenderedAction(action: AnyAction): boolean {\r\n  return action.type === ACTION_MAPEDITOR_RENDERED;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nexport const ACTION_MAPEDITOR_SELECT_CLEAR = \"mapeditor-select-clear\" as const;\r\nexport const mapEditorSelectClear = () => ({\r\n  type: ACTION_MAPEDITOR_SELECT_CLEAR,\r\n});\r\nexport type MapEditorSelectClearAction = ReturnType<\r\n  typeof mapEditorSelectClear\r\n>;\r\nexport function isMapEditorSelectClearAction(\r\n  action: AnyAction\r\n): action is MapEditorSelectClearAction {\r\n  return action.type === ACTION_MAPEDITOR_SELECT_CLEAR;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nimport { asArray, MaybeArray } from \"@/arrays\";\r\nimport { SelectionMode } from \"@/selection-mode\";\r\n\r\nexport const ACTION_MAPEDITOR_SELECT_ENTITY =\r\n  \"mapeditor-select-entity\" as const;\r\nexport const mapEditorSelectEntity = (\r\n  entityKeys: MaybeArray<string>,\r\n  mode: SelectionMode = \"set\"\r\n) => ({\r\n  type: ACTION_MAPEDITOR_SELECT_ENTITY,\r\n  payload: { entityKeys: asArray(entityKeys), mode },\r\n});\r\nexport type MapEditorSelectEntityAction = ReturnType<\r\n  typeof mapEditorSelectEntity\r\n>;\r\nexport function isMapEditorSelectEntityAction(\r\n  action: AnyAction\r\n): action is MapEditorSelectEntityAction {\r\n  return action.type === ACTION_MAPEDITOR_SELECT_ENTITY;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nexport const ACTION_MAPEDITOR_SELECTION_DELETE =\r\n  \"mapeditor-selection-delete\" as const;\r\nexport const mapEditorSelectionDelete = () => ({\r\n  type: ACTION_MAPEDITOR_SELECTION_DELETE,\r\n});\r\nexport type MapEditorSelectionDeleteAction = ReturnType<\r\n  typeof mapEditorSelectionDelete\r\n>;\r\nexport function isMapEditorSelectionDeleteAction(\r\n  action: AnyAction\r\n): action is MapEditorSelectionDeleteAction {\r\n  return action.type === ACTION_MAPEDITOR_SELECTION_DELETE;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nexport const ACTION_MAPEDITOR_TOOL_RADIUS_SET =\r\n  \"mapeditor-tool-radius-set\" as const;\r\nexport const mapEditorToolRadiusSet = (radius: number) => ({\r\n  type: ACTION_MAPEDITOR_TOOL_RADIUS_SET,\r\n  payload: { radius },\r\n});\r\nexport type MapEditorToolRadiusSetAction = ReturnType<\r\n  typeof mapEditorToolRadiusSet\r\n>;\r\nexport function isMapEditorToolRadiusSetAction(\r\n  action: AnyAction\r\n): action is MapEditorToolRadiusSetAction {\r\n  return action.type === ACTION_MAPEDITOR_TOOL_RADIUS_SET;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nimport { EditorMouseTool } from \"@/services/map-editor/mouse/state\";\r\n\r\nexport const ACTION_MAPEDITOR_TOOL_SET = \"mapeditor-tool-set\" as const;\r\nexport const mapEditorToolSet = (tool: EditorMouseTool) => ({\r\n  type: ACTION_MAPEDITOR_TOOL_SET,\r\n  payload: { tool },\r\n});\r\nexport type MapEditorToolSetAction = ReturnType<typeof mapEditorToolSet>;\r\nexport function isMapEditorToolSetAction(\r\n  action: AnyAction\r\n): action is MapEditorToolSetAction {\r\n  return action.type === ACTION_MAPEDITOR_TOOL_SET;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nexport const ACTION_MAPEDITOR_VIEWPORT_RESIZE =\r\n  \"mapeditor-viewport-resize\" as const;\r\nexport const mapEditorViewportResize = (width: number, height: number) => ({\r\n  type: ACTION_MAPEDITOR_VIEWPORT_RESIZE,\r\n  payload: { width, height },\r\n});\r\nexport type MapEditorViewportResizeAction = ReturnType<\r\n  typeof mapEditorViewportResize\r\n>;\r\nexport function isMapEditorViewportResizeAction(\r\n  action: AnyAction\r\n): action is MapEditorViewportResizeAction {\r\n  return action.type === ACTION_MAPEDITOR_VIEWPORT_RESIZE;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nexport const ACTION_MAPEDITOR_ZOOM = \"mapeditor-zoom\" as const;\r\nexport const mapEditorZoom = (zoomFactor: number) => ({\r\n  type: ACTION_MAPEDITOR_ZOOM,\r\n  payload: { zoomFactor },\r\n});\r\nexport type MapEditorZoomAction = ReturnType<typeof mapEditorZoom>;\r\nexport function isMapEditorZoomAction(\r\n  action: AnyAction\r\n): action is MapEditorZoomAction {\r\n  return action.type === ACTION_MAPEDITOR_ZOOM;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nexport const ACTION_NAVTREE_EXPANDEDVALUES_SET =\r\n  \"navtree-expandedvalues-set\" as const;\r\nexport const navtreeExpandedValuesSet = (expandedValues: string[]) => ({\r\n  type: ACTION_NAVTREE_EXPANDEDVALUES_SET,\r\n  payload: { expandedValues },\r\n});\r\nexport type NavtreeExpandedValuesSetAction = ReturnType<\r\n  typeof navtreeExpandedValuesSet\r\n>;\r\nexport function isNavtreeExpandedValuesSetAction(\r\n  action: AnyAction\r\n): action is NavtreeExpandedValuesSetAction {\r\n  return action.type === ACTION_NAVTREE_EXPANDEDVALUES_SET;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nimport {\r\n  CruciblePackageSectionKey,\r\n  CruciblePackageSections,\r\n} from \"@/services/package/types\";\r\n\r\nexport const ACTION_PACKAGE_DATA_SET_BYID = \"package-data-set-byid\";\r\n\r\nexport function packageDataSetById<\r\n  TSectionKey extends CruciblePackageSectionKey\r\n>(\r\n  sectionKey: TSectionKey,\r\n  id: string,\r\n  data: CruciblePackageSections[TSectionKey][0]\r\n): PackageDataSetByIdAction;\r\nexport function packageDataSetById<\r\n  TSectionKey extends CruciblePackageSectionKey,\r\n  K1 extends keyof CruciblePackageSections[TSectionKey][0]\r\n>(\r\n  sectionKey: TSectionKey,\r\n  id: string,\r\n  k1: K1,\r\n  data: CruciblePackageSections[TSectionKey][0][K1]\r\n): PackageDataSetByIdAction;\r\nexport function packageDataSetById(\r\n  sectionKey: string,\r\n  id: string,\r\n  ...args: string[]\r\n) {\r\n  return {\r\n    type: ACTION_PACKAGE_DATA_SET_BYID,\r\n    payload: {\r\n      sectionKey,\r\n      id,\r\n      path: args.slice(0, args.length - 1),\r\n      data: args[args.length - 1],\r\n    },\r\n  };\r\n}\r\n\r\nexport interface PackageDataSetByIdAction {\r\n  type: typeof ACTION_PACKAGE_DATA_SET_BYID;\r\n  payload: {\r\n    sectionKey: CruciblePackageSectionKey;\r\n    id: string;\r\n    path: string[];\r\n    data: any;\r\n  };\r\n}\r\n\r\nexport function isPackageDataSetByIdAction(\r\n  action: AnyAction\r\n): action is PackageDataSetByIdAction {\r\n  return action.type === ACTION_PACKAGE_DATA_SET_BYID;\r\n}\r\n","import { CruciblePackage } from \"@/services/package/types\";\r\nimport { AnyAction } from \"redux\";\r\n\r\nexport const ACTION_PACKGE_DATA_SET = \"package-data-set\" as const;\r\nexport function packageDataSet<K1 extends keyof CruciblePackage>(\r\n  k1: K1,\r\n  data: CruciblePackage[K1]\r\n): PackageDataSetAction;\r\nexport function packageDataSet<\r\n  K1 extends keyof CruciblePackage,\r\n  K2 extends keyof CruciblePackage[K1]\r\n>(k1: K1, k2: K2, data: CruciblePackage[K1][K2]): PackageDataSetAction;\r\nexport function packageDataSet<\r\n  K1 extends keyof CruciblePackage,\r\n  K2 extends keyof CruciblePackage[K1],\r\n  K3 extends keyof CruciblePackage[K1][K2]\r\n>(\r\n  k1: K1,\r\n  k2: K2,\r\n  k3: K3,\r\n  data: CruciblePackage[K1][K2][K3]\r\n): PackageDataSetAction;\r\nexport function packageDataSet<\r\n  K1 extends keyof CruciblePackage,\r\n  K2 extends keyof CruciblePackage[K1],\r\n  K3 extends keyof CruciblePackage[K1][K2],\r\n  K4 extends keyof CruciblePackage[K1][K2][K3]\r\n>(\r\n  k1: K1,\r\n  k2: K2,\r\n  k3: K3,\r\n  k4: K4,\r\n  data: CruciblePackage[K1][K2][K3][K4]\r\n): PackageDataSetAction;\r\nexport function packageDataSet(...args: any[]): PackageDataSetAction {\r\n  return {\r\n    type: ACTION_PACKGE_DATA_SET,\r\n    payload: {\r\n      path: args.slice(0, args.length - 1),\r\n      data: args[args.length - 1],\r\n    },\r\n  };\r\n}\r\nexport interface PackageDataSetAction {\r\n  type: typeof ACTION_PACKGE_DATA_SET;\r\n  payload: {\r\n    path: string[];\r\n    data: any;\r\n  };\r\n}\r\nexport function isPackageDataSetAction(\r\n  action: AnyAction\r\n): action is PackageDataSetAction {\r\n  return action.type === ACTION_PACKGE_DATA_SET;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nimport { CruciblePackageSectionKey } from \"@/services/package/types\";\r\n\r\nexport const ACTION_PACKAGE_IDOBJECT_NEW = \"package-idobject-new\";\r\nexport const packageIdObjectNew = (\r\n  key: CruciblePackageSectionKey,\r\n  id: string\r\n) => ({\r\n  type: ACTION_PACKAGE_IDOBJECT_NEW,\r\n  payload: { key, id },\r\n});\r\nexport type PackageIdObjectNewAction = ReturnType<typeof packageIdObjectNew>;\r\nexport function isPackageIdObjectNewAction(\r\n  action: AnyAction\r\n): action is PackageIdObjectNewAction {\r\n  return action.type === ACTION_PACKAGE_IDOBJECT_NEW;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nexport const ACITON_PACKAGE_LOAD_ERROR = \"package-load-error\" as const;\r\nexport const packageLoadError = (errorMessage: string) => ({\r\n  type: ACITON_PACKAGE_LOAD_ERROR,\r\n  payload: { errorMessage },\r\n});\r\nexport type PackageLoadErrorAction = ReturnType<typeof packageLoadError>;\r\nexport function isPackageLoadErrorAction(\r\n  action: AnyAction\r\n): action is PackageLoadErrorAction {\r\n  return action.type === ACITON_PACKAGE_LOAD_ERROR;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nexport const ACTION_PACKAGE_LOAD_FILE = \"package-load-file\" as const;\r\nexport const packageLoadFile = (file: File) => ({\r\n  type: ACTION_PACKAGE_LOAD_FILE,\r\n  payload: { file },\r\n});\r\nexport type PackageLoadFileAction = ReturnType<typeof packageLoadFile>;\r\nexport function isPackageLoadFileAction(\r\n  action: AnyAction\r\n): action is PackageLoadFileAction {\r\n  return action.type === ACTION_PACKAGE_LOAD_FILE;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nexport const ACTION_PACKAGE_NEW = \"package-new\" as const;\r\nexport const packageNew = () => ({\r\n  type: ACTION_PACKAGE_NEW,\r\n});\r\nexport type PackageNewAction = ReturnType<typeof packageNew>;\r\nexport function isPackageNewAction(\r\n  action: AnyAction\r\n): action is PackageNewAction {\r\n  return action.type === ACTION_PACKAGE_NEW;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nexport const ACTION_PACKAGE_RECEIVE = \"package-receive\" as const;\r\nexport const packageReceive = (\r\n  packageId: string,\r\n  resources: Record<string, Uint8Array>\r\n) => ({\r\n  type: ACTION_PACKAGE_RECEIVE,\r\n  payload: { packageId, resources },\r\n});\r\nexport type PackageReceiveAction = ReturnType<typeof packageReceive>;\r\nexport function isPackageReceiveAction(\r\n  action: AnyAction\r\n): action is PackageReceiveAction {\r\n  return action.type === ACTION_PACKAGE_RECEIVE;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nimport {\r\n  CruciblePackageSectionKey,\r\n  CruciblePackageSections,\r\n} from \"@/services/package/types\";\r\nimport { ItemOf } from \"@/arrays\";\r\n\r\nexport const ACTION_PACKAGE_RESOURCE_SET_BYID = \"package-resource-set-byid\";\r\n\r\nexport function packageResourceSetById<\r\n  TSectionKey extends CruciblePackageSectionKey,\r\n  K1 extends keyof ItemOf<CruciblePackageSections[TSectionKey]>\r\n>(\r\n  sectionKey: TSectionKey,\r\n  id: string,\r\n  k1: K1,\r\n  resourceName: string,\r\n  resource: Uint8Array\r\n): PackageResourceSetByIdAction;\r\nexport function packageResourceSetById(\r\n  sectionKey: string,\r\n  id: string,\r\n  ...args: any[]\r\n) {\r\n  return {\r\n    type: ACTION_PACKAGE_RESOURCE_SET_BYID,\r\n    payload: {\r\n      sectionKey,\r\n      id,\r\n      path: args.slice(0, args.length - 2),\r\n      resourceName: args[args.length - 2],\r\n      resource: args[args.length - 1],\r\n    },\r\n  };\r\n}\r\n\r\nexport interface PackageResourceSetByIdAction {\r\n  type: typeof ACTION_PACKAGE_RESOURCE_SET_BYID;\r\n  payload: {\r\n    sectionKey: CruciblePackageSectionKey;\r\n    id: string;\r\n    path: string[];\r\n    resourceName: string;\r\n    resource: Uint8Array;\r\n  };\r\n}\r\n\r\nexport function isPackageResourceSetByIdAction(\r\n  action: AnyAction\r\n): action is PackageResourceSetByIdAction {\r\n  return action.type === ACTION_PACKAGE_RESOURCE_SET_BYID;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nexport const ACTION_PACKAGE_SAVE = \"package-save\" as const;\r\nexport const packageSave = () => ({\r\n  type: ACTION_PACKAGE_SAVE,\r\n});\r\nexport type PackageSaveAction = ReturnType<typeof packageSave>;\r\nexport function isPackageSaveAction(\r\n  action: AnyAction\r\n): action is PackageSaveAction {\r\n  return action.type === ACTION_PACKAGE_SAVE;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nexport const ACTION_POTIONBASE_MAP_EDIT = \"potionbase-map-edit\" as const;\r\nexport const potionBaseMapEdit = (potionBaseId: string) => ({\r\n  type: ACTION_POTIONBASE_MAP_EDIT,\r\n  payload: { potionBaseId },\r\n});\r\nexport type PotionBaseMapEditAction = ReturnType<typeof potionBaseMapEdit>;\r\nexport function isPotionBaseMapEditAction(\r\n  action: AnyAction\r\n): action is PotionBaseMapEditAction {\r\n  return action.type === ACTION_POTIONBASE_MAP_EDIT;\r\n}\r\n","export const ACTION_SET_LANGUAGE = \"app/set-language\";\r\nexport const setLanguage = (language: string) => ({\r\n  type: ACTION_SET_LANGUAGE as typeof ACTION_SET_LANGUAGE,\r\n  payload: language\r\n});\r\nexport type SetLanguageAction = ReturnType<typeof setLanguage>;\r\n","export type MaybeArray<T> = T | T[];\r\nexport type ItemOf<T> = T extends Array<infer U> ? U : T;\r\n\r\nexport function asArray<T>(x: MaybeArray<T>): T[] {\r\n  return Array.isArray(x) ? x : [x];\r\n}\r\n\r\nconst _emptyArray = Object.freeze([] as any[]);\r\nexport function emptyFrozenArray<T>(): T[] {\r\n  return _emptyArray as T[];\r\n}\r\n","import { EntityDefsByType } from \"./entities\";\r\nimport { POTION_RADIUS } from \"./entities/consts\";\r\nimport { MapEntity } from \"./map-config\";\r\nimport { RenderResources } from \"./services/map-editor/entities/types\";\r\n\r\nexport function transformToMap(\r\n  ctx: CanvasRenderingContext2D,\r\n  zoomFactor: number,\r\n  offsetX: number,\r\n  offsetY: number,\r\n  handler: () => void\r\n) {\r\n  ctx.save();\r\n  ctx.scale(zoomFactor, zoomFactor);\r\n  ctx.translate(-offsetX + 60, -offsetY + 60);\r\n  ctx.scale(1, -1);\r\n\r\n  handler();\r\n  ctx.restore();\r\n}\r\n\r\nexport function renderPotionStart(ctx: CanvasRenderingContext2D) {\r\n  ctx.beginPath();\r\n  ctx.fillStyle = \"blue\";\r\n  ctx.arc(0, 0, POTION_RADIUS, 0, 2 * Math.PI);\r\n  ctx.fill();\r\n}\r\n\r\nexport function renderEntity(\r\n  ctx: CanvasRenderingContext2D,\r\n  entity: MapEntity,\r\n  isSelected: boolean,\r\n  renderResources: RenderResources\r\n) {\r\n  const type = EntityDefsByType[entity.entityType];\r\n  if (!type) {\r\n    return;\r\n  }\r\n\r\n  ctx.save();\r\n\r\n  ctx.translate(entity.x, entity.y);\r\n  type.render(\r\n    ctx,\r\n    entity,\r\n    (ctx) => {\r\n      if (isSelected) {\r\n        ctx.fillStyle = \"lightblue\";\r\n      }\r\n    },\r\n    renderResources\r\n  );\r\n\r\n  ctx.restore();\r\n}\r\n","import * as React from \"react\";\r\n\r\nexport interface AbstractFileLoadButtonProps {\r\n  accept: string;\r\n  onFileLoaded(file: File): void;\r\n  children(props: AbstractLoadButtonRenderProps): React.ReactChild;\r\n  onInteractionComplete?(): void;\r\n}\r\nexport interface AbstractLoadButtonRenderProps {\r\n  onClick(): void;\r\n}\r\n\r\ntype Props = AbstractFileLoadButtonProps;\r\nconst AbstractFileLoadButton: React.FC<Props> = ({\r\n  accept,\r\n  onFileLoaded,\r\n  onInteractionComplete = () => {},\r\n  children,\r\n}) => {\r\n  const inputRef = React.useRef<HTMLInputElement | null>(null);\r\n\r\n  const onClick = React.useCallback(() => {\r\n    if (inputRef.current) {\r\n      inputRef.current.click();\r\n    }\r\n  }, [inputRef]);\r\n\r\n  const onFileChange = React.useCallback(\r\n    (e: React.ChangeEvent<HTMLInputElement>) => {\r\n      const files = e.target.files;\r\n      if (!files || files.length === 0) {\r\n        onInteractionComplete();\r\n        return;\r\n      }\r\n      const file = files[0];\r\n\r\n      onFileLoaded(file);\r\n      onInteractionComplete();\r\n    },\r\n    [onFileLoaded, onInteractionComplete]\r\n  );\r\n\r\n  return (\r\n    <>\r\n      {children({ onClick })}\r\n      <input\r\n        ref={inputRef}\r\n        style={{ display: \"none\" }}\r\n        type=\"file\"\r\n        accept={accept}\r\n        onChange={onFileChange}\r\n      />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default AbstractFileLoadButton;\r\n","import * as React from \"react\";\r\nimport { Options } from \"@popperjs/core\";\r\n\r\nimport Popper from \"./Popper\";\r\nimport { MenuCloseListener } from \"./Menus/MenuCloseContext\";\r\n\r\nexport interface AutoPopperProps {\r\n  content: JSX.Element;\r\n  placement?: Options[\"placement\"];\r\n}\r\n\r\nconst AutoPopper: React.FC<AutoPopperProps> = ({\r\n  content,\r\n  placement,\r\n  children,\r\n}) => {\r\n  const anchorEl = React.useRef<HTMLDivElement | null>(null);\r\n\r\n  const [open, setOpen] = React.useState(false);\r\n  const onClick = React.useCallback(() => {\r\n    setOpen(true);\r\n  }, []);\r\n  const onClose = React.useCallback(() => {\r\n    setOpen(false);\r\n  }, []);\r\n\r\n  return (\r\n    <MenuCloseListener onClose={onClose}>\r\n      <div ref={anchorEl} onClick={onClick}>\r\n        {children}\r\n      </div>\r\n      <Popper\r\n        anchorEl={anchorEl.current}\r\n        isOpen={open}\r\n        placement={placement}\r\n        onRequestClose={onClose}\r\n      >\r\n        {open && content}\r\n      </Popper>\r\n    </MenuCloseListener>\r\n  );\r\n};\r\n\r\nexport default AutoPopper;\r\n","import * as React from \"react\";\r\nimport classNames from \"classnames\";\r\n\r\nexport interface ButtonProps\r\n  extends React.ButtonHTMLAttributes<HTMLButtonElement> {\r\n  className?: string;\r\n  variant?: \"default\" | \"primary\" | \"text\" | \"menu\";\r\n  size?: \"default\" | \"small\";\r\n  disabled?: boolean;\r\n}\r\n\r\nimport styles from \"./Button.module.css\";\r\n\r\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\r\n  (\r\n    { className, variant = \"default\", size = \"default\", disabled, ...props },\r\n    ref\r\n  ) => {\r\n    return (\r\n      <button\r\n        ref={ref}\r\n        className={classNames(\r\n          styles[\"button\"],\r\n          (styles as any)[`button--variant-${variant}`],\r\n          (styles as any)[`button--size-${size}`],\r\n          disabled && styles[\"disabled\"],\r\n          className\r\n        )}\r\n        type=\"button\"\r\n        {...props}\r\n      >\r\n        <span className={styles[\"button-content\"]}>{props.children}</span>\r\n      </button>\r\n    );\r\n  }\r\n);\r\n\r\nexport default Button;\r\n","import * as React from \"react\";\r\nimport classNames from \"classnames\";\r\nimport { Link, LinkProps } from \"react-router-dom\";\r\n\r\nexport interface LinkButtonProps\r\n  extends React.AnchorHTMLAttributes<HTMLAnchorElement>,\r\n    LinkProps {\r\n  variant?: \"default\" | \"primary\" | \"text\" | \"menu\";\r\n  size?: \"default\" | \"small\";\r\n}\r\n\r\nimport styles from \"./Button.module.css\";\r\n\r\nconst LinkButton = React.forwardRef<HTMLAnchorElement, LinkButtonProps>(\r\n  ({ className, variant = \"default\", size = \"default\", ...props }, ref) => {\r\n    return (\r\n      <Link\r\n        ref={ref}\r\n        className={classNames(\r\n          styles[\"button\"],\r\n          (styles as any)[`button--variant-${variant}`],\r\n          (styles as any)[`button--size-${size}`],\r\n          className\r\n        )}\r\n        {...props}\r\n      >\r\n        <span className={styles[\"button-content\"]}>{props.children}</span>\r\n      </Link>\r\n    );\r\n  }\r\n);\r\n\r\nexport default LinkButton;\r\n","import Button from \"./Button\";\r\nexport default Button;\r\n","import * as React from \"react\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faCheckSquare, faSquare } from \"@fortawesome/free-regular-svg-icons\";\r\n\r\nimport styles from \"./Checkbox.module.css\";\r\n\r\nexport interface CheckboxProps {\r\n  checked: boolean;\r\n  onChange(e: React.ChangeEvent<HTMLInputElement>): void;\r\n  children?: React.ReactNode;\r\n}\r\n\r\nconst Checkbox = ({ checked, onChange, children }: CheckboxProps) => {\r\n  return (\r\n    <label>\r\n      <input\r\n        className={styles[\"checkbox-input\"]}\r\n        type=\"checkbox\"\r\n        checked={checked}\r\n        onChange={onChange}\r\n      />\r\n      <FontAwesomeIcon\r\n        className={styles[\"checkbox-icon\"]}\r\n        fixedWidth\r\n        size=\"lg\"\r\n        icon={checked ? faCheckSquare : faSquare}\r\n      />\r\n      <span className={styles[\"checkbox-label\"]}>{children}</span>\r\n    </label>\r\n  );\r\n};\r\n\r\nexport default Checkbox;\r\n","import Checkbox from \"./Checkbox\";\r\nexport default Checkbox;\r\n","import * as React from \"react\";\r\nimport { SketchPicker, ColorResult } from \"react-color\";\r\n\r\nimport Popper from \"../Popper\";\r\n\r\nimport styles from \"./ColorButton.module.css\";\r\n\r\nexport interface ColorButtonProps {\r\n  color: string;\r\n  onChange(color: string): void;\r\n  children?: React.ReactNode;\r\n}\r\n\r\nconst radius = 17;\r\n\r\nconst ColorButton = ({ color, onChange, children }: ColorButtonProps) => {\r\n  const svgRef = React.useRef<SVGSVGElement>(null);\r\n  const [isOpen, setIsOpen] = React.useState(false);\r\n  const [bufferedColor, setBufferedColor] = React.useState<string | null>(null);\r\n\r\n  const onClick = React.useCallback(() => {\r\n    setIsOpen(!isOpen);\r\n  }, [isOpen]);\r\n\r\n  const onRequestClose = React.useCallback(() => {\r\n    setIsOpen(false);\r\n  }, []);\r\n\r\n  const onSketchColorChange = React.useCallback((color: ColorResult) => {\r\n    setBufferedColor(color.hex);\r\n  }, []);\r\n\r\n  const onSketchColorCommit = React.useCallback(\r\n    (color: ColorResult) => {\r\n      setBufferedColor(null);\r\n      onChange(color.hex);\r\n    },\r\n    [onChange]\r\n  );\r\n\r\n  return (\r\n    <label>\r\n      <svg\r\n        width={`${radius * 2}px`}\r\n        height={`${radius * 2}px`}\r\n        ref={svgRef}\r\n        className={styles[\"colorbutton-svg\"]}\r\n        onClick={onClick}\r\n      >\r\n        <circle\r\n          cx={radius}\r\n          cy={radius}\r\n          r={radius}\r\n          fill={bufferedColor ?? color}\r\n        />\r\n      </svg>\r\n      {children && (\r\n        <span className={styles[\"colorbutton-label\"]}>{children}</span>\r\n      )}\r\n      <Popper\r\n        isOpen={isOpen}\r\n        anchorEl={svgRef.current}\r\n        onRequestClose={onRequestClose}\r\n      >\r\n        <SketchPicker\r\n          color={color}\r\n          onChange={onSketchColorChange}\r\n          onChangeComplete={onSketchColorCommit}\r\n        />\r\n      </Popper>\r\n    </label>\r\n  );\r\n};\r\n\r\nexport default ColorButton;\r\n","import ColorButton from \"./ColorButton\";\r\nexport default ColorButton;\r\n","import * as React from \"react\";\r\n\r\nimport TextArea, { TextAreaProps } from \"./TextArea\";\r\n\r\nexport interface CommitTextAreaProps extends TextAreaProps {\r\n  onCommit: (value: string) => void;\r\n}\r\n\r\nconst CommitTextArea: React.FC<CommitTextAreaProps> = ({\r\n  value,\r\n  onCommit,\r\n  ...props\r\n}) => {\r\n  const [editingValue, setEditingValue] = React.useState<string | null>(null);\r\n  const onChange = React.useCallback(\r\n    (e: React.ChangeEvent<HTMLTextAreaElement>) => {\r\n      setEditingValue(e.target.value);\r\n    },\r\n    []\r\n  );\r\n  const onBlur = React.useCallback(() => {\r\n    if (editingValue != null) {\r\n      setEditingValue(null);\r\n      onCommit(editingValue);\r\n    }\r\n  }, [editingValue]);\r\n  return (\r\n    <TextArea\r\n      {...props}\r\n      value={editingValue ?? value}\r\n      onChange={onChange}\r\n      onBlur={onBlur}\r\n    />\r\n  );\r\n};\r\n\r\nexport default CommitTextArea;\r\n","import * as React from \"react\";\r\n\r\nimport TextBox, { TextBoxProps } from \"./TextBox\";\r\n\r\nexport interface CommitTextBoxProps extends TextBoxProps {\r\n  onCommit: (value: string) => void;\r\n}\r\n\r\nconst CommitTextBox: React.FC<CommitTextBoxProps> = ({\r\n  value,\r\n  onCommit,\r\n  ...props\r\n}) => {\r\n  const [editingValue, setEditingValue] = React.useState<string | null>(null);\r\n  const onChange = React.useCallback(\r\n    (e: React.ChangeEvent<HTMLInputElement>) => {\r\n      setEditingValue(e.target.value);\r\n    },\r\n    []\r\n  );\r\n  const onBlur = React.useCallback(() => {\r\n    if (editingValue != null) {\r\n      setEditingValue(null);\r\n      onCommit(editingValue);\r\n    }\r\n  }, [editingValue]);\r\n  return (\r\n    <TextBox\r\n      {...props}\r\n      value={editingValue ?? value}\r\n      onChange={onChange}\r\n      onBlur={onBlur}\r\n    />\r\n  );\r\n};\r\n\r\nexport default CommitTextBox;\r\n","import * as React from \"react\";\r\n\r\nimport PackageMenuButton from \"./PackageMenuButton\";\r\n\r\nconst DefaultTitlebarContent = () => {\r\n  return (\r\n    <>\r\n      <PackageMenuButton />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default DefaultTitlebarContent;\r\n","import * as React from \"react\";\r\nimport classNames from \"classnames\";\r\n\r\nimport styles from \"./Divider.module.css\";\r\n\r\nexport interface DividerProps {\r\n  orientation?: \"horizontal\" | \"vertical\";\r\n}\r\n\r\nconst Divider = ({ orientation = \"horizontal\" }: DividerProps) => (\r\n  <div\r\n    className={classNames(\r\n      styles[\"divider\"],\r\n      orientation == \"horizontal\"\r\n        ? styles[\"divider--horizontal\"]\r\n        : styles[\"divider--vertical\"]\r\n    )}\r\n  >\r\n    <div className={styles[\"divider-line\"]} />\r\n  </div>\r\n);\r\n\r\nexport default Divider;\r\n","import Divider from \"./Divider\";\r\nexport default Divider;\r\n","import * as React from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\n\r\nimport { useSelector } from \"@/hooks/use-selector\";\r\n\r\nimport { packageLoadStatusSelector } from \"@/services/package/selectors/package\";\r\n\r\nconst EnsurePackageLoaded: React.FC = () => {\r\n  const status = useSelector(packageLoadStatusSelector);\r\n  return status == \"loaded\" ? null : <Redirect to=\"/\" />;\r\n};\r\n\r\nexport default EnsurePackageLoaded;\r\n","import * as React from \"react\";\r\nimport classNames from \"classnames\";\r\n\r\nimport styles from \"./FieldBox.module.css\";\r\n\r\nexport interface FieldBoxProps {\r\n  className?: string;\r\n  label: string;\r\n  children: React.ReactNode;\r\n}\r\nconst FieldBox = ({ className, label, children }: FieldBoxProps) => (\r\n  <div className={classNames(styles[\"fieldbox\"], className)}>\r\n    <span className={styles[\"fieldbox-label\"]}>{label}</span>\r\n    <div className={styles[\"fieldbox-content\"]}>{children}</div>\r\n  </div>\r\n);\r\n\r\nexport default FieldBox;\r\n","import FieldBox from \"./FieldBox\";\r\nexport default FieldBox;\r\n","import * as React from \"react\";\r\nimport classNames from \"classnames\";\r\n\r\nimport styles from \"./Flow.module.css\";\r\n\r\nexport interface FlowProps {\r\n  className?: string;\r\n  children: React.ReactNode;\r\n}\r\nconst Flow = ({ className, children }: FlowProps) => (\r\n  <div className={classNames(styles[\"flow--vertical\"], className)}>\r\n    {children}\r\n  </div>\r\n);\r\n\r\nexport default Flow;\r\n","import Flow from \"./Flow\";\r\nexport default Flow;\r\n","import * as React from \"react\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faCheck, faFileUpload } from \"@fortawesome/free-solid-svg-icons\";\r\n\r\nimport { extname } from \"@/paths\";\r\nimport { merge, StringKeysOf } from \"@/object-utils\";\r\n\r\nimport { useSelector } from \"@/hooks/use-selector\";\r\nimport {\r\n  CruciblePackageSectionItem,\r\n  CruciblePackageSectionKey,\r\n} from \"@/services/package/types\";\r\nimport { packageIdObjectDataSelector } from \"@/services/package/selectors/package\";\r\n\r\nimport { packageResourceSetById } from \"@/actions/packages/package-resource-set-byid\";\r\n\r\nimport AbstractFileLoadButton from \"../AbstractFileLoadButton\";\r\nimport Button from \"../Button\";\r\n\r\nexport interface IdObjectResourceFieldProps<\r\n  TKey extends CruciblePackageSectionKey = any\r\n> {\r\n  sectionKey: TKey;\r\n  objectId: string;\r\n  resourceKey: StringKeysOf<CruciblePackageSectionItem<TKey>>;\r\n  accept: string;\r\n  resourceName: string;\r\n  children?: React.ReactNode;\r\n}\r\n\r\nconst IdObjectResourceField = ({\r\n  sectionKey,\r\n  objectId,\r\n  resourceKey,\r\n  accept,\r\n  resourceName,\r\n  children,\r\n}: IdObjectResourceFieldProps) => {\r\n  const dispatch = useDispatch();\r\n  const obj = useSelector((state) =>\r\n    packageIdObjectDataSelector(state, sectionKey, objectId)\r\n  );\r\n\r\n  const onFileLoaded = React.useCallback(\r\n    (file: File) => {\r\n      file.arrayBuffer().then((buffer) => {\r\n        dispatch(\r\n          packageResourceSetById(\r\n            sectionKey,\r\n            objectId,\r\n            resourceKey,\r\n            `${resourceName}.${extname(file.name)}`,\r\n            new Uint8Array(buffer)\r\n          )\r\n        );\r\n      });\r\n    },\r\n    [sectionKey, objectId, resourceKey, resourceName]\r\n  );\r\n\r\n  if (!obj) {\r\n    return null;\r\n  }\r\n\r\n  const hasResource = obj[resourceKey] != null;\r\n\r\n  return (\r\n    <div>\r\n      {hasResource && <FontAwesomeIcon fixedWidth icon={faCheck} />}\r\n      {children && <span>{children}</span>}\r\n      <AbstractFileLoadButton accept={accept} onFileLoaded={onFileLoaded}>\r\n        {(props) => (\r\n          <Button {...props}>\r\n            <FontAwesomeIcon color=\"inherit\" icon={faFileUpload} />\r\n          </Button>\r\n        )}\r\n      </AbstractFileLoadButton>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default merge(IdObjectResourceField, {\r\n  ofType:\r\n    <TKey extends CruciblePackageSectionKey>(sectionKey: TKey) =>\r\n    (props: Omit<IdObjectResourceFieldProps<TKey>, \"sectionKey\">) =>\r\n      <IdObjectResourceField {...(props as any)} sectionKey={sectionKey} />,\r\n});\r\n","import IdObjectResourceField from \"./IdObjectResourceField\";\r\nexport default IdObjectResourceField;\r\n","import * as React from \"react\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faFileUpload } from \"@fortawesome/free-solid-svg-icons\";\r\nimport classNames from \"classnames\";\r\n\r\nimport { extname } from \"@/paths\";\r\n\r\nimport Button from \"../Button\";\r\nimport AbstractFileLoadButton from \"../AbstractFileLoadButton\";\r\n\r\nimport styles from \"./ImageField.module.css\";\r\n\r\nexport interface ImageFieldProps {\r\n  className?: string;\r\n  imageResource: Uint8Array | null;\r\n  imageResourceName: string | null;\r\n  onChange(image: Uint8Array, resourceName: string): void;\r\n}\r\n\r\nconst ImageField = ({\r\n  className,\r\n  imageResource,\r\n  imageResourceName,\r\n  onChange,\r\n}: ImageFieldProps) => {\r\n  const [isLoading, setLoading] = React.useState(false);\r\n  const imageUrl = React.useMemo(() => {\r\n    if (imageResource == null || imageResourceName == null) {\r\n      return null;\r\n    }\r\n    return URL.createObjectURL(\r\n      new Blob([imageResource.buffer], {\r\n        type: `image/${extname(imageResourceName)}`,\r\n      })\r\n    );\r\n  }, [imageResource, imageResourceName]);\r\n\r\n  const onFileLoaded = React.useCallback(\r\n    (file: File) => {\r\n      setLoading(true);\r\n      file\r\n        .arrayBuffer()\r\n        .then((buffer) => {\r\n          onChange(new Uint8Array(buffer), file.name);\r\n        })\r\n        .finally(() => {\r\n          setLoading(false);\r\n        });\r\n    },\r\n    [onChange]\r\n  );\r\n\r\n  return (\r\n    <div\r\n      className={classNames(\r\n        styles[\"imagefield\"],\r\n        imageUrl && styles[\"imagefield--has-image\"],\r\n        className\r\n      )}\r\n    >\r\n      <div className={styles[\"imagefield-upload\"]}>\r\n        <AbstractFileLoadButton accept=\"image/png\" onFileLoaded={onFileLoaded}>\r\n          {(props) => (\r\n            <Button {...props} disabled={isLoading}>\r\n              <FontAwesomeIcon color=\"inherit\" icon={faFileUpload} />\r\n            </Button>\r\n          )}\r\n        </AbstractFileLoadButton>\r\n      </div>\r\n      {imageUrl && (\r\n        <div className={styles[\"imagefield-image-container\"]}>\r\n          <img src={imageUrl} />\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ImageField;\r\n","import ImageField from \"./ImageField\";\r\nexport default ImageField;\r\n","import * as React from \"react\";\r\nimport classNames from \"classnames\";\r\n\r\nimport { useClickAction } from \"@/hooks/use-action\";\r\nimport { useSelector } from \"@/hooks/use-selector\";\r\n\r\nimport { mapEditorToolSet } from \"@/actions/map-editor/tool-set\";\r\n\r\nimport {\r\n  currentToolSelector,\r\n  toolRadiusSelector,\r\n} from \"@/services/map-editor/mouse/selectors/tools\";\r\n\r\nimport { mapEditorToolRadiusSet } from \"@/actions/map-editor/tool-radius-set\";\r\n\r\nimport Button from \"../Button\";\r\n\r\nimport PotionEffectsDropButton from \"./components/PotionEffectsDropButton\";\r\nimport BonesDropButton from \"./components/BonesDropButton\";\r\nimport VortexesDropButton from \"./components/VortexesDropButton\";\r\n\r\nimport styles from \"./MapEditorToolbar.module.css\";\r\n\r\nexport interface MapEditorToolBarProps {\r\n  className?: string;\r\n}\r\nconst MapEditorToolBar = ({ className }: MapEditorToolBarProps) => {\r\n  const toolSize = useSelector(toolRadiusSelector);\r\n  const currentTool = useSelector(currentToolSelector);\r\n  const onIncreaseToolSize = useClickAction(\r\n    mapEditorToolRadiusSet,\r\n    toolSize + 0.2\r\n  );\r\n  const onDecreaseToolSize = useClickAction(\r\n    mapEditorToolRadiusSet,\r\n    toolSize - 0.2\r\n  );\r\n  const onPointerClick = useClickAction(mapEditorToolSet, \"pointer\");\r\n  const onEraserClick = useClickAction(mapEditorToolSet, \"eraser\");\r\n  const onBonesClick = useClickAction(mapEditorToolSet, \"paint-danger-zone\");\r\n  return (\r\n    <div className={classNames(styles[\"map-toolbar\"], className)}>\r\n      <Button\r\n        variant={currentTool === \"pointer\" ? \"primary\" : \"default\"}\r\n        onClick={onPointerClick}\r\n      >\r\n        Pointer\r\n      </Button>\r\n      <Button\r\n        variant={currentTool === \"eraser\" ? \"primary\" : \"default\"}\r\n        onClick={onEraserClick}\r\n      >\r\n        Eraser\r\n      </Button>\r\n      <Button\r\n        variant={currentTool === \"paint-danger-zone\" ? \"primary\" : \"default\"}\r\n        onClick={onBonesClick}\r\n      >\r\n        Bones\r\n      </Button>\r\n      Brush Size:\r\n      <Button onClick={onDecreaseToolSize}>-</Button>\r\n      {toolSize.toFixed(1)}\r\n      <Button onClick={onIncreaseToolSize}>+</Button>\r\n      <div className={styles[\"map-toolbar-entities\"]}>\r\n        <PotionEffectsDropButton />\r\n        <BonesDropButton />\r\n        <VortexesDropButton />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MapEditorToolBar;\r\n","import * as React from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\n\r\nimport { DangerZonePartMapEntity } from \"@/map-config\";\r\n\r\nimport { SpawnableEntityPrototype } from \"@/services/map-editor/entities/types\";\r\n\r\nimport EntitiesDropButton from \"./EntitiesDropButton\";\r\n\r\nfunction bonePrototype(\r\n  type: string\r\n): SpawnableEntityPrototype<DangerZonePartMapEntity> {\r\n  return {\r\n    i18nKey: `entities.danger_zone_parts.type_names.${type}`,\r\n    entityType: \"DangerZonePart\",\r\n    prefab: type,\r\n    angle: 0,\r\n  };\r\n}\r\n\r\nconst boneItems = [\r\n  bonePrototype(\"Skull1\"),\r\n  bonePrototype(\"Bone1\"),\r\n  bonePrototype(\"Bone2\"),\r\n  bonePrototype(\"Fang1\"),\r\n  bonePrototype(\"Fang2\"),\r\n];\r\n\r\nconst PotionEffectsDropButton = () => {\r\n  const { t } = useTranslation();\r\n  return (\r\n    <EntitiesDropButton entityPrototypes={boneItems}>\r\n      {t(\"entities.danger_zone_parts.noun_titlecase_plural\")}\r\n    </EntitiesDropButton>\r\n  );\r\n};\r\n\r\nexport default PotionEffectsDropButton;\r\n","import * as React from \"react\";\r\n\r\nimport Button from \"@/components/Button\";\r\n\r\nimport EntitiesDropList from \"./EntitiesDropList\";\r\n\r\nimport { useBooleanSetState } from \"@/hooks/use-boolean-state\";\r\n\r\nimport { SpawnableEntityPrototype } from \"@/services/map-editor/entities/types\";\r\n\r\nimport Popper from \"@/components/Popper\";\r\nimport { MenuCloseListener } from \"@/components/Menus/MenuCloseContext\";\r\n\r\nexport interface EntitiesDropButtonProps {\r\n  entityPrototypes: SpawnableEntityPrototype[];\r\n  children: React.ReactNode;\r\n}\r\n\r\nconst EntitiesDropButton = ({\r\n  entityPrototypes,\r\n  children,\r\n}: EntitiesDropButtonProps) => {\r\n  const anchorEl = React.useRef<HTMLButtonElement | null>(null);\r\n\r\n  const [isOpen, setOpen, setClosed] = useBooleanSetState();\r\n\r\n  return (\r\n    <MenuCloseListener onClose={setClosed}>\r\n      <Button variant=\"primary\" ref={anchorEl} onClick={setOpen}>\r\n        {children}\r\n      </Button>\r\n      <Popper\r\n        anchorEl={anchorEl.current}\r\n        isOpen={isOpen}\r\n        placement=\"bottom-start\"\r\n        onRequestClose={setClosed}\r\n      >\r\n        {isOpen && <EntitiesDropList entityPrototypes={entityPrototypes} />}\r\n      </Popper>\r\n    </MenuCloseListener>\r\n  );\r\n};\r\n\r\nexport default EntitiesDropButton;\r\n","import * as React from \"react\";\r\nimport omit from \"lodash/omit\";\r\nimport { useDrag } from \"react-dnd\";\r\nimport { useTranslation } from \"react-i18next\";\r\n\r\nimport {\r\n  DRAGOBJECT_NEW_ENTITY,\r\n  newEntityDragObject,\r\n} from \"@/drag-items/new-entity\";\r\n\r\nimport { EntityDefsByType } from \"@/entities\";\r\n\r\nimport { useBooleanSetState } from \"@/hooks/use-boolean-state\";\r\n\r\nimport { SpawnableEntityPrototype } from \"@/services/map-editor/entities/types\";\r\nimport { renderResourcesSelector } from \"@/services/map-editor/entities/selectors/render-resources\";\r\n\r\nimport Tooltip from \"@/components/Tooltip/Tooltip\";\r\n\r\nimport styles from \"./EntitiesDropButton.module.css\";\r\nimport { useSelector } from \"@/hooks/use-selector\";\r\n\r\nexport interface EntitiesDropListProps {\r\n  entityPrototypes: SpawnableEntityPrototype[];\r\n}\r\n\r\nconst PotionEffectDragList = ({ entityPrototypes }: EntitiesDropListProps) => {\r\n  return (\r\n    <ul className={styles[\"entities-drop-list\"]}>\r\n      {entityPrototypes.map((entityPrototype, i) => (\r\n        <PotionEffectDraggableItem key={i} entityPrototype={entityPrototype} />\r\n      ))}\r\n    </ul>\r\n  );\r\n};\r\n\r\nexport default PotionEffectDragList;\r\n\r\ninterface EntityDropListItemProps {\r\n  entityPrototype: SpawnableEntityPrototype;\r\n}\r\n\r\nconst PotionEffectDraggableItem = ({\r\n  entityPrototype,\r\n}: EntityDropListItemProps) => {\r\n  const [selfRef, setSelfRef] = React.useState<HTMLLIElement | null>(null);\r\n  const { entityType, i18nKey, displayName } = entityPrototype;\r\n  const { t } = useTranslation();\r\n  const canvasRef = React.useRef<HTMLCanvasElement | null>(null);\r\n  const [, dragRef] = useDrag({\r\n    type: DRAGOBJECT_NEW_ENTITY,\r\n    item: newEntityDragObject(\r\n      omit(entityPrototype, [\"i18nKey\", \"displayName\"])\r\n    ),\r\n  });\r\n  const [isShowingTooltip, showTooltip, hideTooltip] = useBooleanSetState();\r\n  const renderResources = useSelector(renderResourcesSelector);\r\n\r\n  React.useLayoutEffect(() => {\r\n    const type = EntityDefsByType[entityType];\r\n    const canvas = canvasRef.current;\r\n    if (!canvas || !type) {\r\n      return;\r\n    }\r\n\r\n    const ctx = canvas.getContext(\"2d\")!;\r\n    ctx.scale(30, 30);\r\n    ctx.translate(0.5, 0.55);\r\n    ctx.scale(1, -1);\r\n    type.render(ctx, entityPrototype, () => {}, renderResources);\r\n  }, [entityType, renderResources]);\r\n\r\n  return (\r\n    <li\r\n      className={styles[\"entities-drop-list-item\"]}\r\n      ref={(ref) => {\r\n        dragRef(ref);\r\n        setSelfRef(ref);\r\n      }}\r\n      onMouseOut={hideTooltip}\r\n      onClick={showTooltip}\r\n    >\r\n      <span>\r\n        <canvas ref={canvasRef} width={30} height={30} />\r\n      </span>\r\n      <span>{i18nKey ? t(i18nKey) : displayName}</span>\r\n      <Tooltip anchorEl={selfRef} isOpen={isShowingTooltip}>\r\n        {t(\"entities.message_click_drag_create\")}\r\n      </Tooltip>\r\n    </li>\r\n  );\r\n};\r\n","import EntitiesDropButton from \"./EntitiesDropButton\";\r\nexport default EntitiesDropButton;\r\n","import * as React from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\n\r\nimport { useSelector } from \"@/hooks/use-selector\";\r\n\r\nimport { potionEffectEntityPrototypesSelector } from \"@/services/map-editor/entities/selectors/prototypes\";\r\n\r\nimport EntitiesDropButton from \"./EntitiesDropButton\";\r\n\r\nconst PotionEffectsDropButton = () => {\r\n  const effects = useSelector(potionEffectEntityPrototypesSelector);\r\n  const { t } = useTranslation();\r\n  return (\r\n    <EntitiesDropButton entityPrototypes={effects}>\r\n      {t(\"potion_effect.noun_titlecase_plural\")}\r\n    </EntitiesDropButton>\r\n  );\r\n};\r\n\r\nexport default PotionEffectsDropButton;\r\n","import * as React from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\n\r\nimport { VortexMapEntity } from \"@/map-config\";\r\n\r\nimport { SpawnableEntityPrototype } from \"@/services/map-editor/entities/types\";\r\n\r\nimport EntitiesDropButton from \"./EntitiesDropButton\";\r\n\r\nfunction vortexPrototype(\r\n  type: string\r\n): SpawnableEntityPrototype<VortexMapEntity> {\r\n  return {\r\n    i18nKey: `entities.vortexes.type_names.${type}`,\r\n    entityType: \"Vortex\",\r\n    prefab: type,\r\n  };\r\n}\r\n\r\nconst vortexItems = [vortexPrototype(\"Medium\"), vortexPrototype(\"Large\")];\r\n\r\nconst PotionEffectsDropButton = () => {\r\n  const { t } = useTranslation();\r\n  return (\r\n    <EntitiesDropButton entityPrototypes={vortexItems}>\r\n      {t(\"entities.vortexes.noun_titlecase_plural\")}\r\n    </EntitiesDropButton>\r\n  );\r\n};\r\n\r\nexport default PotionEffectsDropButton;\r\n","import MapEditorToolBar from \"./MapEditorToolBar\";\r\nexport default MapEditorToolBar;\r\n","import * as React from \"react\";\r\nimport classNames from \"classnames\";\r\nimport { AnyAction } from \"redux\";\r\nimport { HotKeys, ComponentProps } from \"react-hotkeys\";\r\nimport { useDispatch } from \"react-redux\";\r\n\r\nimport { mapEditorSelectionDelete } from \"@/actions/map-editor/selection-delete\";\r\n\r\nimport PanZoomHandler from \"./components/PanZoomHandler\";\r\nimport MapCanvas from \"./components/MapCanvas\";\r\nimport MapWidgets from \"./components/MapWidgets\";\r\nimport DragPreview from \"./components/DragPreview\";\r\n\r\nimport keymap, { HotkeyHandler, KeymapHandler, KEYMAP_DELETE } from \"./keymap\";\r\n\r\nimport styles from \"./MapEditor.module.css\";\r\n\r\nexport interface MapEditorProps {\r\n  className?: string;\r\n}\r\nconst MapEditor = ({ className }: MapEditorProps) => {\r\n  const dispatch = useDispatch();\r\n  const keyHandlers = React.useMemo(() => {\r\n    function createEventDispatcher(action: AnyAction): HotkeyHandler {\r\n      return (e?: KeyboardEvent) => {\r\n        if (e) {\r\n          if (e.defaultPrevented) {\r\n            return;\r\n          }\r\n          e.preventDefault();\r\n        }\r\n        dispatch(action);\r\n      };\r\n    }\r\n    const keyHandlers: KeymapHandler = {\r\n      [KEYMAP_DELETE]: createEventDispatcher(mapEditorSelectionDelete()),\r\n    };\r\n    return keyHandlers;\r\n  }, []);\r\n\r\n  return (\r\n    <div className={classNames(className, \"map-editor\", styles[\"map-editor\"])}>\r\n      <HotKeys\r\n        keyMap={keymap}\r\n        handlers={keyHandlers}\r\n        component={HotkeysContainer}\r\n      >\r\n        <PanZoomHandler className={styles[\"map-editor-container\"]}>\r\n          <MapCanvas className={styles[\"map-editor-item\"]} />\r\n          <DragPreview className={styles[\"map-editor-item\"]} />\r\n          <MapWidgets className={styles[\"map-editor-item\"]} />\r\n        </PanZoomHandler>\r\n      </HotKeys>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst HotkeysContainer: React.FC<ComponentProps> = ({ children, ...props }) => {\r\n  return (\r\n    // Mask ref type.  It is compatible, but HotKey typings are wonky.\r\n    <div {...(props as any)} className={styles[\"hotkeys-container\"]}>\r\n      {children}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MapEditor;\r\n","import * as React from \"react\";\r\nimport classNames from \"classnames\";\r\n\r\nimport styles from \"./DragPreview.module.css\";\r\n\r\nimport { renderEntity, transformToMap } from \"@/canvas\";\r\n\r\nimport { useSelector } from \"@/hooks/use-selector\";\r\n\r\nimport { entitiesByKeySelector } from \"@/services/map-editor/entities/selectors/entities\";\r\nimport { selectedEntityKeysSelector } from \"@/services/map-editor/selection/selectors/selection\";\r\nimport {\r\n  editorOffsetXSelector,\r\n  editorOffsetYSelector,\r\n  editorZoomFactorSelector,\r\n} from \"@/services/map-editor/view/selectors/view\";\r\nimport { dragMoveOffsetSelector } from \"@/services/map-editor/mouse/selectors/drag-move\";\r\nimport {\r\n  editorViewportHeightSelector,\r\n  editorViewportWidthSelector,\r\n} from \"@/services/map-editor/view/selectors/viewport\";\r\nimport { renderResourcesSelector } from \"@/services/map-editor/entities/selectors/render-resources\";\r\n\r\nexport interface DragPreviewProps {\r\n  className?: string;\r\n}\r\nconst DragPreview = ({ className }: DragPreviewProps) => {\r\n  const entitiesByKey = useSelector(entitiesByKeySelector);\r\n  const selectedEntityKeys = useSelector(selectedEntityKeysSelector);\r\n  const offsetX = useSelector(editorOffsetXSelector);\r\n  const offsetY = useSelector(editorOffsetYSelector);\r\n  const zoomFactor = useSelector(editorZoomFactorSelector);\r\n  const viewportWidth = useSelector(editorViewportWidthSelector);\r\n  const viewportHeight = useSelector(editorViewportHeightSelector);\r\n  const dragMoveOffset = useSelector(dragMoveOffsetSelector);\r\n  const renderResources = useSelector(renderResourcesSelector);\r\n\r\n  const canvasRef = React.useRef<HTMLCanvasElement | null>(null);\r\n\r\n  React.useEffect(() => {\r\n    if (!canvasRef.current) {\r\n      return;\r\n    }\r\n\r\n    const ctx = canvasRef.current.getContext(\"2d\")!;\r\n\r\n    ctx.clearRect(0, 0, canvasRef.current.width, canvasRef.current.height);\r\n\r\n    transformToMap(ctx, zoomFactor, offsetX, offsetY, () => {\r\n      if (dragMoveOffset != null) {\r\n        ctx.translate(dragMoveOffset.x, dragMoveOffset.y);\r\n        for (const key of selectedEntityKeys) {\r\n          const entity = entitiesByKey[key];\r\n          renderEntity(ctx, entity, true, renderResources);\r\n        }\r\n      }\r\n    });\r\n  }, [\r\n    entitiesByKey,\r\n    selectedEntityKeys,\r\n    offsetX,\r\n    offsetY,\r\n    zoomFactor,\r\n    dragMoveOffset,\r\n  ]);\r\n\r\n  return (\r\n    <canvas\r\n      ref={canvasRef}\r\n      className={classNames(className, styles[\"drag-preview\"])}\r\n      width={viewportWidth}\r\n      height={viewportHeight}\r\n    />\r\n  );\r\n};\r\n\r\nexport default DragPreview;\r\n","import DragPreview from \"./DragPreview\";\r\nexport default DragPreview;\r\n","import * as React from \"react\";\r\nimport { useDispatch, useStore } from \"react-redux\";\r\nimport { useDrop } from \"react-dnd\";\r\nimport classNames from \"classnames\";\r\n\r\nimport { getModifiers } from \"@/modifier-keys\";\r\nimport { normalizeRectangle, pointIntersectsRect, Rectangle } from \"@/geometry\";\r\n\r\nimport { renderEntity, renderPotionStart, transformToMap } from \"@/canvas\";\r\n\r\nimport {\r\n  DRAGOBJECT_NEW_ENTITY,\r\n  isNewEntityDragObject,\r\n} from \"@/drag-items/new-entity\";\r\n\r\nimport { LargestEntityRadius } from \"@/entities\";\r\n\r\nimport { useSelector } from \"@/hooks/use-selector\";\r\nimport { useComponentBounds } from \"@/hooks/use-component-bounds\";\r\nimport { mapEditorMouseDown } from \"@/actions/map-editor/mouse-down\";\r\nimport { mapEditorMouseMove } from \"@/actions/map-editor/mouse-move\";\r\nimport { mapEditorMouseUp } from \"@/actions/map-editor/mouse-up\";\r\nimport { mapEditorEntityPrototypeInstantiate } from \"@/actions/map-editor/entity-prototype-instantiate\";\r\nimport { mapEditorModifierKeysChanged } from \"@/actions/map-editor/modifierkeys-changed\";\r\nimport { mapEditorRendered } from \"@/actions/map-editor/rendered\";\r\n\r\nimport {\r\n  editorViewportHeightSelector,\r\n  editorViewportWidthSelector,\r\n} from \"@/services/map-editor/view/selectors/viewport\";\r\nimport { useClientToWorld } from \"@/services/map-editor/view/hooks/use-client-to-world\";\r\nimport { entitiesByKeySelector } from \"@/services/map-editor/entities/selectors/entities\";\r\nimport {\r\n  editorOffsetXSelector,\r\n  editorOffsetYSelector,\r\n  editorZoomFactorSelector,\r\n} from \"@/services/map-editor/view/selectors/view\";\r\nimport { selectedEntityKeysSelector } from \"@/services/map-editor/selection/selectors/selection\";\r\nimport { dragMoveOffsetSelector } from \"@/services/map-editor/mouse/selectors/drag-move\";\r\nimport { editorDamageRectSelector } from \"@/services/map-editor/damage/selector/damage\";\r\nimport { worldToClientSelector } from \"@/services/map-editor/view/selectors/coordinate-mapping\";\r\nimport { renderResourcesSelector } from \"@/services/map-editor/entities/selectors/render-resources\";\r\n\r\nimport styles from \"./MapCanvas.module.css\";\r\n\r\nexport interface MapCanvasProps {\r\n  className?: string;\r\n}\r\n\r\nconst MapCanvas = ({ className }: MapCanvasProps) => {\r\n  const dispatch = useDispatch();\r\n  const store = useStore();\r\n\r\n  const pointerRef = React.useRef<number | null>(null);\r\n  const canvasRef = React.useRef<HTMLCanvasElement | null>(null);\r\n  const canvasBounds = useComponentBounds(canvasRef);\r\n  const viewportWidth = useSelector(editorViewportWidthSelector);\r\n  const viewportHeight = useSelector(editorViewportHeightSelector);\r\n\r\n  const renderResources = useSelector(renderResourcesSelector);\r\n\r\n  const clientToWorld = useClientToWorld();\r\n\r\n  const eventCanvasPoint = React.useCallback(\r\n    (e: React.MouseEvent | MouseEvent) => {\r\n      return {\r\n        x: e.clientX - canvasBounds.left,\r\n        y: e.clientY - canvasBounds.top,\r\n      };\r\n    },\r\n    [canvasBounds]\r\n  );\r\n\r\n  const onMouseEnter = React.useCallback(() => {\r\n    canvasRef.current?.focus();\r\n  }, []);\r\n\r\n  const onPointerDown = React.useCallback(\r\n    (e: React.PointerEvent) => {\r\n      if (pointerRef.current !== null && pointerRef.current !== e.pointerId) {\r\n        return;\r\n      }\r\n      pointerRef.current = e.pointerId;\r\n      e.currentTarget.setPointerCapture(e.pointerId);\r\n\r\n      const modifiers = getModifiers(e);\r\n      const p = eventCanvasPoint(e);\r\n      dispatch(mapEditorMouseDown(p, modifiers));\r\n    },\r\n    [eventCanvasPoint]\r\n  );\r\n\r\n  const onPointerMove = React.useCallback(\r\n    (e: React.PointerEvent) => {\r\n      if (pointerRef.current !== null && pointerRef.current !== e.pointerId) {\r\n        return;\r\n      }\r\n\r\n      const modifiers = getModifiers(e);\r\n      const p = eventCanvasPoint(e);\r\n      dispatch(mapEditorMouseMove(p, modifiers));\r\n    },\r\n    [eventCanvasPoint]\r\n  );\r\n\r\n  const onPointerUp = React.useCallback(\r\n    (e: React.PointerEvent) => {\r\n      if (pointerRef.current !== null && pointerRef.current !== e.pointerId) {\r\n        return;\r\n      }\r\n\r\n      e.currentTarget.releasePointerCapture(e.pointerId);\r\n      pointerRef.current = null;\r\n\r\n      const modifiers = getModifiers(e);\r\n      const p = eventCanvasPoint(e);\r\n      dispatch(mapEditorMouseUp(p, modifiers));\r\n    },\r\n    [eventCanvasPoint]\r\n  );\r\n\r\n  const onKeyDown = React.useCallback((e: React.KeyboardEvent) => {\r\n    const modifiers = getModifiers(e);\r\n    dispatch(mapEditorModifierKeysChanged(modifiers));\r\n    if (e.key === \"Alt\") {\r\n      e.preventDefault();\r\n    }\r\n  }, []);\r\n\r\n  const onKeyUp = React.useCallback((e: React.KeyboardEvent) => {\r\n    const modifiers = getModifiers(e);\r\n    dispatch(mapEditorModifierKeysChanged(modifiers));\r\n    if (e.key === \"Alt\") {\r\n      e.preventDefault();\r\n    }\r\n  }, []);\r\n\r\n  const [_, dropRef] = useDrop(\r\n    {\r\n      accept: DRAGOBJECT_NEW_ENTITY,\r\n      drop: (item, monitor) => {\r\n        if (!isNewEntityDragObject(item)) {\r\n          return;\r\n        }\r\n\r\n        const { prototype } = item.payload;\r\n\r\n        const p = monitor.getClientOffset();\r\n        if (!p) {\r\n          return;\r\n        }\r\n        p.x -= canvasBounds.left;\r\n        p.y -= canvasBounds.top;\r\n        const worldP = clientToWorld(p);\r\n        dispatch(mapEditorEntityPrototypeInstantiate(prototype, worldP));\r\n      },\r\n    },\r\n    [clientToWorld, canvasBounds]\r\n  );\r\n\r\n  React.useEffect(() => {\r\n    let animationFrame: number | null = null;\r\n\r\n    function render() {\r\n      animationFrame = null;\r\n\r\n      if (!canvasRef.current) {\r\n        return;\r\n      }\r\n\r\n      const state = store.getState();\r\n      const entitiesByKey = entitiesByKeySelector(state);\r\n      const selectedEntityKeys = selectedEntityKeysSelector(state);\r\n      const offsetX = editorOffsetXSelector(state);\r\n      const offsetY = editorOffsetYSelector(state);\r\n      const zoomFactor = editorZoomFactorSelector(state);\r\n      const dragMoveOffset = dragMoveOffsetSelector(state);\r\n      let damageRect = editorDamageRectSelector(state);\r\n\r\n      if (!damageRect) {\r\n        // Nothing to redraw\r\n        return;\r\n      }\r\n\r\n      // Increment the damage rect to account for entity radius that needs to be cleared.\r\n      // TODO: Restrict this to the visible viewport.\r\n      damageRect = {\r\n        p1: {\r\n          x: damageRect.p1.x - LargestEntityRadius,\r\n          y: damageRect.p1.y - LargestEntityRadius,\r\n        },\r\n        p2: {\r\n          x: damageRect.p2.x + LargestEntityRadius,\r\n          y: damageRect.p2.y + LargestEntityRadius,\r\n        },\r\n      };\r\n\r\n      // Increment redraw yet again to redraw entities that were partially cut by the clear\r\n      const redrawRect: Rectangle = {\r\n        p1: {\r\n          x: damageRect.p1.x - LargestEntityRadius,\r\n          y: damageRect.p1.y - LargestEntityRadius,\r\n        },\r\n        p2: {\r\n          x: damageRect.p2.x + LargestEntityRadius,\r\n          y: damageRect.p2.y + LargestEntityRadius,\r\n        },\r\n      };\r\n\r\n      const ctx = canvasRef.current.getContext(\"2d\")!;\r\n\r\n      const clearClientP1 = worldToClientSelector(state, damageRect.p1);\r\n      const clearClientP2 = worldToClientSelector(state, damageRect.p2);\r\n      const clearRect = normalizeRectangle(clearClientP1, clearClientP2);\r\n      ctx.clearRect(\r\n        Math.max(0, clearRect.p1.x),\r\n        Math.max(0, clearRect.p1.y),\r\n        Math.min(ctx.canvas.width, clearRect.p2.x - clearRect.p1.x),\r\n        Math.min(ctx.canvas.height, clearRect.p2.y - clearRect.p1.y)\r\n      );\r\n\r\n      transformToMap(ctx, zoomFactor, offsetX, offsetY, () => {\r\n        ctx.beginPath();\r\n        ctx.lineWidth = 0.2;\r\n        ctx.setLineDash([2, 2]);\r\n        ctx.moveTo(-60, -60);\r\n        ctx.lineTo(-60, 60);\r\n        ctx.lineTo(60, 60);\r\n        ctx.lineTo(60, -60);\r\n        ctx.lineTo(-60, -60);\r\n        ctx.stroke();\r\n\r\n        renderPotionStart(ctx);\r\n\r\n        let renderCount = 0;\r\n        for (const key of Object.keys(entitiesByKey)) {\r\n          const entity = entitiesByKey[key];\r\n          if (!pointIntersectsRect(entity, redrawRect)) {\r\n            continue;\r\n          }\r\n          const isSelected = selectedEntityKeys.includes(key);\r\n          if (dragMoveOffset != null && isSelected) {\r\n            continue;\r\n          }\r\n          renderCount++;\r\n          renderEntity(ctx, entity, isSelected, renderResources);\r\n        }\r\n      });\r\n\r\n      dispatch(mapEditorRendered());\r\n    }\r\n\r\n    function requestRender() {\r\n      if (animationFrame != null) {\r\n        return;\r\n      }\r\n      animationFrame = requestAnimationFrame(render);\r\n    }\r\n\r\n    const unsubscribe = store.subscribe(requestRender);\r\n\r\n    return () => {\r\n      if (animationFrame) {\r\n        cancelAnimationFrame(animationFrame);\r\n        animationFrame = null;\r\n      }\r\n      unsubscribe();\r\n    };\r\n  }, []);\r\n\r\n  return (\r\n    <canvas\r\n      tabIndex={-1}\r\n      className={classNames(className, styles[\"map-canvas\"])}\r\n      ref={(ref) => {\r\n        canvasRef.current = ref;\r\n        dropRef(ref);\r\n      }}\r\n      width={viewportWidth}\r\n      height={viewportHeight}\r\n      onMouseEnter={onMouseEnter}\r\n      onPointerDown={onPointerDown}\r\n      onPointerMove={onPointerMove}\r\n      onPointerUp={onPointerUp}\r\n      onKeyDown={onKeyDown}\r\n      onKeyUp={onKeyUp}\r\n    />\r\n  );\r\n};\r\n\r\nexport default MapCanvas;\r\n","import * as React from \"react\";\r\nimport classNames from \"classnames\";\r\n\r\nimport { useSelector } from \"@/hooks/use-selector\";\r\n\r\nimport { viewportMousePosSelector } from \"@/services/map-editor/mouse/selectors/viewport\";\r\nimport {\r\n  currentToolSelector,\r\n  toolViewportRadiusSelector,\r\n} from \"@/services/map-editor/mouse/selectors/tools\";\r\nimport { dragSelectionRectSelector } from \"@/services/map-editor/mouse/selectors/drag-select\";\r\n\r\nimport styles from \"./MapWidgets.module.css\";\r\n\r\nexport interface MapWidgetsProps {\r\n  className?: string;\r\n}\r\n\r\nconst MapWidgets = ({ className }: MapWidgetsProps) => {\r\n  const selectionRect = useSelector(dragSelectionRectSelector);\r\n  const mousePos = useSelector(viewportMousePosSelector);\r\n  const toolRadius = useSelector(toolViewportRadiusSelector);\r\n  const tool = useSelector(currentToolSelector);\r\n\r\n  return (\r\n    <svg\r\n      className={classNames(className, styles[\"map-widgets\"])}\r\n      width=\"100%\"\r\n      height=\"100%\"\r\n    >\r\n      {selectionRect && (\r\n        <rect\r\n          x={selectionRect.p1.x}\r\n          y={selectionRect.p1.y}\r\n          width={selectionRect.p2.x - selectionRect.p1.x}\r\n          height={selectionRect.p2.y - selectionRect.p1.y}\r\n          stroke=\"lightblue\"\r\n          strokeWidth={3}\r\n          opacity={0.5}\r\n          strokeDasharray=\"6,6\"\r\n        />\r\n      )}\r\n      {mousePos && (tool === \"eraser\" || tool === \"paint-danger-zone\") && (\r\n        <circle\r\n          cx={mousePos.x}\r\n          cy={mousePos.y}\r\n          r={toolRadius}\r\n          stroke=\"lightblue\"\r\n          opacity={0.5}\r\n          strokeWidth={3}\r\n        />\r\n      )}\r\n    </svg>\r\n  );\r\n};\r\n\r\nexport default MapWidgets;\r\n","import MapWidgets from \"./MapWidgets\";\r\nexport default MapWidgets;\r\n","import * as React from \"react\";\r\nimport classNames from \"classnames\";\r\nimport { useDispatch } from \"react-redux\";\r\n\r\nimport { getModifiers } from \"@/modifier-keys\";\r\n\r\nimport { useComponentBounds } from \"@/hooks/use-component-bounds\";\r\nimport { useNativeEvent } from \"@/hooks/use-native-event\";\r\nimport { useSelector } from \"@/hooks/use-selector\";\r\n\r\nimport { editorZoomFactorSelector } from \"@/services/map-editor/view/selectors/view\";\r\n\r\nimport { mapEditorViewportResize } from \"@/actions/map-editor/viewport-resize\";\r\nimport { mapEditorZoom } from \"@/actions/map-editor/zoom\";\r\nimport { mapEditorPan } from \"@/actions/map-editor/pan\";\r\n\r\nimport style from \"./PanZoomHandler.module.css\";\r\n\r\nexport interface PanZoomHandlerProps {\r\n  className?: string;\r\n  children: React.ReactNode;\r\n}\r\n\r\nexport const ZOOM_FACTOR = 1.07;\r\nexport const PAN_FACTOR = 0.5;\r\n\r\nconst PanZoomHandler = ({ className, children }: PanZoomHandlerProps) => {\r\n  const dispatch = useDispatch();\r\n  const zoomFactor = useSelector(editorZoomFactorSelector);\r\n\r\n  const containerRef = React.useRef<HTMLDivElement | null>(null);\r\n  const containerBounds = useComponentBounds(containerRef);\r\n\r\n  React.useLayoutEffect(() => {\r\n    dispatch(\r\n      mapEditorViewportResize(containerBounds.width, containerBounds.height)\r\n    );\r\n  }, [containerBounds.width, containerBounds.height]);\r\n\r\n  const onWheel = React.useCallback(\r\n    (e: WheelEvent) => {\r\n      const target = containerRef.current;\r\n      if (!target || e.defaultPrevented) {\r\n        return;\r\n      }\r\n\r\n      const modifiers = getModifiers(e);\r\n\r\n      if (modifiers.ctrlMetaKey) {\r\n        const nextZoom =\r\n          e.deltaY < 0 ? zoomFactor * ZOOM_FACTOR : zoomFactor / ZOOM_FACTOR;\r\n        dispatch(mapEditorZoom(nextZoom));\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n      } else if (modifiers.shiftKey) {\r\n        dispatch(mapEditorPan((e.deltaY * PAN_FACTOR) / zoomFactor, 0));\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n      } else {\r\n        dispatch(mapEditorPan(0, (e.deltaY * PAN_FACTOR) / zoomFactor));\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n      }\r\n    },\r\n    [zoomFactor]\r\n  );\r\n\r\n  // React listens to the root listener for all events,\r\n  //  and chrome assumes the root event listener for mouse events\r\n  //  never wants to preventDefault.\r\n  // We need to take a local event listener and mark it as not passive.\r\n  // https://github.com/facebook/react/issues/14856\r\n  useNativeEvent(containerRef, \"wheel\", onWheel, { passive: false });\r\n\r\n  return (\r\n    <div\r\n      className={classNames(className, style[\"pan-zoom-handler\"])}\r\n      ref={containerRef}\r\n    >\r\n      {children}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PanZoomHandler;\r\n","import PanZoomHandler from \"./PanZoomHandler\";\r\nexport default PanZoomHandler;\r\n","import MapEditor from \"./MapEditor\";\r\nexport * from \"./MapEditor\";\r\nexport default MapEditor;\r\n","export const KEYMAP_DELETE = \"keymap:MapEditor/Delete\" as const;\r\n\r\nconst keymap = {\r\n  [KEYMAP_DELETE]: [\"backspace\", \"del\"],\r\n};\r\nexport default keymap;\r\n\r\nexport type KeymapKeys = keyof typeof keymap;\r\nexport type HotkeyHandler = (keyEvent?: KeyboardEvent) => void;\r\nexport type KeymapHandler = Record<KeymapKeys, HotkeyHandler>;\r\n","import * as React from \"react\";\r\n\r\nimport styles from \"./Menus.module.css\";\r\n\r\nconst DividerMenuItem: React.FC = () => {\r\n  return <div className={styles[\"menu-divider\"]} />;\r\n};\r\n\r\nexport default DividerMenuItem;\r\n","import * as React from \"react\";\r\n\r\nimport styles from \"./Menus.module.css\";\r\n\r\nconst Menu: React.FC = ({ children }) => {\r\n  return <ul className={styles[\"menu\"]}>{children}</ul>;\r\n};\r\n\r\nexport default Menu;\r\n","import * as React from \"react\";\r\n\r\nfunction noop() {\r\n  /* Do nothing */\r\n}\r\n\r\nconst MenuCloseContext = React.createContext<() => void>(noop);\r\n\r\nexport function useMenuCloseContext() {\r\n  return React.useContext(MenuCloseContext);\r\n}\r\n\r\nexport interface MenuCloseListenerProps {\r\n  onClose?(): void;\r\n  children?: React.ReactNode;\r\n}\r\nexport const MenuCloseListener = ({\r\n  onClose: onCloseProp,\r\n  children,\r\n}: MenuCloseListenerProps) => {\r\n  const onCloseChain = useMenuCloseContext();\r\n  const onClose = React.useCallback(() => {\r\n    if (onCloseProp) onCloseProp();\r\n    if (onCloseChain) onCloseChain();\r\n  }, [onCloseProp, onCloseChain]);\r\n\r\n  return (\r\n    <MenuCloseContext.Provider value={onClose}>\r\n      {children}\r\n    </MenuCloseContext.Provider>\r\n  );\r\n};\r\n","import * as React from \"react\";\r\nimport classNames from \"classnames\";\r\n\r\nimport styles from \"./Menus.module.css\";\r\nimport { useMenuCloseContext } from \"./MenuCloseContext\";\r\n\r\nexport interface MenuItemProps {\r\n  autoDismissMenu?: boolean;\r\n  disabled?: boolean;\r\n  secondary?: string;\r\n  onClick?(e: React.MouseEvent<HTMLElement>): void;\r\n}\r\nconst MenuItem: React.FC<MenuItemProps> = ({\r\n  autoDismissMenu = true,\r\n  disabled,\r\n  onClick,\r\n  secondary,\r\n  children,\r\n}) => {\r\n  const requestMenuClose = useMenuCloseContext();\r\n  const onItemClick = React.useCallback(\r\n    (e: React.MouseEvent<HTMLElement>) => {\r\n      if (onClick) {\r\n        onClick(e);\r\n      }\r\n      if (autoDismissMenu) requestMenuClose();\r\n    },\r\n    [autoDismissMenu, requestMenuClose, onClick]\r\n  );\r\n  return (\r\n    <li\r\n      className={classNames(\r\n        styles[\"menu-item\"],\r\n        disabled && styles[\"menu-item--disabled\"]\r\n      )}\r\n      onClick={onItemClick}\r\n    >\r\n      <a className={styles[\"menu-item-content\"]}>\r\n        <span className={styles[\"menu-item-text\"]}>{children}</span>\r\n        {secondary && (\r\n          <span className={styles[\"menu-item-secondary\"]}>{secondary}</span>\r\n        )}\r\n      </a>\r\n    </li>\r\n  );\r\n};\r\n\r\nexport default MenuItem;\r\n","import * as React from \"react\";\r\nimport classNames from \"classnames\";\r\n\r\nimport AutoPopper from \"@/components/AutoPopper\";\r\n\r\nimport styles from \"./Menus.module.css\";\r\n\r\nexport interface SubMenuItemProps {\r\n  disabled?: boolean;\r\n  secondary?: string;\r\n  content: JSX.Element;\r\n}\r\nconst SubMenuItem: React.FC<SubMenuItemProps> = ({\r\n  disabled,\r\n  secondary,\r\n  content,\r\n  children,\r\n}) => {\r\n  return (\r\n    <li\r\n      className={classNames(\r\n        styles[\"menu-item\"],\r\n        disabled && styles[\"menu-item--disabled\"]\r\n      )}\r\n    >\r\n      <AutoPopper placement=\"right-start\" content={content}>\r\n        <a className={styles[\"menu-item-content\"]}>\r\n          <span className={styles[\"menu-item-text\"]}>{children}</span>\r\n          {secondary && (\r\n            <span className={styles[\"menu-item-secondary\"]}>{secondary}</span>\r\n          )}\r\n          <svg className={styles[\"menu-item-icon\"]} width={12} height={12}>\r\n            <path d=\"M0,0 l6,6 l-6,6 z\" fill=\"black\" strokeWidth={0} />\r\n          </svg>\r\n        </a>\r\n      </AutoPopper>\r\n    </li>\r\n  );\r\n};\r\n\r\nexport default SubMenuItem;\r\n","import cls from \"classnames\";\r\nimport * as React from \"react\";\r\nimport { createPortal } from \"react-dom\";\r\nimport { FocusOn, AutoFocusInside } from \"react-focus-on\";\r\n\r\nimport styles from \"./Modal.module.css\";\r\n\r\nexport interface ModalProps {\r\n  className?: string;\r\n  isOpen: boolean;\r\n  onRequestClose?(): void;\r\n}\r\n\r\nconst Modal: React.FC<ModalProps> = ({\r\n  className,\r\n  isOpen,\r\n  onRequestClose,\r\n  children,\r\n}) => {\r\n  if (!isOpen) {\r\n    return null;\r\n  }\r\n\r\n  return createPortal(\r\n    <div className={cls(\"modal\", styles[\"modal\"])}>\r\n      <FocusOn onClickOutside={onRequestClose} onEscapeKey={onRequestClose}>\r\n        <div className={cls(styles[\"modal-content\"], className)}>\r\n          <AutoFocusInside className={styles[\"modal-autofocus\"]}>\r\n            {children}\r\n          </AutoFocusInside>\r\n        </div>\r\n      </FocusOn>\r\n    </div>,\r\n    document.body\r\n  );\r\n};\r\n\r\nexport default Modal;\r\n","import Modal from \"./Modal\";\r\nexport default Modal;\r\n","import * as React from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useDispatch } from \"react-redux\";\r\n\r\nimport { useSelector } from \"@/hooks/use-selector\";\r\n\r\nimport { packageIdObjectIdsSelector } from \"@/services/package/selectors/package\";\r\nimport { navtreeExpandedValuesSelector } from \"@/services/navigation/selectors\";\r\n\r\nimport { navtreeExpandedValuesSet } from \"@/actions/navigation/navtree-expanded-set\";\r\n\r\nimport Tree from \"./Tree/Tree\";\r\nimport LinkTreeItem from \"./Tree/LinkTreeItem\";\r\n\r\nexport interface PackageContentTreeProps {\r\n  className?: string;\r\n}\r\n\r\nconst PackageContentTree = ({ className }: PackageContentTreeProps) => {\r\n  const dispatch = useDispatch();\r\n  const { t } = useTranslation();\r\n\r\n  const navtreeExpandedValues = useSelector(navtreeExpandedValuesSelector);\r\n  const onExpandedValuesChanged = React.useCallback((values: string[]) => {\r\n    dispatch(navtreeExpandedValuesSet(values));\r\n  }, []);\r\n\r\n  const ingredientIds = useSelector((state) =>\r\n    packageIdObjectIdsSelector(state, \"ingredients\")\r\n  );\r\n  const potionBaseIds = useSelector((state) =>\r\n    packageIdObjectIdsSelector(state, \"potionBases\")\r\n  );\r\n  const potionEffectIds = useSelector((state) =>\r\n    packageIdObjectIdsSelector(state, \"potionEffects\")\r\n  );\r\n  const potionBottleIds = useSelector((state) =>\r\n    packageIdObjectIdsSelector(state, \"potionBottles\")\r\n  );\r\n  return (\r\n    <Tree\r\n      className={className}\r\n      expandedValues={navtreeExpandedValues}\r\n      onExpandedValuesChanged={onExpandedValuesChanged}\r\n    >\r\n      <LinkTreeItem value=\"home\" to=\"/\" label={t(\"package.noun_titlecase\")}>\r\n        <LinkTreeItem\r\n          value=\"ingredients\"\r\n          to=\"/ingredients\"\r\n          label={t(\"ingredient.noun_titlecase_plural\")}\r\n        >\r\n          {ingredientIds.map((id) => (\r\n            <LinkTreeItem\r\n              value={`ingredients/${id}`}\r\n              key={id}\r\n              label={id}\r\n              to={`/ingredients/${id}`}\r\n            />\r\n          ))}\r\n        </LinkTreeItem>\r\n        <LinkTreeItem\r\n          value=\"potion-bases\"\r\n          to=\"/potion-bases\"\r\n          label={t(\"potion_base.noun_titlecase_plural\")}\r\n        >\r\n          {potionBaseIds.map((id) => (\r\n            <LinkTreeItem\r\n              value={`potion-bases/${id}`}\r\n              key={id}\r\n              label={id}\r\n              to={`/potion-bases/${id}`}\r\n            />\r\n          ))}\r\n        </LinkTreeItem>\r\n        <LinkTreeItem\r\n          value=\"potion-effects\"\r\n          to=\"/potion-effects\"\r\n          label={t(\"potion_effect.noun_titlecase_plural\")}\r\n        >\r\n          {potionEffectIds.map((id) => (\r\n            <LinkTreeItem\r\n              value={`potion-effects/${id}`}\r\n              key={id}\r\n              label={id}\r\n              to={`/potion-effects/${id}`}\r\n            />\r\n          ))}\r\n        </LinkTreeItem>\r\n        <LinkTreeItem\r\n          value=\"potion-bottles\"\r\n          to=\"/potion-bottles\"\r\n          label={t(\"potion_bottle.noun_titlecase_plural\")}\r\n        >\r\n          {potionBottleIds.map((id) => (\r\n            <LinkTreeItem\r\n              value={`potion-bottles/${id}`}\r\n              key={id}\r\n              label={id}\r\n              to={`/potion-bottles/${id}`}\r\n            />\r\n          ))}\r\n        </LinkTreeItem>\r\n      </LinkTreeItem>\r\n    </Tree>\r\n  );\r\n};\r\n\r\nexport default PackageContentTree;\r\n","import * as React from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\n\r\nimport { packageSave } from \"@/actions/packages/package-save\";\r\nimport { packageNew } from \"@/actions/packages/package-new\";\r\n\r\nimport { useAction } from \"@/hooks/use-action\";\r\n\r\nimport useLoadPackage from \"@/services/package/hooks/use-load-package\";\r\n\r\nimport Menu from \"@/components/Menus/Menu\";\r\nimport MenuItem from \"@/components/Menus/MenuItem\";\r\nimport { useMenuCloseContext } from \"@/components/Menus/MenuCloseContext\";\r\nimport AbstractFileLoadButton from \"@/components/AbstractFileLoadButton\";\r\n\r\nimport AutoPopper from \"./AutoPopper\";\r\nimport Button from \"./Button\";\r\n\r\nconst PackageMenuButton = () => {\r\n  const { t } = useTranslation();\r\n\r\n  return (\r\n    <AutoPopper content={<PackageMenu />} placement=\"bottom-start\">\r\n      <Button variant=\"menu\">{t(\"package.noun_titlecase\")}</Button>\r\n    </AutoPopper>\r\n  );\r\n};\r\n\r\nconst PackageMenu = () => {\r\n  const { t } = useTranslation();\r\n  const { loadStatus, onLoadPackage } = useLoadPackage();\r\n  const requestMenuClose = useMenuCloseContext();\r\n  const onNew = useAction(packageNew);\r\n  const onSave = useAction(packageSave);\r\n  return (\r\n    <Menu>\r\n      <MenuItem onClick={onNew}>{t(\"package.new\")}</MenuItem>\r\n      <AbstractFileLoadButton\r\n        accept=\".zip\"\r\n        onFileLoaded={onLoadPackage}\r\n        onInteractionComplete={requestMenuClose}\r\n      >\r\n        {({ onClick }) => (\r\n          <MenuItem\r\n            autoDismissMenu={false}\r\n            disabled={loadStatus == \"loading\"}\r\n            onClick={onClick}\r\n          >\r\n            {t(\"package.load\")}\r\n          </MenuItem>\r\n        )}\r\n      </AbstractFileLoadButton>\r\n      <MenuItem onClick={onSave}>{t(\"package.save\")}</MenuItem>\r\n    </Menu>\r\n  );\r\n};\r\n\r\nexport default PackageMenuButton;\r\n","import * as React from \"react\";\r\n\r\nimport DefaultTitlebarContent from \"../DefaultTitlebarContent\";\r\nimport Divider from \"../Divider\";\r\nimport PackageContentTree from \"../PackageContentTree\";\r\nimport TitleBar from \"../TitleBar\";\r\n\r\nimport styles from \"./Page.module.css\";\r\n\r\nexport interface PageProps {\r\n  titlebarContent?: React.ReactNode;\r\n  showContentTree?: boolean;\r\n}\r\n\r\nconst Page: React.FC<PageProps> = ({\r\n  titlebarContent,\r\n  showContentTree = true,\r\n  children,\r\n}) => {\r\n  return (\r\n    <div className={styles[\"page\"]}>\r\n      <TitleBar>\r\n        <DefaultTitlebarContent />\r\n        {titlebarContent}\r\n      </TitleBar>\r\n      <Divider />\r\n      <div className={styles[\"page-content\"]}>\r\n        {showContentTree && (\r\n          <>\r\n            <PackageContentTree className={styles[\"package-content\"]} />\r\n            <Divider orientation=\"vertical\" />\r\n          </>\r\n        )}\r\n        <div className={styles[\"page-children\"]}>{children}</div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Page;\r\n","import Page from \"./Page\";\r\nexport default Page;\r\n","import * as React from \"react\";\r\nimport { createPortal } from \"react-dom\";\r\n\r\nimport { Options, VirtualElement } from \"@popperjs/core\";\r\nimport { usePopper } from \"react-popper\";\r\n\r\nimport { useOutsideMouseEvent } from \"@/hooks/use-outside-mouse-event\";\r\nimport { useArrayState } from \"@/hooks/use-array-state\";\r\n\r\nimport {\r\n  PopperChildContextProvider,\r\n  usePopperChild,\r\n} from \"./PopperChildContext\";\r\n\r\nexport interface PopperProps {\r\n  anchorEl: Element | VirtualElement | null;\r\n  placement?: Options[\"placement\"];\r\n  isOpen: boolean;\r\n  onRequestClose?(): void;\r\n}\r\n\r\nconst noop = () => {\r\n  /*no op*/\r\n};\r\n\r\nconst Popper: React.FC<PopperProps> = ({\r\n  isOpen,\r\n  anchorEl,\r\n  placement = \"auto\",\r\n  onRequestClose = noop,\r\n  children,\r\n}) => {\r\n  const [popperRef, setPopperRef] = React.useState<HTMLDivElement | null>(null);\r\n  const { attributes, styles } = usePopper(\r\n    isOpen ? anchorEl : null,\r\n    popperRef,\r\n    {\r\n      placement,\r\n    }\r\n  );\r\n\r\n  // Register us as a child of a parent popper, if any is present.\r\n  usePopperChild(popperRef);\r\n\r\n  const [popperChildren, registerPopperChild, unregisterPopperChild] =\r\n    useArrayState<HTMLElement>();\r\n\r\n  // Close when a click happens on the outside.\r\n  // We still want to handle this even if we are a child, as the user\r\n  // may have clicked on a parent popper which should close us.\r\n  const insideRefs = React.useMemo(\r\n    () => [popperRef, ...popperChildren],\r\n    [popperChildren, popperRef]\r\n  );\r\n  useOutsideMouseEvent(insideRefs, onRequestClose);\r\n\r\n  if (!isOpen) {\r\n    return null;\r\n  }\r\n\r\n  return createPortal(\r\n    <PopperChildContextProvider\r\n      registerPopperChild={registerPopperChild}\r\n      unregisterPopperChild={unregisterPopperChild}\r\n    >\r\n      <div ref={setPopperRef} style={styles.popper} {...attributes.popper}>\r\n        {children}\r\n      </div>\r\n    </PopperChildContextProvider>,\r\n    document.body\r\n  );\r\n};\r\n\r\nexport default Popper;\r\n","import * as React from \"react\";\r\n\r\nexport interface PopperChildContext {\r\n  registerPopperChild(element: HTMLElement): void;\r\n  unregisterPopperChild(element: HTMLElement): void;\r\n}\r\n\r\nfunction noop() {\r\n  // no op.\r\n}\r\nconst noopPopperChildContext: PopperChildContext = {\r\n  registerPopperChild: noop,\r\n  unregisterPopperChild: noop,\r\n};\r\n\r\nexport const PopperChildContext =\r\n  React.createContext<PopperChildContext | null>(null);\r\n\r\nexport const usePopperChildContext = () => React.useContext(PopperChildContext);\r\n\r\nexport const PopperChildContextProvider: React.FC<PopperChildContext> = ({\r\n  registerPopperChild: contextRegister,\r\n  unregisterPopperChild: contextUnregister,\r\n  children,\r\n}) => {\r\n  const parent = usePopperChildContext();\r\n  const parentRegister = parent?.registerPopperChild;\r\n  const parentUnregister = parent?.unregisterPopperChild;\r\n\r\n  const registerPopperChild = React.useCallback(\r\n    (element: HTMLElement) => {\r\n      if (parentRegister) {\r\n        parentRegister(element);\r\n      }\r\n      contextRegister(element);\r\n    },\r\n    [contextRegister, parentRegister]\r\n  );\r\n\r\n  const unregisterPopperChild = React.useCallback(\r\n    (element: HTMLElement) => {\r\n      contextUnregister(element);\r\n      if (parentUnregister) {\r\n        parentUnregister;\r\n      }\r\n    },\r\n    [contextUnregister, parentUnregister]\r\n  );\r\n\r\n  const providedContext = React.useMemo(\r\n    () => ({\r\n      registerPopperChild,\r\n      unregisterPopperChild,\r\n    }),\r\n    [registerPopperChild, unregisterPopperChild]\r\n  );\r\n\r\n  return (\r\n    <PopperChildContext.Provider value={providedContext}>\r\n      {children}\r\n    </PopperChildContext.Provider>\r\n  );\r\n};\r\n\r\nexport function usePopperChild(element: HTMLElement | null) {\r\n  const popperContext =\r\n    React.useContext(PopperChildContext) ?? noopPopperChildContext;\r\n\r\n  // We do not want to trigger the effect when\r\n  //  the context changes, as the context will change\r\n  //  as a result of calling register and unregister.\r\n  // As a result, we will not function right if somehow our\r\n  //  element transfers to a different popup chain without re-rendering.\r\n  const ctxRef = React.useRef(popperContext);\r\n  React.useEffect(() => {\r\n    ctxRef.current = popperContext;\r\n  });\r\n\r\n  React.useEffect(() => {\r\n    if (element) {\r\n      ctxRef.current.registerPopperChild(element);\r\n      return () => ctxRef.current.unregisterPopperChild(element);\r\n    }\r\n  }, [element]);\r\n}\r\n","export * from \"./Popper\";\r\nimport Popper from \"./Popper\";\r\nexport default Popper;\r\n","import * as React from \"react\";\r\nimport classNames from \"classnames\";\r\n\r\nimport TextAreaAutosize from \"react-textarea-autosize\";\r\n\r\nimport styles from \"./TextArea.module.css\";\r\n\r\n// TextAreaAutosize does something weird with the style props.\r\nexport type TextAreaProps = Omit<\r\n  React.TextareaHTMLAttributes<HTMLTextAreaElement>,\r\n  \"style\"\r\n> & {\r\n  minRows?: number;\r\n  maxRows?: number;\r\n};\r\n\r\nconst TextArea = (props: TextAreaProps) => (\r\n  <div className={classNames(styles[\"textarea\"], props.className)}>\r\n    <span className={styles[\"textarea-edge-left\"]} />\r\n    <span className={styles[\"textarea-edge-right\"]} />\r\n    <div className={styles[\"textarea-wrapper\"]}>\r\n      <TextAreaAutosize {...props} className={styles[\"textarea-input\"]} />\r\n    </div>\r\n  </div>\r\n);\r\n\r\nexport default TextArea;\r\n","import TextArea from \"./TextArea\";\r\nexport * from \"./TextArea\";\r\nexport default TextArea;\r\n","import * as React from \"react\";\r\nimport classNames from \"classnames\";\r\n\r\nimport styles from \"./TextBox.module.css\";\r\n\r\nexport type TextBoxProps = Omit<\r\n  React.InputHTMLAttributes<HTMLInputElement>,\r\n  \"type\"\r\n>;\r\n\r\nconst TextBox = (props: TextBoxProps) => (\r\n  <input\r\n    {...props}\r\n    className={classNames(styles[\"textbox-input\"], props.className)}\r\n    type=\"text\"\r\n  />\r\n);\r\n\r\nexport default TextBox;\r\n","import TextBox from \"./TextBox\";\r\nexport * from \"./TextBox\";\r\nexport default TextBox;\r\n","import * as React from \"react\";\r\nimport classNames from \"classnames\";\r\n\r\nimport styles from \"./TitleBar.module.css\";\r\n\r\nexport interface TitleBarProps {\r\n  className?: string;\r\n  title?: string;\r\n}\r\nconst TitleBar: React.FC<TitleBarProps> = ({ className, title, children }) => {\r\n  return (\r\n    <div className={classNames(styles.titlebar, className)}>\r\n      <span className={styles[\"titlebar-heading\"]}>Crucible</span>\r\n      <div className={styles[\"titlebar-divider\"]} />\r\n      {title && <div className={styles[\"titlebar-title\"]}>{title}</div>}\r\n      {children}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TitleBar;\r\n","import TitleBar from \"./TitleBar\";\r\nexport default TitleBar;\r\n","import * as React from \"react\";\r\nimport { createPortal } from \"react-dom\";\r\nimport classNames from \"classnames\";\r\n\r\nimport { Options, VirtualElement } from \"@popperjs/core\";\r\nimport { usePopper } from \"react-popper\";\r\n\r\nexport interface PopperProps {\r\n  className?: string;\r\n  anchorEl: Element | VirtualElement | null;\r\n  placement?: Options[\"placement\"];\r\n  isOpen: boolean;\r\n}\r\n\r\nimport styles from \"./Tooltip.module.css\";\r\n\r\nconst Tooltip: React.FC<PopperProps> = ({\r\n  className,\r\n  isOpen,\r\n  anchorEl,\r\n  placement = \"auto\",\r\n  children,\r\n}) => {\r\n  const [popperRef, setPopperRef] = React.useState<HTMLDivElement | null>(null);\r\n  const [arrowRef, setArrowRef] = React.useState<HTMLDivElement | null>(null);\r\n\r\n  const { attributes, styles: popperStyles } = usePopper(\r\n    isOpen ? anchorEl : null,\r\n    popperRef,\r\n    {\r\n      placement,\r\n      modifiers: [\r\n        {\r\n          name: \"arrow\",\r\n          options: {\r\n            element: arrowRef,\r\n          },\r\n        },\r\n        {\r\n          name: \"offset\",\r\n          options: {\r\n            offset: [0, 8],\r\n          },\r\n        },\r\n      ],\r\n    }\r\n  );\r\n\r\n  if (!isOpen) {\r\n    return null;\r\n  }\r\n\r\n  return createPortal(\r\n    <div\r\n      ref={setPopperRef}\r\n      className={classNames(styles[\"tooltip\"], className)}\r\n      style={popperStyles.popper}\r\n      role=\"tooltip\"\r\n      {...attributes.popper}\r\n    >\r\n      {children}\r\n      <div\r\n        ref={setArrowRef}\r\n        data-popper-arrow\r\n        className={styles[\"tooltip-arrow\"]}\r\n        style={popperStyles.arrow}\r\n        {...attributes.arrow}\r\n      />\r\n    </div>,\r\n    document.body\r\n  );\r\n};\r\n\r\nexport default Tooltip;\r\n","import * as React from \"react\";\r\nimport { useLocation } from \"react-router\";\r\n\r\nimport { useLinkClicked } from \"@/link-utils\";\r\n\r\nimport TreeItem, { TreeItemProps } from \"./TreeItem\";\r\n\r\nexport interface LinkTreeItemProps extends TreeItemProps {\r\n  to: string;\r\n}\r\n\r\nconst LinkTreeItem: React.FC<LinkTreeItemProps> = ({\r\n  value,\r\n  to,\r\n  label,\r\n  children,\r\n}) => {\r\n  const { pathname } = useLocation();\r\n  const onClick = useLinkClicked(to);\r\n  return (\r\n    <TreeItem\r\n      value={value}\r\n      label={label}\r\n      selected={pathname == to}\r\n      onClick={onClick}\r\n    >\r\n      {children}\r\n    </TreeItem>\r\n  );\r\n};\r\n\r\nexport default LinkTreeItem;\r\n","import * as React from \"react\";\r\nimport classNames from \"classnames\";\r\n\r\nimport { TreeChildContext } from \"./TreeChildContext\";\r\n\r\nimport styles from \"./Tree.module.css\";\r\n\r\nexport interface TreeProps {\r\n  expandedValues: string[];\r\n  onExpandedValuesChanged(expandedValues: string[]): void;\r\n  className?: string;\r\n  id?: string;\r\n}\r\n\r\nconst Tree: React.FC<TreeProps> = ({\r\n  className,\r\n  id,\r\n  expandedValues,\r\n  onExpandedValuesChanged,\r\n  children,\r\n}) => {\r\n  const context = React.useMemo(\r\n    () => ({\r\n      expandedValues,\r\n      setExpandedValues: onExpandedValuesChanged,\r\n    }),\r\n    [expandedValues, onExpandedValuesChanged]\r\n  );\r\n\r\n  return (\r\n    <TreeChildContext.Provider value={context}>\r\n      <ul id={id} className={classNames(\"tree\", styles[\"tree\"], className)}>\r\n        {children}\r\n      </ul>\r\n    </TreeChildContext.Provider>\r\n  );\r\n};\r\n\r\nexport default Tree;\r\n","import * as React from \"react\";\r\n\r\nimport { emptyFrozenArray } from \"@/arrays\";\r\n\r\nexport interface TreeChildContext {\r\n  expandedValues: string[];\r\n  setExpandedValues(values: string[]): void;\r\n}\r\n\r\nfunction noop() {}\r\n\r\nexport const TreeChildContext = React.createContext<TreeChildContext>({\r\n  expandedValues: emptyFrozenArray<string>(),\r\n  setExpandedValues: noop,\r\n});\r\n\r\nexport function useTreeChildContext() {\r\n  return React.useContext(TreeChildContext);\r\n}\r\n","import * as React from \"react\";\r\nimport classNames from \"classnames\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport {\r\n  faChevronRight,\r\n  faChevronDown,\r\n} from \"@fortawesome/free-solid-svg-icons\";\r\n\r\nimport Tree from \"./Tree\";\r\n\r\nimport styles from \"./Tree.module.css\";\r\nimport { useTreeChildContext } from \"./TreeChildContext\";\r\n\r\nexport interface TreeItemProps {\r\n  id?: string;\r\n  className?: string;\r\n  value: string;\r\n  label: React.ReactNode;\r\n  selected?: boolean;\r\n  onClick?: (e: React.MouseEvent<HTMLElement>) => void;\r\n}\r\n\r\nconst TreeItem: React.FC<TreeItemProps> = ({\r\n  id,\r\n  label,\r\n  value,\r\n  selected,\r\n  onClick,\r\n  children,\r\n}) => {\r\n  const { expandedValues, setExpandedValues } = useTreeChildContext();\r\n\r\n  const isExpanded = expandedValues.indexOf(value) !== -1;\r\n\r\n  const onChevronClick = React.useCallback(\r\n    (e: React.MouseEvent<SVGSVGElement>) => {\r\n      if (e.defaultPrevented) {\r\n        return;\r\n      }\r\n      const isExpanded = expandedValues.indexOf(value) !== -1;\r\n      e.preventDefault();\r\n      if (isExpanded) {\r\n        setExpandedValues(expandedValues.filter((v) => v !== value));\r\n      } else {\r\n        setExpandedValues([...expandedValues, value]);\r\n      }\r\n    },\r\n    [expandedValues, setExpandedValues, value]\r\n  );\r\n\r\n  const onLabelClick = React.useCallback(\r\n    (e: React.MouseEvent<HTMLElement>) => {\r\n      const isExpanded = expandedValues.indexOf(value) !== -1;\r\n      if (!isExpanded) {\r\n        setExpandedValues([...expandedValues, value]);\r\n      }\r\n      if (onClick) {\r\n        onClick(e);\r\n      }\r\n    },\r\n    [onClick, expandedValues, value]\r\n  );\r\n  return (\r\n    <li id={id} className={classNames(\"tree-item\", styles[\"tree-item\"])}>\r\n      <div\r\n        className={classNames(\r\n          styles[\"tree-item-content\"],\r\n          selected && styles[\"tree-item-content--selected\"]\r\n        )}\r\n      >\r\n        {children ? (\r\n          <FontAwesomeIcon\r\n            className={styles[\"tree-item-chevron\"]}\r\n            fixedWidth\r\n            color=\"inherit\"\r\n            icon={isExpanded ? faChevronDown : faChevronRight}\r\n            onClick={onChevronClick}\r\n          />\r\n        ) : (\r\n          <div className={styles[\"tree-item-nochevron\"]} />\r\n        )}\r\n        <div className={styles[\"tree-item-label\"]} onClick={onLabelClick}>\r\n          {label}\r\n        </div>\r\n      </div>\r\n      {isExpanded && children && (\r\n        <Tree\r\n          expandedValues={expandedValues}\r\n          onExpandedValuesChanged={setExpandedValues}\r\n          className={styles[\"tree-item-children\"]}\r\n        >\r\n          {children}\r\n        </Tree>\r\n      )}\r\n    </li>\r\n  );\r\n};\r\n\r\nexport default TreeItem;\r\n","import { MapEntityPrototype } from \"@/map-config\";\r\n\r\nexport const DRAGOBJECT_NEW_ENTITY = \"entity-new\" as const;\r\nexport const newEntityDragObject = (prototype: MapEntityPrototype) => ({\r\n  type: DRAGOBJECT_NEW_ENTITY,\r\n  payload: { prototype },\r\n});\r\nexport type NewEntityDragObject = ReturnType<typeof newEntityDragObject>;\r\nexport function isNewEntityDragObject(item: any): item is NewEntityDragObject {\r\n  return item.type === DRAGOBJECT_NEW_ENTITY;\r\n}\r\n","export const POTION_RADIUS = 0.79;\r\n\r\nexport const VORTEX_MEDIUM = 1.25;\r\nexport const VORTEX_LARGE = 1.65;\r\n","import { DangerZonePartMapEntity } from \"@/map-config\";\r\n\r\nimport { EntityDef } from \"../../types\";\r\n\r\nfunction makeImg(src: string): HTMLImageElement {\r\n  const img = new Image();\r\n  img.onerror = console.error.bind(console);\r\n  img.src = src;\r\n  return img;\r\n}\r\n\r\nconst DangerZoneImages: Record<string, HTMLImageElement> = {\r\n  Bone1: makeImg(require(\"./Bone1.png\")),\r\n  Bone2: makeImg(require(\"./Bone2.png\")),\r\n  Fang1: makeImg(require(\"./Fang1.png\")),\r\n  Fang2: makeImg(require(\"./Fang2.png\")),\r\n  Skull1: makeImg(require(\"./Skull1.png\")),\r\n};\r\n\r\n// TODO: Use bones as mask\r\n/*\r\n    // ctx.save();\r\n    // ctx.scale(1, -1);\r\n    // const maskW = mask.width / 95;\r\n    // const maskH = mask.height / 95;\r\n    // ctx.translate(-maskW / 2, -maskH / 2);\r\n    // ctx.drawImage(mask, 0, 0, maskW, maskH);\r\n    // ctx.restore();\r\n\r\n    ctx.fillStyle = \"red\";\r\n    tweakStyles(ctx);\r\n\r\n    // ctx.save();\r\n    // ctx.beginPath();\r\n    // // Clip a bit outside the potion radius to get the bottle opening\r\n    // ctx.arc(0, 0, POTION_RADIUS + 0.01, 0, 2 * Math.PI);\r\n    // ctx.rect(-0.28, POTION_RADIUS - 0.01, 0.56, 0.28);\r\n    // ctx.clip();\r\n\r\n    // const oldComposite = ctx.globalCompositeOperation;\r\n    // ctx.globalCompositeOperation = \"source-in\";\r\n    // // Flood a section bigger than our expected draw to paint the whole mask\r\n    // ctx.fillRect(\r\n    //   -POTION_RADIUS * 3,\r\n    //   -POTION_RADIUS * 3,\r\n    //   POTION_RADIUS * 6,\r\n    //   POTION_RADIUS * 6\r\n    // );\r\n    // ctx.globalCompositeOperation = oldComposite;\r\n    // ctx.restore();\r\n*/\r\n\r\nconst DangerZonePartDef: EntityDef<DangerZonePartMapEntity> = {\r\n  hitRadius: 0.2,\r\n  render(\r\n    ctx: CanvasRenderingContext2D,\r\n    entity: DangerZonePartMapEntity,\r\n    tweakStyles: (ctx: CanvasRenderingContext2D) => void\r\n  ) {\r\n    ctx.save();\r\n    ctx.beginPath();\r\n\r\n    ctx.fillStyle = \"gray\";\r\n\r\n    tweakStyles(ctx);\r\n\r\n    ctx.rotate(degreesToRadians(entity.angle));\r\n\r\n    switch (entity.prefab) {\r\n      case \"Fang1\":\r\n        // 0.1226418, 0.400135\r\n        ctx.fillRect(-0.06, -0.02, 0.12, 0.4);\r\n        break;\r\n      case \"Fang2\":\r\n        // 0.1371522, 0.2445218\r\n        ctx.fillRect(-0.065, -0.12, 0.13, 0.24);\r\n        break;\r\n      case \"Bone1\":\r\n        // 0.1287996, 0.6983229\r\n        ctx.fillRect(-0.06, -0.345, 0.12, 0.69);\r\n        break;\r\n      case \"Bone2\":\r\n        // 0.1529365, 0.7249526\r\n        ctx.fillRect(-0.07, -0.36, 0.14, 0.72);\r\n        break;\r\n      case \"Skull1\":\r\n      default:\r\n        ctx.arc(0, 0, 0.24, 0, 2 * Math.PI);\r\n        break;\r\n    }\r\n    ctx.fill();\r\n\r\n    const img = DangerZoneImages[entity.prefab];\r\n    if (img) {\r\n      const w = img.width / 130;\r\n      const h = img.height / 130;\r\n      ctx.scale(1, -1);\r\n      ctx.translate(-w / 2, -h / 2);\r\n      ctx.drawImage(img, 0, 0, w, h);\r\n    }\r\n    ctx.restore();\r\n  },\r\n};\r\nexport default DangerZonePartDef;\r\n\r\nfunction degreesToRadians(degress: number): number {\r\n  return (degress * Math.PI) / 180;\r\n}\r\n","import DangerZonePartDef from \"./DangerZonePart\";\r\nexport default DangerZonePartDef;\r\n","import { ExperienceBonusMapEntity } from \"@/map-config\";\r\n\r\nimport { EntityDef } from \"../types\";\r\n\r\nconst ExperienceBonusDef: EntityDef<ExperienceBonusMapEntity> = {\r\n  hitRadius: 0.3,\r\n  render(\r\n    ctx: CanvasRenderingContext2D,\r\n    entity: ExperienceBonusMapEntity,\r\n    tweakStyles: (ctx: CanvasRenderingContext2D) => void\r\n  ) {\r\n    ctx.beginPath();\r\n    ctx.fillStyle = \"green\";\r\n    tweakStyles(ctx);\r\n    ctx.arc(0, 0, 0.3, 0, 2 * Math.PI);\r\n    ctx.fill();\r\n  },\r\n};\r\nexport default ExperienceBonusDef;\r\n","import { PotionEffectMapEntity } from \"@/map-config\";\r\nimport { RenderResources } from \"@/services/map-editor/entities/types\";\r\n\r\nimport { POTION_RADIUS } from \"../consts\";\r\nimport { EntityDef } from \"../types\";\r\n\r\ninterface ResourceCacheItem {\r\n  image: HTMLImageElement;\r\n  data: string;\r\n}\r\nconst resourceCache: Record<string, ResourceCacheItem> = {};\r\nfunction resourceToImage(\r\n  resourceId: string,\r\n  content: string\r\n): HTMLImageElement {\r\n  if (resourceCache[resourceId] && resourceCache[resourceId].data === content) {\r\n    return resourceCache[resourceId].image;\r\n  }\r\n\r\n  const img = new Image();\r\n  img.onerror = console.error.bind(console);\r\n  img.src = content;\r\n  resourceCache[resourceId] = {\r\n    image: img,\r\n    data: content,\r\n  };\r\n  return img;\r\n}\r\n\r\nfunction tryGetResourceImage(\r\n  effectId: string,\r\n  renderResources: RenderResources\r\n): HTMLImageElement | null {\r\n  const key = `potionEffect::${effectId}`;\r\n  if (!renderResources[key]) {\r\n    return null;\r\n  }\r\n  return resourceToImage(key, renderResources[key]);\r\n}\r\n\r\nconst PotionEffectDef: EntityDef<PotionEffectMapEntity> = {\r\n  hitRadius: POTION_RADIUS,\r\n  render(\r\n    ctx: CanvasRenderingContext2D,\r\n    entity: PotionEffectMapEntity,\r\n    tweakStyles: (ctx: CanvasRenderingContext2D) => void,\r\n    renderResources: RenderResources\r\n  ) {\r\n    ctx.save();\r\n\r\n    ctx.fillStyle = \"red\";\r\n    tweakStyles(ctx);\r\n\r\n    ctx.beginPath();\r\n    ctx.arc(0, 0, POTION_RADIUS, 0, 2 * Math.PI);\r\n    ctx.rect(-0.2, POTION_RADIUS - 0.04, 0.4, 0.24);\r\n    ctx.fill();\r\n\r\n    const img = tryGetResourceImage(entity.effect, renderResources);\r\n    if (img) {\r\n      const w = img.width / 30;\r\n      const h = img.height / 30;\r\n      ctx.scale(1, -1);\r\n      ctx.translate(-w / 2, -h / 2);\r\n      ctx.drawImage(img, 0, 0, w, h);\r\n    }\r\n\r\n    ctx.restore();\r\n  },\r\n};\r\nexport default PotionEffectDef;\r\n","import { VortexMapEntity } from \"@/map-config\";\r\nimport { VORTEX_LARGE, VORTEX_MEDIUM } from \"../consts\";\r\n\r\nimport { EntityDef } from \"../types\";\r\n\r\nconst VortexDef: EntityDef<VortexMapEntity> = {\r\n  hitRadius: VORTEX_LARGE,\r\n  render(\r\n    ctx: CanvasRenderingContext2D,\r\n    entity: VortexMapEntity,\r\n    tweakStyles: (ctx: CanvasRenderingContext2D) => void\r\n  ) {\r\n    ctx.beginPath();\r\n    ctx.fillStyle = \"gray\";\r\n    tweakStyles(ctx);\r\n    const size = entity.prefab == \"Medium\" ? VORTEX_MEDIUM : VORTEX_LARGE;\r\n    ctx.arc(0, 0, size, 0, 2 * Math.PI);\r\n    ctx.fill();\r\n  },\r\n};\r\nexport default VortexDef;\r\n","import { MapEntity } from \"@/map-config\";\r\n\r\nimport { EntityDef } from \"../types\";\r\n\r\nimport DangerZonePartDef from \"./DangerZonePart\";\r\nimport ExperienceBonusDef from \"./ExperienceBonus\";\r\nimport PotionEffectDef from \"./PotionEffect\";\r\nimport VortexDef from \"./Vortex\";\r\n\r\nexport const EntityDefsByType: Record<MapEntity[\"entityType\"], EntityDef> = {\r\n  DangerZonePart: DangerZonePartDef,\r\n  ExperienceBonus: ExperienceBonusDef,\r\n  PotionEffect: PotionEffectDef,\r\n  Vortex: VortexDef,\r\n};\r\n","import values from \"lodash/values\";\r\n\r\nexport * from \"./types\";\r\nexport * from \"./defs\";\r\n\r\nimport { EntityDefsByType } from \"./defs\";\r\nexport const LargestEntityRadius = values(EntityDefsByType).reduce(\r\n  (x, def) => Math.max(x, def.hitRadius),\r\n  0\r\n);\r\n","import {\r\n  calcSize,\r\n  normalizeRectangle,\r\n  Point,\r\n  pointIntersectsRect,\r\n  Rectangle,\r\n} from \"@/geometry\";\r\nimport { MapEntity } from \"@/map-config\";\r\n\r\ninterface TileData {\r\n  padding: { x: number; y: number };\r\n  entities: MapEntity[];\r\n}\r\n\r\nconst TileDataByType: Record<string, TileData> = {\r\n  \"danger-zone\": require(\"./danger-zone.json\"),\r\n};\r\n\r\nexport function generateTileEntities(\r\n  tileType: string,\r\n  rect: Rectangle\r\n): MapEntity[] {\r\n  const data = TileDataByType[tileType];\r\n  if (!data) {\r\n    return [];\r\n  }\r\n  return tileEntities(data, rect);\r\n}\r\n\r\nfunction tileEntities(tileData: TileData, rect: Rectangle): MapEntity[] {\r\n  rect = normalizeRectangle(rect);\r\n  const { entities: tileEntities, padding: tilePadding } = tileData;\r\n  const tileBounds: Rectangle = {\r\n    p1: {\r\n      x: tileEntities.reduce((x, e) => Math.min(x, e.x), 0) - tilePadding.x / 2,\r\n      y: tileEntities.reduce((y, e) => Math.min(y, e.y), 0) - tilePadding.y / 2,\r\n    },\r\n    p2: {\r\n      x: tileEntities.reduce((x, e) => Math.max(x, e.x), 0) + tilePadding.x / 2,\r\n      y: tileEntities.reduce((y, e) => Math.max(y, e.y), 0) + tilePadding.y / 2,\r\n    },\r\n  };\r\n\r\n  const tileSize = calcSize(tileBounds);\r\n\r\n  const entities: MapEntity[] = [];\r\n\r\n  for (\r\n    let tileXOrdinal = Math.floor(rect.p1.x / tileSize.width);\r\n    tileXOrdinal <= Math.ceil(rect.p2.x / tileSize.width);\r\n    tileXOrdinal++\r\n  ) {\r\n    for (\r\n      let tileYOrdinal = Math.floor(rect.p1.y / tileSize.height);\r\n      tileYOrdinal <= Math.ceil(rect.p2.y / tileSize.height);\r\n      tileYOrdinal++\r\n    ) {\r\n      for (let i = 0; i < tileEntities.length; i++) {\r\n        const tileEntity = tileEntities[i];\r\n        const p: Point = {\r\n          x: tileEntity.x + tileSize.width * tileXOrdinal,\r\n          y: tileEntity.y + tileSize.height * tileYOrdinal,\r\n        };\r\n        if (!pointIntersectsRect(p, rect)) {\r\n          continue;\r\n        }\r\n        entities.push({\r\n          ...tileEntity,\r\n          ...p,\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  return entities;\r\n}\r\n","export type ValueSetter<T> = T | ((old: T) => T);\r\n\r\nexport function fpSet<\r\n  Target extends Record<string, any> | any[],\r\n  P1 extends keyof Target,\r\n  T extends Target[P1]\r\n>(target: Target, p1: P1, value: ValueSetter<T>): Target;\r\nexport function fpSet<\r\n  Target extends Record<string, any> | any[],\r\n  P1 extends keyof Target,\r\n  P2 extends keyof Target[P1],\r\n  T extends Target[P1][P2]\r\n>(target: Target, p1: P1, p2: P2, value: ValueSetter<T>): Target;\r\nexport function fpSet<\r\n  Target extends Record<string, any> | any[],\r\n  P1 extends keyof Target,\r\n  P2 extends keyof Target[P1],\r\n  P3 extends keyof Target[P1][P2],\r\n  T extends Target[P1][P2][P3]\r\n>(target: Target, p1: P1, p2: P2, p3: P3, value: ValueSetter<T>): Target;\r\nexport function fpSet<\r\n  Target extends Record<string, any> | any[],\r\n  P1 extends keyof Target,\r\n  P2 extends keyof Target[P1],\r\n  P3 extends keyof Target[P1][P2],\r\n  P4 extends keyof Target[P1][P2][P3],\r\n  T extends Target[P1][P2][P3][P4]\r\n>(\r\n  target: Target,\r\n  p1: P1,\r\n  p2: P2,\r\n  p3: P3,\r\n  p4: P4,\r\n  value: ValueSetter<T>\r\n): Target;\r\nexport function fpSet(...args: any[]): any {\r\n  const target = args[0];\r\n  const path = args.slice(1, args.length - 1).map(String);\r\n  const value = args[args.length - 1];\r\n  return fpSetByArray(target, path, value);\r\n}\r\n\r\nexport function fpSetByArray<T extends Record<string, any>>(\r\n  target: T,\r\n  path: (string | number)[],\r\n  value: ValueSetter<any>\r\n): T {\r\n  if (path.length === 0) {\r\n    if (typeof value === \"function\") {\r\n      return value(target);\r\n    }\r\n    return value;\r\n  }\r\n\r\n  const firstPaths = path.slice(0, path.length - 1).map(String);\r\n  const lastPath = path[path.length - 1];\r\n\r\n  const newData = clone(target);\r\n\r\n  let rollingTarget: any = newData;\r\n\r\n  for (const seg of firstPaths) {\r\n    rollingTarget[seg] = clone(rollingTarget[seg]);\r\n    rollingTarget = rollingTarget[seg];\r\n  }\r\n\r\n  if (typeof value === \"function\") {\r\n    rollingTarget[lastPath] = value(rollingTarget[lastPath]);\r\n  } else {\r\n    rollingTarget[lastPath] = value;\r\n  }\r\n\r\n  return newData;\r\n}\r\n\r\nfunction clone<T extends Record<string, unknown> | any[]>(obj: T): T {\r\n  if (Array.isArray(obj)) {\r\n    return obj.slice() as T;\r\n  }\r\n  return Object.assign({}, obj);\r\n}\r\n","export interface Point {\r\n  x: number;\r\n  y: number;\r\n}\r\nexport const ZeroPoint = Object.freeze({ x: 0, y: 0 });\r\n\r\nexport interface Size {\r\n  width: number;\r\n  height: number;\r\n}\r\n\r\nexport interface Rectangle {\r\n  p1: Point;\r\n  p2: Point;\r\n}\r\n\r\nexport const ZeroRect = Object.freeze({ p1: ZeroPoint, p2: ZeroPoint });\r\n\r\nexport function pointAdd(p1: Point, p2: Point): Point {\r\n  return {\r\n    x: p1.x + p2.x,\r\n    y: p1.y + p2.y,\r\n  };\r\n}\r\n\r\nexport function pointSubtract(p1: Point, p2: Point): Point {\r\n  return {\r\n    x: p1.x - p2.x,\r\n    y: p1.y - p2.y,\r\n  };\r\n}\r\n\r\nexport function magnitude(v: Point): number {\r\n  return Math.sqrt(v.x * v.x + v.y * v.y);\r\n}\r\n\r\nexport function normalizeRectangle(p1: Point, p2: Point): Rectangle;\r\nexport function normalizeRectangle(r: Rectangle): Rectangle;\r\nexport function normalizeRectangle(...args: any[]): Rectangle {\r\n  let p1: Point;\r\n  let p2: Point;\r\n  if (args.length === 1) {\r\n    const r = args[0] as Rectangle;\r\n    p1 = r.p1;\r\n    p2 = r.p2;\r\n  } else {\r\n    p1 = args[0] as Point;\r\n    p2 = args[1] as Point;\r\n  }\r\n  return {\r\n    p1: {\r\n      x: Math.min(p1.x, p2.x),\r\n      y: Math.min(p1.y, p2.y),\r\n    },\r\n    p2: {\r\n      x: Math.max(p1.x, p2.x),\r\n      y: Math.max(p1.y, p2.y),\r\n    },\r\n  };\r\n}\r\n\r\nexport function addPointToRect(r: Rectangle, p: Point): Rectangle {\r\n  return {\r\n    p1: {\r\n      x: Math.min(r.p1.x, p.x),\r\n      y: Math.min(r.p1.y, p.y),\r\n    },\r\n    p2: {\r\n      x: Math.max(r.p2.x, p.x),\r\n      y: Math.max(r.p2.y, p.y),\r\n    },\r\n  };\r\n}\r\n\r\nexport function pointIntersectsRect(p: Point, r: Rectangle): boolean {\r\n  r = normalizeRectangle(r);\r\n\r\n  if (r.p1.x > p.x || r.p2.x < p.x) {\r\n    return false;\r\n  }\r\n\r\n  if (r.p1.y > p.y || r.p2.y < p.y) {\r\n    return false;\r\n  }\r\n\r\n  return true;\r\n}\r\n\r\nexport function calcSize(r: Rectangle): Size {\r\n  r = normalizeRectangle(r);\r\n  return {\r\n    width: r.p2.x - r.p1.x,\r\n    height: r.p2.y - r.p1.y,\r\n  };\r\n}\r\n","import { createHashHistory } from \"history\";\r\n\r\nconst history = createHashHistory();\r\nexport default history;\r\n","import * as React from \"react\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { AnyAction } from \"redux\";\r\n\r\nexport function useAction(actionCreator: () => AnyAction): () => AnyAction;\r\nexport function useAction<Args>(\r\n  actionCreator: (...args: Args[]) => AnyAction\r\n): () => AnyAction;\r\nexport function useAction<A0, Args>(\r\n  actionCreator: (a0: A0, ...args: Args[]) => AnyAction,\r\n  a0: A0\r\n): () => AnyAction;\r\nexport function useAction(\r\n  actionCreator: (...args: any[]) => AnyAction,\r\n  ...preBind: any[]\r\n): () => AnyAction {\r\n  const dispatch = useDispatch();\r\n  return React.useCallback(() => {\r\n    const action = actionCreator(...preBind);\r\n    if (action) {\r\n      dispatch(action);\r\n    }\r\n  }, [dispatch, actionCreator, ...preBind]) as any;\r\n}\r\n\r\nexport function useClickAction(\r\n  actionCreator: (...args: any[]) => AnyAction,\r\n  ...preBind: any[]\r\n): (e: React.MouseEvent) => AnyAction {\r\n  const dispatch = useDispatch();\r\n  return React.useCallback(\r\n    (e: React.MouseEvent) => {\r\n      if (e.defaultPrevented) {\r\n        return;\r\n      }\r\n      e.preventDefault();\r\n      const action = actionCreator(...preBind);\r\n      if (action) {\r\n        dispatch(action);\r\n      }\r\n    },\r\n    [dispatch, actionCreator, ...preBind]\r\n  ) as any;\r\n}\r\n","import * as React from \"react\";\r\nimport difference from \"lodash/difference\";\r\n\r\nexport type UseArrayState<T> = [\r\n  items: T[],\r\n  addItem: (value: T) => void,\r\n  removeItem: (value: T) => void,\r\n  setItems: (items: T[]) => void\r\n];\r\n\r\nexport function useArrayState<T>(defaultValue: T[] = []): UseArrayState<T> {\r\n  const [items, setItems] = React.useState(defaultValue);\r\n  const addItem = React.useCallback(\r\n    (item: T) => {\r\n      setItems([...items, item]);\r\n    },\r\n    [items]\r\n  );\r\n  const removeItem = React.useCallback(\r\n    (item: T) => {\r\n      setItems(difference(items, [item]));\r\n    },\r\n    [items]\r\n  );\r\n\r\n  return [items, addItem, removeItem, setItems];\r\n}\r\n","import * as React from \"react\";\r\n\r\nexport function useBooleanSetState(\r\n  defaultState: boolean = false\r\n): [boolean, () => void, () => void] {\r\n  const [state, setState] = React.useState(defaultState);\r\n\r\n  const setTrue = React.useCallback(() => setState(true), []);\r\n  const setFalse = React.useCallback(() => setState(false), []);\r\n\r\n  return [state, setTrue, setFalse];\r\n}\r\n","import * as React from \"react\";\r\n\r\ninterface UseComponentBounds {\r\n  left: number;\r\n  top: number;\r\n  right: number;\r\n  bottom: number;\r\n  width: number;\r\n  height: number;\r\n}\r\nexport function useComponentBounds(ref: React.RefObject<HTMLElement | null>) {\r\n  const [size, setSize] = React.useState<UseComponentBounds>({\r\n    left: 0,\r\n    top: 0,\r\n    right: 0,\r\n    bottom: 0,\r\n    width: 0,\r\n    height: 0,\r\n  });\r\n\r\n  React.useLayoutEffect(() => {\r\n    if (!ref.current) {\r\n      return;\r\n    }\r\n\r\n    const observer = new ResizeObserver(() => {\r\n      const el = ref.current;\r\n      if (!el) {\r\n        return;\r\n      }\r\n      const b = el.getBoundingClientRect();\r\n      setSize({\r\n        top: b.top,\r\n        left: b.left,\r\n        right: b.right,\r\n        bottom: b.bottom,\r\n        width: b.width,\r\n        height: b.height,\r\n      });\r\n    });\r\n\r\n    observer.observe(ref.current);\r\n\r\n    return () => {\r\n      observer.disconnect();\r\n    };\r\n  }, [ref]);\r\n\r\n  return size;\r\n}\r\n","import * as React from \"react\";\r\n\r\nexport function useNativeEvent<\r\n  T extends GlobalEventHandlers,\r\n  K extends keyof GlobalEventHandlersEventMap\r\n>(\r\n  ref: React.RefObject<T | null>,\r\n  type: K,\r\n  listener: (\r\n    this: GlobalEventHandlers,\r\n    ev: GlobalEventHandlersEventMap[K]\r\n  ) => any,\r\n  options?: boolean | AddEventListenerOptions\r\n) {\r\n  React.useEffect(() => {\r\n    if (!ref.current) {\r\n      return;\r\n    }\r\n\r\n    // De-reference the target so we remove from the right element.\r\n    const listenTarget = ref.current;\r\n\r\n    listenTarget.addEventListener(type, listener, options);\r\n    return () => {\r\n      listenTarget.removeEventListener(type, listener, options);\r\n    };\r\n  }, [type, listener, ref, options]);\r\n}\r\n","import * as React from \"react\";\r\n\r\nimport { asArray, MaybeArray } from \"@/arrays\";\r\n\r\nexport function useOutsideMouseEvent(\r\n  element: MaybeArray<HTMLElement | null>,\r\n  onOutsideEvent: () => void,\r\n  when = true\r\n) {\r\n  const onEvent = React.useCallback(\r\n    (e: MouseEvent | TouchEvent) => {\r\n      const elements = asArray(element).filter(isTruthy);\r\n      if (!elements.length) {\r\n        return;\r\n      }\r\n\r\n      if (elements.every((element) => !element.contains(e.target as any))) {\r\n        onOutsideEvent();\r\n      }\r\n    },\r\n    [element, onOutsideEvent]\r\n  );\r\n\r\n  React.useEffect(() => {\r\n    if (!when) {\r\n      return;\r\n    }\r\n\r\n    document.addEventListener(\"mousedown\", onEvent);\r\n    document.addEventListener(\"touchstart\", onEvent);\r\n\r\n    return () => {\r\n      document.removeEventListener(\"mousedown\", onEvent);\r\n      document.removeEventListener(\"touchstart\", onEvent);\r\n    };\r\n  }, [onEvent, when]);\r\n}\r\n\r\nfunction isTruthy<T>(x: T | null | undefined): x is T {\r\n  return Boolean(x);\r\n}\r\n","import { AppState } from \"@/state\";\r\nimport { useSelector as realUseSelector } from \"react-redux\";\r\n\r\nexport function useSelector<T>(selector: (state: AppState) => T) {\r\n  return realUseSelector((state) => selector(state as AppState));\r\n}\r\n","import \"@/styles\";\r\n\r\nimport * as React from \"react\";\r\nimport * as ReactDOM from \"react-dom\";\r\n\r\nimport Root from \"./root\";\r\n\r\nconst rootEl = document.getElementById(\"root\");\r\nif (rootEl) {\r\n  ReactDOM.render(<Root />, rootEl);\r\n}\r\n","import history from \"@/history\";\r\nimport { isModifierPressed } from \"@/modifier-keys\";\r\nimport React from \"react\";\r\n\r\nexport function useLinkClicked(\r\n  to: string,\r\n  target?: string,\r\n  onClick?: (e: React.MouseEvent<HTMLElement>) => void\r\n) {\r\n  return React.useCallback(\r\n    (event: React.MouseEvent<HTMLElement>) => {\r\n      if (onClick) {\r\n        onClick(event);\r\n      }\r\n\r\n      if (\r\n        !event.defaultPrevented && // onClick prevented default\r\n        event.button === 0 && // ignore everything but left clicks\r\n        (!target || target === \"_self\") && // let browser handle \"target=_blank\" etc.\r\n        !isModifierPressed(event) // ignore clicks with modifier keys\r\n      ) {\r\n        event.preventDefault();\r\n\r\n        history.push(to);\r\n      }\r\n    },\r\n    [to, target, onClick]\r\n  );\r\n}\r\n","const oil = require(\"./oil.json\");\r\nconst water = require(\"./water.json\");\r\n\r\nexport const TemplatesByName = {\r\n  oil,\r\n  water,\r\n};\r\n\r\nexport type TemplateName = keyof typeof TemplatesByName;\r\n","import { keyboardModifierUseMeta } from \"./runtime-env\";\r\n\r\nexport const MODIFIER_KEYS_NONE = Object.freeze<ModifierKeys>({});\r\n\r\nexport interface ModifierKeys {\r\n  ctrlMetaKey?: boolean;\r\n  shiftKey?: boolean;\r\n  altKey?: boolean;\r\n}\r\n\r\nexport interface MouseEventModifierKeys {\r\n  ctrlKey: boolean;\r\n  altKey: boolean;\r\n  shiftKey: boolean;\r\n  metaKey: boolean;\r\n}\r\nexport function getModifiers(e: MouseEventModifierKeys): ModifierKeys {\r\n  const { ctrlKey, altKey, shiftKey, metaKey } = e;\r\n  return {\r\n    // Mac reserves ctrl for system use, apps use meta.\r\n    ctrlMetaKey: keyboardModifierUseMeta ? metaKey : ctrlKey,\r\n    altKey,\r\n    shiftKey,\r\n  };\r\n}\r\n\r\nexport function isModifierPressed(event: React.MouseEvent<any>) {\r\n  return !!(event.metaKey || event.altKey || event.ctrlKey || event.shiftKey);\r\n}\r\n","import { forEach } from \"lodash\";\r\n\r\nexport type StringKeysOf<T> = {\r\n  [K in keyof T]: T[K] extends string | undefined ? K : never;\r\n}[keyof T];\r\n\r\nexport function merge<TObj, TExtra extends Record<string, any>>(\r\n  obj: TObj,\r\n  extra: TExtra\r\n): TObj & TExtra {\r\n  for (const key in extra) {\r\n    (obj as any)[key] = extra[key];\r\n  }\r\n  return obj as any;\r\n}\r\n","import * as React from \"react\";\r\n\r\nimport { useSelector } from \"@/hooks/use-selector\";\r\nimport { packageLoadStatusSelector } from \"@/services/package/selectors/package\";\r\n\r\nimport NoPackageView from \"./views/NoPackageView\";\r\nimport LoadingPackageView from \"./views/LoadingPackageView\";\r\nimport PackageView from \"./views/PackageView\";\r\nimport LoadErrorView from \"./views/LoadErrorView\";\r\n\r\nconst HomePage: React.FC = () => {\r\n  const loadingState = useSelector(packageLoadStatusSelector);\r\n  return (\r\n    <>\r\n      {loadingState == \"idle\" && <NoPackageView />}\r\n      {loadingState == \"loading\" && <LoadingPackageView />}\r\n      {loadingState == \"loaded\" && <PackageView />}\r\n      {loadingState == \"error\" && <LoadErrorView />}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default HomePage;\r\n","import HomePage from \"./HomePage\";\r\nexport default HomePage;\r\n","import * as React from \"react\";\r\n\r\nimport { useSelector } from \"@/hooks/use-selector\";\r\n\r\nimport Page from \"@/components/Page\";\r\n\r\nimport { packageLoadErrorSelector } from \"@/services/package/selectors/package\";\r\n\r\nconst LoadErrorView = () => {\r\n  const error = useSelector(packageLoadErrorSelector);\r\n  return (\r\n    <Page showContentTree={false}>\r\n      <code>{error}</code>\r\n    </Page>\r\n  );\r\n};\r\n\r\nexport default LoadErrorView;\r\n","import * as React from \"react\";\r\n\r\nimport Page from \"@/components/Page\";\r\n\r\nconst NoPackageView = () => {\r\n  return <Page showContentTree={false}>Loading package.</Page>;\r\n};\r\n\r\nexport default NoPackageView;\r\n","import * as React from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\n\r\nimport Page from \"@/components/Page\";\r\n\r\nimport styles from \"./NoPackageView.module.css\";\r\n\r\nconst NoPackageView = () => {\r\n  const { t } = useTranslation();\r\n  return (\r\n    <Page showContentTree={false}>\r\n      <div className={styles[\"text\"]}>{t(\"package.message_no_package\")}</div>\r\n    </Page>\r\n  );\r\n};\r\n\r\nexport default NoPackageView;\r\n","import NoPackageView from \"./NoPackageView\";\r\nexport default NoPackageView;\r\n","import * as React from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useDispatch } from \"react-redux\";\r\n\r\nimport { useSelector } from \"@/hooks/use-selector\";\r\n\r\nimport { packageDataSelector } from \"@/services/package/selectors/package\";\r\n\r\nimport Page from \"@/components/Page\";\r\nimport Flow from \"@/components/Flow\";\r\nimport CommitTextBox from \"@/components/CommitTextBox\";\r\nimport CommitTextArea from \"@/components/CommitTextArea\";\r\n\r\nimport { packageDataSet } from \"@/actions/packages/package-data-set\";\r\n\r\nimport styles from \"./PackageView.module.css\";\r\n\r\nconst PackageView = () => {\r\n  const dispatch = useDispatch();\r\n  const { t } = useTranslation();\r\n\r\n  const packageData = useSelector(packageDataSelector);\r\n\r\n  const onSetPackageName = React.useCallback((name: string) => {\r\n    dispatch(packageDataSet(\"name\", name));\r\n  }, []);\r\n  const onSetPackageAuthor = React.useCallback((author: string) => {\r\n    dispatch(packageDataSet(\"author\", author));\r\n  }, []);\r\n  const onSetPackageDescription = React.useCallback((description: string) => {\r\n    dispatch(packageDataSet(\"description\", description));\r\n  }, []);\r\n\r\n  return (\r\n    <Page>\r\n      <Flow className={styles[\"package-editor-content\"]}>\r\n        <div className={styles[\"package-editor-field\"]}>\r\n          <label>{t(\"package.name\")}</label>\r\n          <CommitTextBox\r\n            value={packageData?.name ?? \"\"}\r\n            onCommit={onSetPackageName}\r\n          />\r\n        </div>\r\n        <div className={styles[\"package-editor-field\"]}>\r\n          <label>{t(\"package.author\")}</label>\r\n          <CommitTextBox\r\n            value={packageData?.author ?? \"\"}\r\n            onCommit={onSetPackageAuthor}\r\n          />\r\n        </div>\r\n        <div className={styles[\"package-editor-field\"]}>\r\n          <label>{t(\"package.description\")}</label>\r\n          <CommitTextArea\r\n            value={packageData?.description ?? \"\"}\r\n            onCommit={onSetPackageDescription}\r\n          />\r\n        </div>\r\n      </Flow>\r\n    </Page>\r\n  );\r\n};\r\n\r\nexport default PackageView;\r\n","import PackageView from \"./PackageView\";\r\nexport default PackageView;\r\n","import * as React from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nimport { packageIdObjectNew } from \"@/actions/packages/package-idobject-new\";\r\n\r\nimport { useSelector } from \"@/hooks/use-selector\";\r\n\r\nimport EnsurePackageLoaded from \"@/components/EnsurePackageLoaded\";\r\nimport Page from \"@/components/Page\";\r\nimport Flow from \"@/components/Flow\";\r\n\r\nimport { packageIdObjectIdsSelector } from \"@/services/package/selectors/package\";\r\n\r\nconst IngredientsListPage = () => {\r\n  const dispatch = useDispatch();\r\n  const ingredientIds = useSelector((state) =>\r\n    packageIdObjectIdsSelector(state, \"ingredients\")\r\n  );\r\n\r\n  const [newIngredientId, setNewIngredientId] = React.useState<string | null>(\r\n    null\r\n  );\r\n\r\n  const onNewIngredient = React.useCallback(() => {\r\n    if (newIngredientId != null && newIngredientId.length > 0) {\r\n      setNewIngredientId(null);\r\n      dispatch(packageIdObjectNew(\"ingredients\", newIngredientId));\r\n    }\r\n  }, [newIngredientId]);\r\n\r\n  return (\r\n    <>\r\n      <EnsurePackageLoaded />\r\n      <Page>\r\n        <Flow>\r\n          <ul>\r\n            {ingredientIds.map((potionBaseId) => (\r\n              <li key={potionBaseId}>\r\n                <Link to={`/ingredients/${potionBaseId}`}>{potionBaseId}</Link>\r\n              </li>\r\n            ))}\r\n          </ul>\r\n        </Flow>\r\n      </Page>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default IngredientsListPage;\r\n","import IngredientsListPage from \"./IngredientsListPage\";\r\nexport default IngredientsListPage;\r\n","import * as React from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { Link } from \"react-router-dom\";\r\nimport history from \"@/history\";\r\n\r\nimport { packageIdObjectNew } from \"@/actions/packages/package-idobject-new\";\r\n\r\nimport { useSelector } from \"@/hooks/use-selector\";\r\n\r\nimport Page from \"@/components/Page\";\r\nimport Flow from \"@/components/Flow\";\r\nimport Button from \"@/components/Button\";\r\nimport EnsurePackageLoaded from \"@/components/EnsurePackageLoaded\";\r\n\r\nimport { packageIdObjectIdsSelector } from \"@/services/package/selectors/package\";\r\n\r\nimport Modal from \"@/components/Modal\";\r\nimport TextBox from \"@/components/TextBox\";\r\n\r\nconst PotionBaseListPage = () => {\r\n  const dispatch = useDispatch();\r\n  const { t } = useTranslation();\r\n  const potionBaseIds = useSelector((state) =>\r\n    packageIdObjectIdsSelector(state, \"potionBases\")\r\n  );\r\n\r\n  const [newPotionId, setNewPotionId] = React.useState<string | null>(null);\r\n\r\n  const onRequestNewPotionBase = React.useCallback(() => {\r\n    setNewPotionId(\"\");\r\n  }, []);\r\n  const onCancelNewPotionBase = React.useCallback(() => {\r\n    setNewPotionId(null);\r\n  }, []);\r\n  const onNewPotionBase = React.useCallback(() => {\r\n    if (newPotionId != null && newPotionId.length > 0) {\r\n      setNewPotionId(null);\r\n      dispatch(packageIdObjectNew(\"potionBases\", newPotionId));\r\n      history.push(`/potion-bases/${newPotionId}`);\r\n    }\r\n  }, [newPotionId]);\r\n\r\n  return (\r\n    <>\r\n      <EnsurePackageLoaded />\r\n      <Page>\r\n        <Flow>\r\n          <ul>\r\n            {potionBaseIds.map((potionBaseId) => (\r\n              <li key={potionBaseId}>\r\n                <Link to={`/potion-bases/${potionBaseId}`}>{potionBaseId}</Link>\r\n              </li>\r\n            ))}\r\n          </ul>\r\n          <Button variant=\"primary\" onClick={onRequestNewPotionBase}>\r\n            {t(\"potion_base.new\")}\r\n          </Button>\r\n          <Modal\r\n            isOpen={newPotionId != null}\r\n            onRequestClose={onCancelNewPotionBase}\r\n          >\r\n            <p>{t(\"potion_base.new_id_prompt\")}</p>\r\n            <div>\r\n              <TextBox\r\n                autoFocus\r\n                value={newPotionId!}\r\n                onChange={(e) => setNewPotionId(e.target.value)}\r\n              />\r\n            </div>\r\n            <div>\r\n              <Button\r\n                disabled={newPotionId == null || newPotionId == \"\"}\r\n                onClick={onNewPotionBase}\r\n              >\r\n                {t(\"potion_base.new\")}\r\n              </Button>\r\n            </div>\r\n          </Modal>\r\n        </Flow>\r\n      </Page>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default PotionBaseListPage;\r\n","import PotionBaseListPage from \"./PotionBaseListPage\";\r\nexport default PotionBaseListPage;\r\n","import * as React from \"react\";\r\nimport { RouteChildrenProps } from \"react-router\";\r\nimport { useDispatch } from \"react-redux\";\r\n\r\nimport history from \"@/history\";\r\n\r\nimport { potionBaseMapEdit } from \"@/actions/potion-bases/map-edit\";\r\n\r\nimport EnsurePackageLoaded from \"@/components/EnsurePackageLoaded\";\r\nimport Page from \"@/components/Page\";\r\n\r\nimport MapWindow from \"./components/MapWindow\";\r\nimport MapMenuButton from \"./components/MapMenuButton\";\r\n\r\nexport interface PotionBaseMapEditorPageParams {\r\n  potionBaseId: string;\r\n}\r\n\r\nconst PotionBaseMapEditorPage: React.FC<\r\n  RouteChildrenProps<PotionBaseMapEditorPageParams>\r\n> = ({ match }) => {\r\n  const dispatch = useDispatch();\r\n  const { potionBaseId } = match?.params ?? {};\r\n\r\n  React.useEffect(() => {\r\n    if (potionBaseId) {\r\n      dispatch(potionBaseMapEdit(potionBaseId));\r\n    } else {\r\n      history.push(\"/\");\r\n    }\r\n  }, [potionBaseId]);\r\n\r\n  return (\r\n    <>\r\n      <EnsurePackageLoaded />\r\n      <Page titlebarContent={<MapMenuButton />}>\r\n        <MapWindow />\r\n      </Page>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default PotionBaseMapEditorPage;\r\n","import * as React from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\n\r\nimport { useClickAction } from \"@/hooks/use-action\";\r\n\r\nimport Menu from \"@/components/Menus/Menu\";\r\nimport MenuItem from \"@/components/Menus/MenuItem\";\r\nimport SubMenuItem from \"@/components/Menus/SubMenuItem\";\r\nimport DividerMenuItem from \"@/components/Menus/DividerMenuItem\";\r\nimport AutoPopper from \"@/components/AutoPopper\";\r\nimport Button from \"@/components/Button\";\r\n\r\nimport { mapEditorMapClear } from \"@/actions/map-editor/map-clear\";\r\nimport { mapEditorMapImportTemplate } from \"@/actions/map-editor/map-import-template\";\r\n\r\nconst MapMenuButton = () => {\r\n  const { t } = useTranslation();\r\n  return (\r\n    <AutoPopper content={<MapMenu />} placement=\"bottom-start\">\r\n      <Button variant=\"menu\">{t(\"map.toolbar_menu_item\")}</Button>\r\n    </AutoPopper>\r\n  );\r\n};\r\n\r\nexport default MapMenuButton;\r\n\r\nconst MapMenu = () => {\r\n  const { t } = useTranslation();\r\n  const onMapClear = useClickAction(mapEditorMapClear);\r\n  return (\r\n    <Menu>\r\n      <SubMenuItem content={<MapImportMenu />}>{t(\"map.import\")}</SubMenuItem>\r\n      <DividerMenuItem />\r\n      <MenuItem onClick={onMapClear}>{t(\"map.clear\")}</MenuItem>\r\n    </Menu>\r\n  );\r\n};\r\n\r\nconst MapImportMenu = () => {\r\n  const { t } = useTranslation();\r\n  return (\r\n    <Menu>\r\n      <SubMenuItem content={<MapImportTemplateMenu />}>\r\n        {t(\"map.import_template\")}\r\n      </SubMenuItem>\r\n      <MenuItem disabled={true}>{t(\"map.import_file\")}</MenuItem>\r\n    </Menu>\r\n  );\r\n};\r\n\r\nconst MapImportTemplateMenu = () => {\r\n  const { t } = useTranslation();\r\n  const onNewWaterMap = useClickAction(mapEditorMapImportTemplate, \"water\");\r\n  const onNewOilMap = useClickAction(mapEditorMapImportTemplate, \"oil\");\r\n  return (\r\n    <Menu>\r\n      <MenuItem onClick={onNewWaterMap}>\r\n        {t(\"potioncraft:bases.water_titlecase\")}\r\n      </MenuItem>\r\n      <MenuItem onClick={onNewOilMap}>\r\n        {t(\"potioncraft:bases.oil_titlecase\")}\r\n      </MenuItem>\r\n    </Menu>\r\n  );\r\n};\r\n","import * as React from \"react\";\r\n\r\nimport MapEditor from \"@/components/MapEditor\";\r\nimport MapEditorToolBar from \"@/components/MapEditorToolbar\";\r\n\r\nimport styles from \"./MapWindow.module.css\";\r\n\r\nconst MapWindow = () => {\r\n  return (\r\n    <div className={styles[\"map-window-container\"]}>\r\n      <MapEditor className={styles[\"map-window-editor\"]} />\r\n      <MapEditorToolBar className={styles[\"map-window-toolbar\"]} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MapWindow;\r\n","import MapWindow from \"./MapWindow\";\r\nexport default MapWindow;\r\n","import PotionBaseMapEditorPage from \"./PotionBaseMapEditorPage\";\r\nexport default PotionBaseMapEditorPage;\r\n","import * as React from \"react\";\r\nimport { RouteComponentProps } from \"react-router\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { Redirect } from \"react-router-dom\";\r\n\r\nimport { useSelector } from \"@/hooks/use-selector\";\r\n\r\nimport { packageDataSetById } from \"@/actions/packages/package-data-set-byid\";\r\n\r\nimport { packageIdObjectDataSelector } from \"@/services/package/selectors/package\";\r\n\r\nimport EnsurePackageLoaded from \"@/components/EnsurePackageLoaded\";\r\nimport Page from \"@/components/Page\";\r\nimport Flow from \"@/components/Flow\";\r\nimport FieldBox from \"@/components/FieldBox\";\r\nimport LinkButton from \"@/components/Button/LinkButton\";\r\nimport Divider from \"@/components/Divider\";\r\nimport Checkbox from \"@/components/Checkbox\";\r\n\r\nimport PotionBaseName from \"./components/PotionBaseName/PotionBaseName\";\r\nimport PotionBaseTooltipImage from \"./components/PotionBaseTooltipImage/PotionBaseTooltipImage\";\r\nimport PotionBaseDescription from \"./components/PotionBaseDescription/PotionBaseDescription\";\r\nimport PotionBaseIcons from \"./components/PotionBaseIcons/PotionBaseIcons\";\r\nimport PotionBaseColor from \"./components/PotionBaseColor\";\r\n\r\nimport styles from \"./PotionBasePage.module.css\";\r\n\r\ninterface PotionBaseRouteParams {\r\n  potionBaseId: string;\r\n}\r\n\r\nconst PotionBasePage: React.FC<RouteComponentProps<PotionBaseRouteParams>> = ({\r\n  match: {\r\n    params: { potionBaseId },\r\n  },\r\n}) => {\r\n  const dispatch = useDispatch();\r\n  const { t } = useTranslation();\r\n\r\n  const potionBase = useSelector((state) =>\r\n    packageIdObjectDataSelector(state, \"potionBases\", potionBaseId)\r\n  );\r\n\r\n  const onSetUnlockedOnStart = React.useCallback(\r\n    (e: React.ChangeEvent<HTMLInputElement>) => {\r\n      dispatch(\r\n        packageDataSetById(\r\n          \"potionBases\",\r\n          potionBaseId,\r\n          \"unlockedOnStart\",\r\n          e.target.checked\r\n        )\r\n      );\r\n    },\r\n    [potionBaseId]\r\n  );\r\n\r\n  if (!potionBase) {\r\n    return <Redirect to=\"/\" />;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <EnsurePackageLoaded />\r\n      <Page>\r\n        <div className={styles[\"potionbase-editor-content\"]}>\r\n          <Flow className={styles[\"potionbase-editor-overview\"]}>\r\n            <PotionBaseName potionBaseId={potionBaseId} />\r\n            <Divider />\r\n            <PotionBaseTooltipImage potionBaseId={potionBaseId} />\r\n            <Divider />\r\n            <PotionBaseDescription\r\n              className={styles[\"potioncraft-editor-description\"]}\r\n              potionBaseId={potionBaseId}\r\n            />\r\n          </Flow>\r\n          <FieldBox\r\n            label={t(\"potion_base.settings\")}\r\n            className={styles[\"potionbase-editor-settings\"]}\r\n          >\r\n            <PotionBaseColor potionBaseId={potionBaseId} />\r\n            <Checkbox\r\n              checked={potionBase.unlockedOnStart ?? false}\r\n              onChange={onSetUnlockedOnStart}\r\n            >\r\n              {t(\"potion_base.unlocked_on_start\")}\r\n            </Checkbox>\r\n          </FieldBox>\r\n          <PotionBaseIcons\r\n            className={styles[\"potionbase-editor-icons\"]}\r\n            potionBaseId={potionBaseId}\r\n          />\r\n          <LinkButton\r\n            className={styles[\"potionbase-editor-map\"]}\r\n            variant=\"primary\"\r\n            to={`/potion-bases/${potionBaseId}/map-editor`}\r\n          >\r\n            {t(\"potion_base.edit_map\")}\r\n          </LinkButton>\r\n        </div>\r\n      </Page>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default PotionBasePage;\r\n","import * as React from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useDispatch } from \"react-redux\";\r\n\r\nimport { useSelector } from \"@/hooks/use-selector\";\r\n\r\nimport { packageIdObjectDataSelector } from \"@/services/package/selectors/package\";\r\n\r\nimport { packageDataSetById } from \"@/actions/packages/package-data-set-byid\";\r\n\r\nimport FieldBox from \"@/components/FieldBox\";\r\nimport ColorButton from \"@/components/ColorButton\";\r\n\r\nimport styles from \"./PotionBaseColor.module.css\";\r\n\r\nexport interface PotionBaseColorProps {\r\n  potionBaseId: string;\r\n}\r\n\r\nconst PotionBaseColor = ({ potionBaseId }: PotionBaseColorProps) => {\r\n  const { t } = useTranslation();\r\n  const dispatch = useDispatch();\r\n\r\n  const potionBase = useSelector((state) =>\r\n    packageIdObjectDataSelector(state, \"potionBases\", potionBaseId)\r\n  );\r\n\r\n  const onSetColor = React.useCallback(\r\n    (color: string) => {\r\n      dispatch(\r\n        packageDataSetById(\"potionBases\", potionBaseId, \"liquidColor\", color)\r\n      );\r\n    },\r\n    [potionBaseId]\r\n  );\r\n\r\n  if (!potionBase) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className={styles[\"potionbase-liquidcolor\"]}>\r\n      <ColorButton\r\n        color={potionBase.liquidColor ?? \"#FFFFFF\"}\r\n        onChange={onSetColor}\r\n      >\r\n        {t(\"potion_base.liquid_color\")}\r\n      </ColorButton>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PotionBaseColor;\r\n","import PotionBaseColor from \"./PotionBaseColor\";\r\nexport default PotionBaseColor;\r\n","import * as React from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport classNames from \"classnames\";\r\n\r\nimport { useSelector } from \"@/hooks/use-selector\";\r\n\r\nimport { packageDataSetById } from \"@/actions/packages/package-data-set-byid\";\r\n\r\nimport { packageIdObjectDataSelector } from \"@/services/package/selectors/package\";\r\n\r\nimport CommitTextArea from \"@/components/CommitTextArea\";\r\n\r\nimport styles from \"./PotionBaseDescription.module.css\";\r\n\r\nexport interface PotionBaseDescriptionProps {\r\n  className?: string;\r\n  potionBaseId: string;\r\n}\r\n\r\nconst PotionBaseDescription = ({\r\n  className,\r\n  potionBaseId,\r\n}: PotionBaseDescriptionProps) => {\r\n  const { t } = useTranslation();\r\n  const dispatch = useDispatch();\r\n  const potionBase = useSelector((state) =>\r\n    packageIdObjectDataSelector(state, \"potionBases\", potionBaseId)\r\n  );\r\n\r\n  const onSetDescription = React.useCallback(\r\n    (description: string) => {\r\n      if (potionBase == null) {\r\n        return;\r\n      }\r\n      dispatch(\r\n        packageDataSetById(\r\n          \"potionBases\",\r\n          potionBaseId,\r\n          \"description\",\r\n          description\r\n        )\r\n      );\r\n    },\r\n    [potionBaseId]\r\n  );\r\n\r\n  if (!potionBase) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className={classNames(styles[\"potionbasedescription\"], className)}>\r\n      <CommitTextArea\r\n        className={styles[\"potionbasedescription-input\"]}\r\n        placeholder={t(\"potion_base.description\")}\r\n        minRows={10}\r\n        defaultValue={potionBase.description ?? \"\"}\r\n        onCommit={onSetDescription}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PotionBaseDescription;\r\n","import * as React from \"react\";\r\nimport classNames from \"classnames\";\r\n\r\nimport { useIdObjectResource } from \"@/services/package/hooks/use-idobject-resource\";\r\n\r\nimport ImageField from \"@/components/ImageField\";\r\n\r\nimport styles from \"./PotionBaseIcons.module.css\";\r\n\r\nexport interface PotionbaseIconsProps {\r\n  className?: string;\r\n  potionBaseId: string;\r\n}\r\n\r\nconst PotionBaseIcons = ({ className, potionBaseId }: PotionbaseIconsProps) => {\r\n  const [ingredientListIcon, ingredientListIconName, onSetIngredientListIcon] =\r\n    useIdObjectResource(\"potionBases\", potionBaseId, \"ingredientListIcon\");\r\n\r\n  const [menuButtonImage, menuButtonImageName, onSetMenuButtonImage] =\r\n    useIdObjectResource(\"potionBases\", potionBaseId, \"menuButtonImage\");\r\n  const [\r\n    menuButtonHoverImage,\r\n    menuButtonHoverImageName,\r\n    onSetMenuButtonHoverImage,\r\n  ] = useIdObjectResource(\"potionBases\", potionBaseId, \"menuButtonHoverImage\");\r\n  const [\r\n    menuButtonSelectedImage,\r\n    menuButtonSelectedImageName,\r\n    onSetMenuButtonSelectedImage,\r\n  ] = useIdObjectResource(\r\n    \"potionBases\",\r\n    potionBaseId,\r\n    \"menuButtonSelectedImage\"\r\n  );\r\n  const [\r\n    menuButtonLockedImage,\r\n    menuButtonLockedImageName,\r\n    onSetMenuButtonLockedImage,\r\n  ] = useIdObjectResource(\"potionBases\", potionBaseId, \"menuButtonLockedImage\");\r\n\r\n  const [ladleImage, ladleImageName, onSetLadleImage] = useIdObjectResource(\r\n    \"potionBases\",\r\n    potionBaseId,\r\n    \"ladleImage\"\r\n  );\r\n  const [recipeStepImage, recipeStepImageName, onSetRecipeStepImage] =\r\n    useIdObjectResource(\"potionBases\", potionBaseId, \"recipeStepImage\");\r\n  const [mapOriginImage, mapOriginImageName, onSetMapOriginImage] =\r\n    useIdObjectResource(\"potionBases\", potionBaseId, \"mapOriginImage\");\r\n\r\n  return (\r\n    <div className={classNames(styles[\"potionbaseicons\"], className)}>\r\n      <ImageField\r\n        className={styles[\"potionbaseicons-imagefield\"]}\r\n        imageResource={menuButtonImage}\r\n        imageResourceName={menuButtonImageName}\r\n        onChange={onSetMenuButtonImage}\r\n      />\r\n      <div className={styles[\"potionbaseicons-imagetext\"]}>Menu</div>\r\n      <ImageField\r\n        className={styles[\"potionbaseicons-imagefield\"]}\r\n        imageResource={ingredientListIcon}\r\n        imageResourceName={ingredientListIconName}\r\n        onChange={onSetIngredientListIcon}\r\n      />\r\n      <div className={styles[\"potionbaseicons-imagetext\"]}>Ingredients</div>\r\n      <ImageField\r\n        className={styles[\"potionbaseicons-imagefield\"]}\r\n        imageResource={menuButtonSelectedImage}\r\n        imageResourceName={menuButtonSelectedImageName}\r\n        onChange={onSetMenuButtonSelectedImage}\r\n      />\r\n      <div className={styles[\"potionbaseicons-imagetext\"]}>Selected</div>\r\n      <ImageField\r\n        className={styles[\"potionbaseicons-imagefield\"]}\r\n        imageResource={recipeStepImage}\r\n        imageResourceName={recipeStepImageName}\r\n        onChange={onSetRecipeStepImage}\r\n      />\r\n      <div className={styles[\"potionbaseicons-imagetext\"]}>Recipe</div>\r\n      <ImageField\r\n        className={styles[\"potionbaseicons-imagefield\"]}\r\n        imageResource={menuButtonHoverImage}\r\n        imageResourceName={menuButtonHoverImageName}\r\n        onChange={onSetMenuButtonHoverImage}\r\n      />\r\n      <div className={styles[\"potionbaseicons-imagetext\"]}>Hover</div>\r\n      <ImageField\r\n        className={styles[\"potionbaseicons-imagefield\"]}\r\n        imageResource={ladleImage}\r\n        imageResourceName={ladleImageName}\r\n        onChange={onSetLadleImage}\r\n      />\r\n      <div className={styles[\"potionbaseicons-imagetext\"]}>Ladle</div>\r\n      <ImageField\r\n        className={styles[\"potionbaseicons-imagefield\"]}\r\n        imageResource={menuButtonLockedImage}\r\n        imageResourceName={menuButtonLockedImageName}\r\n        onChange={onSetMenuButtonLockedImage}\r\n      />\r\n      <div className={styles[\"potionbaseicons-imagetext\"]}>Locked</div>\r\n      <ImageField\r\n        className={styles[\"potionbaseicons-imagefield\"]}\r\n        imageResource={mapOriginImage}\r\n        imageResourceName={mapOriginImageName}\r\n        onChange={onSetMapOriginImage}\r\n      />\r\n      <div className={styles[\"potionbaseicons-imagetext\"]}>Origin</div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PotionBaseIcons;\r\n","import * as React from \"react\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { useTranslation } from \"react-i18next\";\r\n\r\nimport { useSelector } from \"@/hooks/use-selector\";\r\n\r\nimport { packageDataSetById } from \"@/actions/packages/package-data-set-byid\";\r\nimport { packageIdObjectDataSelector } from \"@/services/package/selectors/package\";\r\n\r\nimport CommitTextBox from \"@/components/CommitTextBox\";\r\n\r\nimport styles from \"./PotionBaseName.module.css\";\r\n\r\nexport interface PotionBaseNameProps {\r\n  potionBaseId: string;\r\n}\r\n\r\nconst PotionBaseName = ({ potionBaseId }: PotionBaseNameProps) => {\r\n  const { t } = useTranslation();\r\n  const dispatch = useDispatch();\r\n\r\n  const potionBase = useSelector((state) =>\r\n    packageIdObjectDataSelector(state, \"potionBases\", potionBaseId)\r\n  );\r\n\r\n  const onSetName = React.useCallback(\r\n    (name: string) => {\r\n      if (potionBase == null) {\r\n        return;\r\n      }\r\n      dispatch(packageDataSetById(\"potionBases\", potionBaseId, \"name\", name));\r\n    },\r\n    [potionBaseId]\r\n  );\r\n\r\n  if (!potionBase) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <CommitTextBox\r\n        className={styles[\"potionbasename-input\"]}\r\n        placeholder={t(\"potion_base.name\")}\r\n        value={potionBase.name ?? \"\"}\r\n        onCommit={onSetName}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PotionBaseName;\r\n","import * as React from \"react\";\r\n\r\nimport ImageField from \"@/components/ImageField\";\r\nimport { useIdObjectResource } from \"@/services/package/hooks/use-idobject-resource\";\r\n\r\nimport styles from \"./PotionBaseTooltipImage.module.css\";\r\n\r\nexport interface PotionBaseTooltipImageProps {\r\n  potionBaseId: string;\r\n}\r\n\r\nconst PotionBaseTooltipImage = ({\r\n  potionBaseId,\r\n}: PotionBaseTooltipImageProps) => {\r\n  const [tooltipImage, tooltipImageName, onSetTooltipImage] =\r\n    useIdObjectResource(\"potionBases\", potionBaseId, \"tooltipImage\");\r\n\r\n  return (\r\n    <ImageField\r\n      className={styles[\"potionbasetooltipimage\"]}\r\n      imageResource={tooltipImage}\r\n      imageResourceName={tooltipImageName}\r\n      onChange={onSetTooltipImage}\r\n    />\r\n  );\r\n};\r\n\r\nexport default PotionBaseTooltipImage;\r\n","import PotionBasePage from \"./PotionBasePage\";\r\nexport default PotionBasePage;\r\n","import * as React from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nimport history from \"@/history\";\r\n\r\nimport { packageIdObjectNew } from \"@/actions/packages/package-idobject-new\";\r\n\r\nimport { useSelector } from \"@/hooks/use-selector\";\r\n\r\nimport EnsurePackageLoaded from \"@/components/EnsurePackageLoaded\";\r\nimport Page from \"@/components/Page\";\r\nimport Flow from \"@/components/Flow\";\r\nimport Button from \"@/components/Button\";\r\nimport Modal from \"@/components/Modal\";\r\nimport TextBox from \"@/components/TextBox\";\r\n\r\nimport { packageIdObjectIdsSelector } from \"@/services/package/selectors/package\";\r\n\r\nconst IngredientsListPage = () => {\r\n  const dispatch = useDispatch();\r\n  const { t } = useTranslation();\r\n  const bottleIds = useSelector((state) =>\r\n    packageIdObjectIdsSelector(state, \"potionBottles\")\r\n  );\r\n\r\n  const [newBottleId, setNewBottleId] = React.useState<string | null>(null);\r\n\r\n  const onRequestNewIngredient = React.useCallback(() => {\r\n    setNewBottleId(\"\");\r\n  }, []);\r\n  const onNewBottle = React.useCallback(() => {\r\n    if (newBottleId != null && newBottleId.length > 0) {\r\n      setNewBottleId(null);\r\n      dispatch(packageIdObjectNew(\"potionBottles\", newBottleId));\r\n      history.push(`/potion-bottles/${newBottleId}`);\r\n    }\r\n  }, [newBottleId]);\r\n\r\n  return (\r\n    <>\r\n      <EnsurePackageLoaded />\r\n      <Page>\r\n        <Flow>\r\n          <ul>\r\n            {bottleIds.map((potionBaseId) => (\r\n              <li key={potionBaseId}>\r\n                <Link to={`/potion-bottles/${potionBaseId}`}>\r\n                  {potionBaseId}\r\n                </Link>\r\n              </li>\r\n            ))}\r\n          </ul>\r\n          <Button variant=\"primary\" onClick={onRequestNewIngredient}>\r\n            {t(\"potion_bottle.new\")}\r\n          </Button>\r\n          <Modal isOpen={newBottleId != null}>\r\n            <p>{t(\"potion_bottle.new_id_prompt\")}</p>\r\n            <div>\r\n              <TextBox\r\n                autoFocus\r\n                value={newBottleId!}\r\n                onChange={(e) => setNewBottleId(e.target.value)}\r\n              />\r\n            </div>\r\n            <div>\r\n              <Button\r\n                disabled={newBottleId == null || newBottleId == \"\"}\r\n                onClick={onNewBottle}\r\n              >\r\n                {t(\"potion_bottle.new\")}\r\n              </Button>\r\n            </div>\r\n          </Modal>\r\n        </Flow>\r\n      </Page>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default IngredientsListPage;\r\n","import PotionBottleListPage from \"./PotionBottleListPage\";\r\nexport default PotionBottleListPage;\r\n","import * as React from \"react\";\r\nimport { RouteComponentProps } from \"react-router\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport classNames from \"classnames\";\r\n\r\nimport { useSelector } from \"@/hooks/use-selector\";\r\n\r\nimport { packageIdObjectDataSelector } from \"@/services/package/selectors/package\";\r\n\r\nimport EnsurePackageLoaded from \"@/components/EnsurePackageLoaded\";\r\nimport Page from \"@/components/Page\";\r\nimport Divider from \"@/components/Divider\";\r\n\r\nimport PotionBottleIcon from \"./components/PotionBottleIcon\";\r\nimport PotionBottleForeground from \"./components/PotionBottleForeground\";\r\n\r\nimport styles from \"./PotionBottlePage.module.css\";\r\nimport PotionBottleMask from \"./components/PotionBottleMask\";\r\n\r\nimport { makeLiquidEditor } from \"./components/PotionBottleLiquidEditor\";\r\n\r\nconst LiquidEditor1 = makeLiquidEditor([\"liquidMain\"]);\r\nconst LiquidEditor2 = makeLiquidEditor([\"liquidMain\", \"liquid2Of2\"]);\r\nconst LiquidEditor3 = makeLiquidEditor([\r\n  \"liquidMain\",\r\n  \"liquid1Of3\",\r\n  \"liquid3Of3\",\r\n]);\r\n\r\nconst LiquidEditor4 = makeLiquidEditor([\r\n  \"liquidMain\",\r\n  \"liquid1Of4\",\r\n  \"liquid3Of4\",\r\n  \"liquid4Of4\",\r\n]);\r\n\r\nconst LiquidEditor5 = makeLiquidEditor([\r\n  \"liquidMain\",\r\n  \"liquid1Of5\",\r\n  \"liquid2Of5\",\r\n  \"liquid4Of5\",\r\n  \"liquid5Of5\",\r\n]);\r\n\r\ninterface PotionBottlePageParams {\r\n  potionBottleId: string;\r\n}\r\n\r\nconst PotionBottlePage = ({\r\n  match: {\r\n    params: { potionBottleId },\r\n  },\r\n}: RouteComponentProps<PotionBottlePageParams>) => {\r\n  const potionBottle = useSelector((state) =>\r\n    packageIdObjectDataSelector(state, \"potionBottles\", potionBottleId)\r\n  );\r\n\r\n  if (!potionBottle) {\r\n    return <Redirect to=\"/\" />;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <EnsurePackageLoaded />\r\n      <Page>\r\n        <div className={styles[\"potionbottle-content\"]}>\r\n          <h1>{potionBottle.id}</h1>\r\n          <Divider />\r\n          <div className={styles[\"potionbottle-section\"]}>\r\n            <div\r\n              className={classNames(\r\n                styles[\"potionbottle-section-item\"],\r\n                styles[\"potionbottle-icon\"]\r\n              )}\r\n            >\r\n              <div className={styles[\"potionbottle-section-title\"]}>Icon</div>\r\n              <PotionBottleIcon\r\n                className={styles[\"potionbottle-section-art\"]}\r\n                potionBottleId={potionBottleId}\r\n              />\r\n            </div>\r\n          </div>\r\n          <div className={styles[\"potionbottle-section\"]}>\r\n            <div\r\n              className={classNames(\r\n                styles[\"potionbottle-section-item\"],\r\n                styles[\"potionbottle-bottleart\"]\r\n              )}\r\n            >\r\n              <div className={styles[\"potionbottle-section-title\"]}>\r\n                Foreground\r\n              </div>\r\n              <PotionBottleForeground\r\n                className={styles[\"potionbottle-section-art\"]}\r\n                potionBottleId={potionBottleId}\r\n              />\r\n            </div>\r\n            <div\r\n              className={classNames(\r\n                styles[\"potionbottle-section-item\"],\r\n                styles[\"potionbottle-bottleart\"]\r\n              )}\r\n            >\r\n              <div className={styles[\"potionbottle-section-title\"]}>Mask</div>\r\n              <PotionBottleMask\r\n                className={styles[\"potionbottle-section-art\"]}\r\n                potionBottleId={potionBottleId}\r\n              />\r\n            </div>\r\n          </div>\r\n          <div className={styles[\"potionbottle-section\"]}>\r\n            <LiquidEditor1 label=\"One Effect\" potionBottleId={potionBottleId} />\r\n            <LiquidEditor2\r\n              label=\"Two Effects\"\r\n              potionBottleId={potionBottleId}\r\n            />\r\n            <LiquidEditor3\r\n              label=\"Three Effects\"\r\n              potionBottleId={potionBottleId}\r\n            />\r\n            <LiquidEditor4\r\n              label=\"Four Effects\"\r\n              potionBottleId={potionBottleId}\r\n            />\r\n            <LiquidEditor5\r\n              label=\"Five Effects\"\r\n              potionBottleId={potionBottleId}\r\n            />\r\n          </div>\r\n        </div>\r\n      </Page>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default PotionBottlePage;\r\n","import * as React from \"react\";\r\n\r\nimport ImageField from \"@/components/ImageField\";\r\nimport { useIdObjectResource } from \"@/services/package/hooks/use-idobject-resource\";\r\n\r\nexport interface PotionBottleForegroundProps {\r\n  className?: string;\r\n  potionBottleId: string;\r\n}\r\n\r\nconst PotionBottleForeground = ({\r\n  className,\r\n  potionBottleId,\r\n}: PotionBottleForegroundProps) => {\r\n  const [iconResource, iconResourceName, onSetIcon] = useIdObjectResource(\r\n    \"potionBottles\",\r\n    potionBottleId,\r\n    \"bottleForeground\"\r\n  );\r\n\r\n  return (\r\n    <ImageField\r\n      className={className}\r\n      imageResource={iconResource}\r\n      imageResourceName={iconResourceName}\r\n      onChange={onSetIcon}\r\n    />\r\n  );\r\n};\r\n\r\nexport default PotionBottleForeground;\r\n","import * as React from \"react\";\r\n\r\nimport ImageField from \"@/components/ImageField\";\r\nimport { useIdObjectResource } from \"@/services/package/hooks/use-idobject-resource\";\r\n\r\nexport interface PotionBottleIconProps {\r\n  className?: string;\r\n  potionBottleId: string;\r\n}\r\n\r\nconst PotionBottleIcon = ({\r\n  className,\r\n  potionBottleId,\r\n}: PotionBottleIconProps) => {\r\n  const [iconResource, iconResourceName, onSetIcon] = useIdObjectResource(\r\n    \"potionBottles\",\r\n    potionBottleId,\r\n    \"bottleIcon\"\r\n  );\r\n\r\n  return (\r\n    <ImageField\r\n      className={className}\r\n      imageResource={iconResource}\r\n      imageResourceName={iconResourceName}\r\n      onChange={onSetIcon}\r\n    />\r\n  );\r\n};\r\n\r\nexport default PotionBottleIcon;\r\n","import * as React from \"react\";\r\nimport classNames from \"classnames\";\r\n\r\nimport { extname } from \"@/paths\";\r\n\r\nimport { useSelector } from \"@/hooks/use-selector\";\r\nimport {\r\n  packageIdObjectDataSelector,\r\n  packageIdObjectResourceSelector,\r\n} from \"@/services/package/selectors/package\";\r\n\r\nimport IdObjectResourceField from \"@/components/IdObjectResourceField\";\r\n\r\nconst PotionBottleResourceField = IdObjectResourceField.ofType(\"potionBottles\");\r\n\r\nimport styles from \"./PotionBottleLiquidEditor.module.css\";\r\n\r\nexport type PotionBottleLiquidKey =\r\n  | \"liquidMain\"\r\n  | \"liquid2Of2\"\r\n  | \"liquid1Of3\"\r\n  | \"liquid3Of3\"\r\n  | \"liquid1Of4\"\r\n  | \"liquid3Of4\"\r\n  | \"liquid4Of4\"\r\n  | \"liquid1Of5\"\r\n  | \"liquid2Of5\"\r\n  | \"liquid4Of5\"\r\n  | \"liquid5Of5\";\r\n\r\nexport interface PotionBottleLiquidPreviewProps {\r\n  label: string;\r\n  potionBottleId: string;\r\n}\r\n\r\nexport function makeLiquidEditor(artKeys: PotionBottleLiquidKey[]) {\r\n  const PotionBottleLiquidEditor = ({\r\n    label,\r\n    potionBottleId,\r\n  }: PotionBottleLiquidPreviewProps) => {\r\n    const foreground = useSelector((state) =>\r\n      packageIdObjectResourceSelector(\r\n        state,\r\n        \"potionBottles\",\r\n        potionBottleId,\r\n        \"bottleForeground\"\r\n      )\r\n    );\r\n\r\n    const potionBottle = useSelector((state) =>\r\n      packageIdObjectDataSelector(state, \"potionBottles\", potionBottleId)\r\n    );\r\n\r\n    const resourceUrls: string[] = [];\r\n\r\n    for (let i = 0; i < artKeys.length; i++) {\r\n      const resource = useSelector((state) =>\r\n        packageIdObjectResourceSelector(\r\n          state,\r\n          \"potionBottles\",\r\n          potionBottleId,\r\n          artKeys[i]\r\n        )\r\n      );\r\n      const resourceName = potionBottle && potionBottle[artKeys[i]];\r\n\r\n      if (!resource || !resourceName) {\r\n        continue;\r\n      }\r\n\r\n      const resourceUrl = URL.createObjectURL(\r\n        new Blob([resource.buffer], {\r\n          type: `image/${extname(resourceName)}`,\r\n        })\r\n      );\r\n\r\n      resourceUrls.push(resourceUrl);\r\n    }\r\n\r\n    if (!potionBottle) {\r\n      return null;\r\n    }\r\n\r\n    const foregroundUrl = foreground\r\n      ? URL.createObjectURL(\r\n          new Blob([foreground.buffer], {\r\n            type: `image/${extname(potionBottle.bottleForeground ?? \"\")}`,\r\n          })\r\n        )\r\n      : null;\r\n\r\n    return (\r\n      <div className={styles[\"liquidpreview\"]}>\r\n        <div className={styles[\"liquidpreview-art\"]}>\r\n          {resourceUrls.map((resourceUrl, i) => (\r\n            <img\r\n              className={classNames(\r\n                styles[\"liquidpreview-effect\"],\r\n                (styles as any)[\"liquidpreview-effect-\" + (i + 1)]\r\n              )}\r\n              key={i}\r\n              src={resourceUrl}\r\n            />\r\n          ))}\r\n          {foregroundUrl && (\r\n            <img\r\n              className={styles[\"liquidpreview-effect\"]}\r\n              src={foregroundUrl}\r\n            />\r\n          )}\r\n          <label className={styles[\"liquidpreview-label\"]}>{label}</label>\r\n        </div>\r\n        <div className={styles[\"liquidpreview-assets\"]}>\r\n          {artKeys.map((artKey, i) => (\r\n            <PotionBottleResourceField\r\n              key={i}\r\n              accept=\"image/png\"\r\n              objectId={potionBottleId}\r\n              resourceKey={artKey}\r\n              resourceName={artKey}\r\n            >\r\n              {`Effect ${i + 1}`}\r\n            </PotionBottleResourceField>\r\n          ))}\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  return PotionBottleLiquidEditor;\r\n}\r\n","export * from \"./PotionBottleLiquidEditor\";\r\n","import * as React from \"react\";\r\n\r\nimport ImageField from \"@/components/ImageField\";\r\nimport { useIdObjectResource } from \"@/services/package/hooks/use-idobject-resource\";\r\n\r\nexport interface PotionBottleMaskProps {\r\n  className?: string;\r\n  potionBottleId: string;\r\n}\r\n\r\nconst PotionBottleMask = ({\r\n  className,\r\n  potionBottleId,\r\n}: PotionBottleMaskProps) => {\r\n  const [iconResource, iconResourceName, onSetIcon] = useIdObjectResource(\r\n    \"potionBottles\",\r\n    potionBottleId,\r\n    \"bottleMask\"\r\n  );\r\n\r\n  return (\r\n    <ImageField\r\n      className={className}\r\n      imageResource={iconResource}\r\n      imageResourceName={iconResourceName}\r\n      onChange={onSetIcon}\r\n    />\r\n  );\r\n};\r\n\r\nexport default PotionBottleMask;\r\n","import PotionBottlePage from \"./PotionBottlePage\";\r\nexport default PotionBottlePage;\r\n","import * as React from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nimport history from \"@/history\";\r\n\r\nimport { packageIdObjectNew } from \"@/actions/packages/package-idobject-new\";\r\n\r\nimport { useSelector } from \"@/hooks/use-selector\";\r\n\r\nimport Page from \"@/components/Page\";\r\nimport Flow from \"@/components/Flow\";\r\nimport Button from \"@/components/Button\";\r\nimport EnsurePackageLoaded from \"@/components/EnsurePackageLoaded\";\r\n\r\nimport { packageIdObjectIdsSelector } from \"@/services/package/selectors/package\";\r\n\r\nimport Modal from \"@/components/Modal\";\r\nimport TextBox from \"@/components/TextBox\";\r\n\r\nconst PotionEffectsPage = () => {\r\n  const dispatch = useDispatch();\r\n  const { t } = useTranslation();\r\n  const potionEffectIds = useSelector((state) =>\r\n    packageIdObjectIdsSelector(state, \"potionEffects\")\r\n  );\r\n\r\n  const [newEffectId, setNewEffectId] = React.useState<string | null>(null);\r\n\r\n  const onRequestNewEffect = React.useCallback(() => {\r\n    setNewEffectId(\"\");\r\n  }, []);\r\n  const onCancelNewEffect = React.useCallback(() => {\r\n    setNewEffectId(null);\r\n  }, []);\r\n  const onNewPotionEffect = React.useCallback(() => {\r\n    setNewEffectId(null);\r\n    if (newEffectId != null && newEffectId.length > 0) {\r\n      dispatch(packageIdObjectNew(\"potionEffects\", newEffectId));\r\n      history.push(`/potion-effects/${newEffectId}`);\r\n    }\r\n  }, [newEffectId]);\r\n\r\n  return (\r\n    <>\r\n      <EnsurePackageLoaded />\r\n      <Page>\r\n        <Flow>\r\n          <ul>\r\n            {potionEffectIds.map((potionBaseId) => (\r\n              <li key={potionBaseId}>\r\n                <Link to={`/potion-effects/${potionBaseId}`}>\r\n                  {potionBaseId}\r\n                </Link>\r\n              </li>\r\n            ))}\r\n          </ul>\r\n          <Button variant=\"primary\" onClick={onRequestNewEffect}>\r\n            {t(\"potion_effect.new\")}\r\n          </Button>\r\n          <Modal\r\n            isOpen={newEffectId != null}\r\n            onRequestClose={onCancelNewEffect}\r\n          >\r\n            <p>{t(\"potion_effect.new_id_prompt\")}</p>\r\n            <div>\r\n              <TextBox\r\n                autoFocus\r\n                value={newEffectId!}\r\n                onChange={(e) => setNewEffectId(e.target.value)}\r\n              />\r\n            </div>\r\n            <div>\r\n              <Button\r\n                disabled={newEffectId == null || newEffectId == \"\"}\r\n                onClick={onNewPotionEffect}\r\n              >\r\n                {t(\"potion_effect.new\")}\r\n              </Button>\r\n            </div>\r\n          </Modal>\r\n        </Flow>\r\n      </Page>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default PotionEffectsPage;\r\n","import PotionBaseListPage from \"./PotionEffectListPage\";\r\nexport default PotionBaseListPage;\r\n","import * as React from \"react\";\r\nimport { RouteComponentProps } from \"react-router\";\r\nimport { Redirect } from \"react-router-dom\";\r\n\r\nimport { useSelector } from \"@/hooks/use-selector\";\r\n\r\nimport { packageIdObjectDataSelector } from \"@/services/package/selectors/package\";\r\n\r\nimport EnsurePackageLoaded from \"@/components/EnsurePackageLoaded\";\r\nimport Page from \"@/components/Page\";\r\n\r\nimport PotionEffectName from \"./components/PotionEffectName\";\r\nimport PotionEffectIcon from \"./components/PotionEffectIcon\";\r\nimport PotionEffectColor from \"./components/PotionEffectColor\";\r\n\r\nimport styles from \"./PotionEffectPage.module.css\";\r\n\r\ninterface PotionEffectPageParams {\r\n  potionEffectId: string;\r\n}\r\n\r\nconst PotionEffectPage = ({\r\n  match: {\r\n    params: { potionEffectId },\r\n  },\r\n}: RouteComponentProps<PotionEffectPageParams>) => {\r\n  const potionEffect = useSelector((state) =>\r\n    packageIdObjectDataSelector(state, \"potionEffects\", potionEffectId)\r\n  );\r\n\r\n  if (!potionEffect) {\r\n    return <Redirect to=\"/\" />;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <EnsurePackageLoaded />\r\n      <Page>\r\n        <div className={styles[\"potioneffect-content\"]}>\r\n          <PotionEffectName potionEffectId={potionEffectId} />\r\n          <PotionEffectIcon potionEffectId={potionEffectId} />\r\n          <PotionEffectColor potionEffectId={potionEffectId} />\r\n        </div>\r\n      </Page>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default PotionEffectPage;\r\n","import * as React from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useDispatch } from \"react-redux\";\r\n\r\nimport { useSelector } from \"@/hooks/use-selector\";\r\n\r\nimport { packageDataSetById } from \"@/actions/packages/package-data-set-byid\";\r\n\r\nimport { packageIdObjectDataSelector } from \"@/services/package/selectors/package\";\r\nimport FieldBox from \"@/components/FieldBox\";\r\nimport ColorButton from \"@/components/ColorButton\";\r\n\r\nimport styles from \"./PotionEffectColor.module.css\";\r\n\r\nexport interface PotionEffectColorProps {\r\n  potionEffectId: string;\r\n}\r\n\r\nconst PotionEffectColor = ({ potionEffectId }: PotionEffectColorProps) => {\r\n  const dispatch = useDispatch();\r\n  const { t } = useTranslation();\r\n\r\n  const potionEffect = useSelector((state) =>\r\n    packageIdObjectDataSelector(state, \"potionEffects\", potionEffectId)\r\n  );\r\n\r\n  const onColorChange = React.useCallback(\r\n    (color: string) => {\r\n      dispatch(\r\n        packageDataSetById(\r\n          \"potionEffects\",\r\n          potionEffectId,\r\n          \"potionColor\",\r\n          color\r\n        )\r\n      );\r\n    },\r\n    [potionEffectId]\r\n  );\r\n\r\n  if (!potionEffect) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <FieldBox\r\n      label={t(\"potion_effect.potion_color\")}\r\n      className={styles[\"potioncolor-button\"]}\r\n    >\r\n      <ColorButton\r\n        color={potionEffect.potionColor ?? \"#FFFFFF\"}\r\n        onChange={onColorChange}\r\n      />\r\n    </FieldBox>\r\n  );\r\n};\r\n\r\nexport default PotionEffectColor;\r\n","import PotionEffectColor from \"./PotionEffectColor\";\r\nexport default PotionEffectColor;\r\n","import * as React from \"react\";\r\nimport { useDispatch } from \"react-redux\";\r\n\r\nimport { extname } from \"@/paths\";\r\n\r\nimport { useSelector } from \"@/hooks/use-selector\";\r\n\r\nimport {\r\n  packageIdObjectDataSelector,\r\n  packageIdObjectResourceSelector,\r\n} from \"@/services/package/selectors/package\";\r\n\r\nimport { packageResourceSetById } from \"@/actions/packages/package-resource-set-byid\";\r\n\r\nimport ImageField from \"@/components/ImageField\";\r\n\r\nexport interface PotionEffectIconProps {\r\n  potionEffectId: string;\r\n}\r\n\r\nconst PotionEffectIcon = ({ potionEffectId }: PotionEffectIconProps) => {\r\n  const dispatch = useDispatch();\r\n\r\n  const potionEffect = useSelector((state) =>\r\n    packageIdObjectDataSelector(state, \"potionEffects\", potionEffectId)\r\n  );\r\n\r\n  const effectIcon = useSelector((state) =>\r\n    packageIdObjectResourceSelector(\r\n      state,\r\n      \"potionEffects\",\r\n      potionEffectId,\r\n      \"icon\"\r\n    )\r\n  );\r\n  const setEffectIcon = React.useCallback(\r\n    (image: Uint8Array, imageName: string) => {\r\n      dispatch(\r\n        packageResourceSetById(\r\n          \"potionEffects\",\r\n          potionEffectId,\r\n          \"icon\",\r\n          `${potionEffectId}/icon.${extname(imageName)}`,\r\n          image\r\n        )\r\n      );\r\n    },\r\n    [potionEffectId]\r\n  );\r\n\r\n  if (!potionEffect) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <ImageField\r\n      imageResource={effectIcon}\r\n      imageResourceName={potionEffect.name ?? null}\r\n      onChange={setEffectIcon}\r\n    />\r\n  );\r\n};\r\n\r\nexport default PotionEffectIcon;\r\n","import * as React from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useDispatch } from \"react-redux\";\r\n\r\nimport { useSelector } from \"@/hooks/use-selector\";\r\n\r\nimport { packageIdObjectDataSelector } from \"@/services/package/selectors/package\";\r\n\r\nimport { packageDataSetById } from \"@/actions/packages/package-data-set-byid\";\r\n\r\nimport CommitTextBox from \"@/components/CommitTextBox\";\r\n\r\nexport interface PotionEffectNameProps {\r\n  potionEffectId: string;\r\n}\r\n\r\nconst PotionEffectName = ({ potionEffectId }: PotionEffectNameProps) => {\r\n  const dispatch = useDispatch();\r\n  const { t } = useTranslation();\r\n\r\n  const potionEffect = useSelector((state) =>\r\n    packageIdObjectDataSelector(state, \"potionEffects\", potionEffectId)\r\n  );\r\n\r\n  const onSetName = React.useCallback(\r\n    (name: string) => {\r\n      dispatch(\r\n        packageDataSetById(\"potionEffects\", potionEffectId, \"name\", name)\r\n      );\r\n    },\r\n    [potionEffectId]\r\n  );\r\n\r\n  if (!potionEffect) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <CommitTextBox\r\n      value={potionEffect?.name ?? \"\"}\r\n      placeholder={t(\"potion_effect.name\")}\r\n      onCommit={onSetName}\r\n    />\r\n  );\r\n};\r\n\r\nexport default PotionEffectName;\r\n","import PotionEffectPage from \"./PotionEffectPage\";\r\nexport default PotionEffectPage;\r\n","export function extname(path: string): string {\r\n  const idx = path.lastIndexOf(\".\");\r\n  return idx === -1 || idx + 1 == path.length ? \"\" : path.substring(idx + 1);\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nimport { AppState, defaultAppState } from \"@/state\";\r\n\r\nimport servicesReducer from \"@/services/reducer\";\r\nimport { finalizeReducerList } from \"./utils\";\r\n\r\nconst finalizedReducer = finalizeReducerList(servicesReducer);\r\n\r\nexport default function reducer(\r\n  state: AppState = defaultAppState,\r\n  action: AnyAction\r\n): AppState {\r\n  return finalizedReducer(state, action);\r\n}\r\n","import { AppReducer } from \"./types\";\r\n\r\nexport const PRIORITY_PRE = -10;\r\nexport const PRIORITY_POST = 10;\r\n\r\nexport function reducerPriority(\r\n  priority: number,\r\n  reducer: AppReducer\r\n): AppReducer {\r\n  reducer.weight = priority;\r\n  return reducer;\r\n}\r\n\r\nexport function priorityBefore(reducer: AppReducer) {\r\n  return (reducer.weight ?? 0) - 1;\r\n}\r\n","import { AnyAction } from \"redux\";\r\nimport sortBy from \"lodash/sortBy\";\r\n\r\nimport { MaybeArray } from \"@/arrays\";\r\n\r\nimport { AppState, defaultAppState } from \"@/state\";\r\n\r\nimport { AppReducer } from \"./types\";\r\n\r\nexport function concatReducers(\r\n  ...reducers: MaybeArray<AppReducer>[]\r\n): AppReducer[] {\r\n  // Previously, this was reduceReducers and generated a reducer\r\n  //  that invokes each child reducer.\r\n  // However, we need to be able to order reducers across services,\r\n  //  so we must now aggregate a list of reducers and do a final ordering\r\n  //  step after all are collected.\r\n  return ([] as AppReducer[]).concat(...reducers);\r\n}\r\n\r\nexport function finalizeReducerList(reducers: AppReducer[]): AppReducer {\r\n  // Order the list by weight ascending.\r\n  const finalizedList = sortBy(reducers, (x: AppReducer) => x.weight || 0);\r\n\r\n  return (state: AppState = defaultAppState, action: AnyAction) => {\r\n    return finalizedList.reduce(\r\n      (state, reducer) => reducer(state, action),\r\n      state\r\n    );\r\n  };\r\n}\r\n","import * as React from \"react\";\r\n\r\nimport { Router } from \"react-router-dom\";\r\n\r\nimport { DndProvider } from \"react-dnd\";\r\nimport { HTML5Backend } from \"react-dnd-html5-backend\";\r\n\r\nimport I18NProvider from \"@/services/i18n/components/I18NProvider\";\r\n\r\nimport StoreProvider from \"@/store/components/StoreProvider\";\r\n\r\nimport history from \"@/history\";\r\nimport Routes from \"@/routes\";\r\n\r\nconst Root: React.FC = () => (\r\n  <I18NProvider>\r\n    <StoreProvider>\r\n      <Router history={history}>\r\n        <DndProvider backend={HTML5Backend}>\r\n          <Routes />\r\n        </DndProvider>\r\n      </Router>\r\n    </StoreProvider>\r\n  </I18NProvider>\r\n);\r\n\r\nexport default Root;\r\n","import * as React from \"react\";\r\n\r\nimport { Redirect, Route, Switch } from \"react-router-dom\";\r\n\r\nimport HomePage from \"./pages/home\";\r\nimport IngredientsListPage from \"./pages/ingredient-list\";\r\nimport PotionBaseMapEditorPage from \"./pages/potionbase-mapeditor\";\r\nimport PotionBaseListPage from \"./pages/potionbase-list\";\r\nimport PotionBasePage from \"./pages/potionbase\";\r\nimport PotionEffectPage from \"./pages/potioneffect\";\r\nimport PotionEffectListPage from \"./pages/potioneffect-list\";\r\nimport PotionBottleListPage from \"./pages/potionbottle-list\";\r\nimport PotionBottlePage from \"./pages/potionbottle\";\r\n\r\nconst Routes: React.FC = () => (\r\n  <Switch>\r\n    <Route path=\"/\" exact component={HomePage} />\r\n\r\n    <Route path=\"/ingredients\" exact component={IngredientsListPage} />\r\n\r\n    <Route path=\"/potion-bases\" exact component={PotionBaseListPage} />\r\n    <Route\r\n      path=\"/potion-bases/:potionBaseId\"\r\n      exact\r\n      component={PotionBasePage}\r\n    />\r\n    <Route\r\n      path=\"/potion-bases/:potionBaseId/map-editor\"\r\n      exact\r\n      component={PotionBaseMapEditorPage}\r\n    />\r\n\r\n    <Route path=\"/potion-effects\" exact component={PotionEffectListPage} />\r\n    <Route\r\n      path=\"/potion-effects/:potionEffectId\"\r\n      exact\r\n      component={PotionEffectPage}\r\n    />\r\n\r\n    <Route path=\"/potion-bottles\" exact component={PotionBottleListPage} />\r\n    <Route\r\n      path=\"/potion-bottles/:potionBottleId\"\r\n      exact\r\n      component={PotionBottlePage}\r\n    />\r\n\r\n    <Redirect to=\"/\" />\r\n  </Switch>\r\n);\r\n\r\nexport default Routes;\r\n","import platform from \"platform\";\r\n\r\nconst OS_WINDOWS = /windows/i;\r\nconst OS_MAC = /Mac|iOS|(OS\\ X)/;\r\nconst OS_LINUX = /linux/i;\r\n\r\nexport type OSType = \"windows\" | \"mac\" | \"linux\" | \"unknown\";\r\n\r\nconst osPlatform = (platform.os && platform.os.family) || \"unknown\";\r\nexport const OSType: OSType = OS_WINDOWS.test(osPlatform)\r\n  ? \"windows\"\r\n  : OS_MAC.test(osPlatform)\r\n  ? \"mac\"\r\n  : OS_LINUX.test(osPlatform)\r\n  ? \"linux\"\r\n  : \"unknown\";\r\n\r\nexport const isProd: boolean = process.env.NODE_ENV === \"production\";\r\n\r\nexport const keyboardModifierUseMeta = osPlatform === \"mac\";\r\n","import union from \"lodash/union\";\r\nimport difference from \"lodash/difference\";\r\n\r\nimport { ModifierKeys } from \"./modifier-keys\";\r\n\r\nexport type SelectionMode =\r\n  | \"set\"\r\n  | \"append\"\r\n  | \"remove\"\r\n  | \"toggle\"\r\n  | \"set-if-unselected\";\r\n\r\nexport function getSelectMode(\r\n  modifiers: ModifierKeys,\r\n  defaultMode: SelectionMode = \"set\"\r\n): SelectionMode {\r\n  if (modifiers.shiftKey && modifiers.ctrlMetaKey) {\r\n    return \"remove\";\r\n  }\r\n  if (modifiers.shiftKey) {\r\n    return \"append\";\r\n  }\r\n  if (modifiers.ctrlMetaKey) {\r\n    return \"toggle\";\r\n  }\r\n  return defaultMode;\r\n}\r\n\r\nexport function combineSelection(\r\n  selectedIds: string[],\r\n  chosenIds: string[],\r\n  mode: SelectionMode\r\n) {\r\n  switch (mode) {\r\n    case \"set\":\r\n      return chosenIds;\r\n    case \"set-if-unselected\": {\r\n      if (chosenIds.every((chosen) => selectedIds.indexOf(chosen) !== -1)) {\r\n        // All were selected.\r\n        return selectedIds;\r\n      }\r\n\r\n      // One wasn't selected, set it\r\n      return chosenIds;\r\n    }\r\n    case \"append\":\r\n      return union(selectedIds, chosenIds);\r\n    case \"remove\":\r\n      return difference(selectedIds, chosenIds);\r\n    case \"toggle\": {\r\n      return difference(selectedIds, chosenIds).concat(\r\n        difference(chosenIds, selectedIds)\r\n      );\r\n    }\r\n  }\r\n\r\n  return chosenIds;\r\n}\r\n\r\nexport function combineExtraniousSelection(\r\n  selectedIds: string[],\r\n  mode: SelectionMode\r\n) {\r\n  switch (mode) {\r\n    case \"append\":\r\n    case \"remove\":\r\n      return selectedIds;\r\n  }\r\n\r\n  return [];\r\n}\r\n","import { debounce, put } from \"redux-saga/effects\";\r\n\r\nimport { editorCommit } from \"@/actions/editors/commit\";\r\nimport { ACTION_EDITOR_COMMIT_QUEUE } from \"@/actions/editors/commit-queue\";\r\n\r\nexport default function* commitQueueSaga() {\r\n  yield debounce(1000, ACTION_EDITOR_COMMIT_QUEUE, doCommit);\r\n}\r\n\r\nfunction* doCommit() {\r\n  yield put(editorCommit());\r\n}\r\n","import commitQueueSaga from \"./commit-queue\";\r\n\r\nexport default commitQueueSaga;\r\n","import * as React from \"react\";\r\n\r\nimport { I18nextProvider } from \"react-i18next\";\r\n\r\nimport i18n from \"../i18n\";\r\n\r\nconst I18NProvider: React.FC = ({ children }) => (\r\n  <I18nextProvider i18n={i18n}>{children}</I18nextProvider>\r\n);\r\nexport default I18NProvider;\r\n","import i18n from \"i18next\";\r\nimport { initReactI18next } from \"react-i18next\";\r\n\r\nimport { isProd } from \"@/runtime-env\";\r\n\r\ni18n.use(initReactI18next).init({\r\n  fallbackLng: \"en\",\r\n\r\n  ns: [\"common\", \"potioncraft\"],\r\n  defaultNS: \"common\",\r\n\r\n  resources: {\r\n    en: {\r\n      common: require(\"@/translations/en/common.json\"),\r\n      potioncraft: require(\"@/translations/en/potioncraft.json\"),\r\n    },\r\n  },\r\n\r\n  debug: !isProd,\r\n\r\n  interpolation: {\r\n    escapeValue: false, // not needed for react!!\r\n  },\r\n\r\n  react: {\r\n    wait: true,\r\n  },\r\n});\r\n\r\nexport default i18n;\r\n","import { createStructuredSelector } from \"@/state\";\r\n\r\nimport { I18NState } from \"./state\";\r\nimport i18n from \"./i18n\";\r\nimport { currentLanguageSelector } from \"./selectors/language\";\r\n\r\nexport const persistState = createStructuredSelector({\r\n  language: currentLanguageSelector\r\n});\r\n\r\ntype PersistedState = ReturnType<typeof persistState>;\r\n\r\nexport function loadState(\r\n  state: I18NState,\r\n  persisted: PersistedState\r\n): I18NState {\r\n  i18n.changeLanguage(persisted.language);\r\n\r\n  return {\r\n    ...state,\r\n    ...persisted\r\n  };\r\n}\r\n","import setLanguageReducer from \"./set-language\";\r\n\r\nexport default setLanguageReducer;\r\n","import { Action } from \"redux\";\r\n\r\nimport { ACTION_SET_LANGUAGE, SetLanguageAction } from \"@/actions/set-language\";\r\n\r\nimport { I18NState, defaultI18NState } from \"../state\";\r\nimport { createI18nReducer } from \"../state-utils\";\r\n\r\nimport i18n from \"../i18n\";\r\n\r\nexport default createI18nReducer(function setLanguageReducer(\r\n  state: I18NState = defaultI18NState,\r\n  action: Action\r\n): I18NState {\r\n  if (action.type !== ACTION_SET_LANGUAGE) {\r\n    return state;\r\n  }\r\n\r\n  const lang = (action as SetLanguageAction).payload;\r\n\r\n  // TODO: Side effect should be in saga.\r\n  i18n.changeLanguage(lang);\r\n\r\n  return {\r\n    ...state,\r\n    language: lang,\r\n  };\r\n});\r\n","import { I18NState as I18nState } from \"../state\";\r\nimport { createI18nSelector } from \"../state-utils\";\r\n\r\nexport const currentLanguageSelector = createI18nSelector(\r\n  (state: I18nState) => state.language\r\n);\r\n","import {\r\n  createServiceReducerCreator,\r\n  createServiceSelectorCreator,\r\n} from \"../state-utils\";\r\n\r\nexport const createI18nReducer = createServiceReducerCreator(\"i18n\");\r\nexport const createI18nSelector = createServiceSelectorCreator(\"i18n\");\r\n","export interface I18NState {\r\n  language: string;\r\n}\r\n\r\nexport const defaultI18NState: Readonly<I18NState> = {\r\n  language: \"en\"\r\n};\r\nObject.freeze(defaultI18NState);\r\n","import { isMapEditorRenderedAction } from \"@/actions/map-editor/rendered\";\r\nimport { createEditorDamageReducer } from \"../state-utils\";\r\n\r\nexport default createEditorDamageReducer((state, action) => {\r\n  if (!isMapEditorRenderedAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  return {\r\n    ...state,\r\n    damageWorldRect: null,\r\n  };\r\n});\r\n","import { isMapEditorPanAction } from \"@/actions/map-editor/pan\";\r\nimport { isMapEditorViewportResizeAction } from \"@/actions/map-editor/viewport-resize\";\r\nimport { isMapEditorZoomAction } from \"@/actions/map-editor/zoom\";\r\nimport { createEditorDamageReducer } from \"../state-utils\";\r\n\r\nexport default createEditorDamageReducer((state, action, appState) => {\r\n  if (\r\n    !isMapEditorPanAction(action) &&\r\n    !isMapEditorZoomAction(action) &&\r\n    !isMapEditorViewportResizeAction(action)\r\n  ) {\r\n    return state;\r\n  }\r\n\r\n  return {\r\n    ...state,\r\n    damageWorldRect: {\r\n      p1: {\r\n        x: Number.NEGATIVE_INFINITY,\r\n        y: Number.NEGATIVE_INFINITY,\r\n      },\r\n      p2: {\r\n        x: Number.POSITIVE_INFINITY,\r\n        y: Number.POSITIVE_INFINITY,\r\n      },\r\n    },\r\n  };\r\n});\r\n","import { isMapEditorEntityDeleteAction } from \"@/actions/map-editor/entity-delete\";\r\nimport { addPointToRect } from \"@/geometry\";\r\nimport { PRIORITY_PRE, reducerPriority } from \"@/reducer/priorities\";\r\nimport { entityFromKeySelector } from \"@/services/map-editor/entities/selectors/entities\";\r\n\r\nimport { createEditorDamageReducer } from \"../state-utils\";\r\n\r\nexport default reducerPriority(\r\n  PRIORITY_PRE,\r\n  createEditorDamageReducer((state, action, appState) => {\r\n    if (!isMapEditorEntityDeleteAction(action)) {\r\n      return state;\r\n    }\r\n\r\n    const { entityKeys } = action.payload;\r\n\r\n    const damageRect = entityKeys.reduce((damageRect, entityKey) => {\r\n      const entity = entityFromKeySelector(appState, entityKey);\r\n      if (damageRect == null) {\r\n        return {\r\n          p1: { x: entity.x, y: entity.y },\r\n          p2: { x: entity.x, y: entity.y },\r\n        };\r\n      }\r\n      return addPointToRect(damageRect, entity);\r\n    }, state.damageWorldRect);\r\n\r\n    return {\r\n      ...state,\r\n      damageWorldRect: damageRect,\r\n    };\r\n  })\r\n);\r\n","import values from \"lodash/values\";\r\n\r\nimport { isMapEditorEntityInsertAction } from \"@/actions/map-editor/entity-insert\";\r\nimport { addPointToRect } from \"@/geometry\";\r\n\r\nimport { createEditorDamageReducer } from \"../state-utils\";\r\n\r\nexport default createEditorDamageReducer((state, action) => {\r\n  if (!isMapEditorEntityInsertAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  const { entities } = action.payload;\r\n\r\n  const damageRect = values(entities).reduce((damageRect, entity) => {\r\n    if (damageRect == null) {\r\n      return {\r\n        p1: { x: entity.x, y: entity.y },\r\n        p2: { x: entity.x, y: entity.y },\r\n      };\r\n    }\r\n    return addPointToRect(damageRect, entity);\r\n  }, state.damageWorldRect);\r\n\r\n  return {\r\n    ...state,\r\n    damageWorldRect: damageRect,\r\n  };\r\n});\r\n","import { addPointToRect } from \"@/geometry\";\r\n\r\nimport { PRIORITY_PRE, reducerPriority } from \"@/reducer/priorities\";\r\n\r\nimport { isMapEditorEntityOffsetAction } from \"@/actions/map-editor/entity-offset\";\r\n\r\nimport { entityFromKeySelector } from \"@/services/map-editor/entities/selectors/entities\";\r\n\r\nimport { createEditorDamageReducer } from \"../state-utils\";\r\n\r\nexport default reducerPriority(\r\n  PRIORITY_PRE,\r\n  createEditorDamageReducer((state, action, appState) => {\r\n    if (!isMapEditorEntityOffsetAction(action)) {\r\n      return state;\r\n    }\r\n\r\n    const { entityKeys, offsetX, offsetY } = action.payload;\r\n\r\n    const damageRect = entityKeys.reduce((damageRect, entityKey) => {\r\n      const entity = entityFromKeySelector(appState, entityKey);\r\n      if (damageRect == null) {\r\n        damageRect = {\r\n          p1: { x: entity.x, y: entity.y },\r\n          p2: { x: entity.x, y: entity.y },\r\n        };\r\n      } else {\r\n        damageRect = addPointToRect(damageRect, entity);\r\n      }\r\n\r\n      return addPointToRect(damageRect, {\r\n        x: entity.x + offsetX,\r\n        y: entity.y + offsetY,\r\n      });\r\n    }, state.damageWorldRect);\r\n\r\n    return {\r\n      ...state,\r\n      damageWorldRect: damageRect,\r\n    };\r\n  })\r\n);\r\n","import { isMapEditorEntityPrototypeInstantiateAction } from \"@/actions/map-editor/entity-prototype-instantiate\";\r\nimport { addPointToRect } from \"@/geometry\";\r\n\r\nimport { createEditorDamageReducer } from \"../state-utils\";\r\n\r\nexport default createEditorDamageReducer((state, action, appState) => {\r\n  if (!isMapEditorEntityPrototypeInstantiateAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  const { worldPos } = action.payload;\r\n\r\n  return {\r\n    ...state,\r\n    damageWorldRect: state.damageWorldRect\r\n      ? addPointToRect(state.damageWorldRect, worldPos)\r\n      : { p1: worldPos, p2: worldPos },\r\n  };\r\n});\r\n","import { concatReducers } from \"@/reducer/utils\";\r\n\r\nimport editorRenderedReducer from \"./editor-rendered\";\r\nimport editorViewportReducer from \"./editor-viewport\";\r\nimport entityDeleteReducer from \"./entity-delete\";\r\nimport entityInsertReducer from \"./entity-insert\";\r\nimport entityOffsetReducer from \"./entity-offset\";\r\nimport entityPrototypeInstantiateReducer from \"./entity-prototype-instantiate\";\r\nimport mapClearReducer from \"./map-clear\";\r\nimport mapImportTemplateReducer from \"./map-import-template\";\r\nimport mapReceiveReducer from \"./map-receive\";\r\nimport selectClearReducer from \"./select-clear\";\r\nimport selectEntityReducer from \"./select-entity\";\r\n\r\nexport default concatReducers(\r\n  editorRenderedReducer,\r\n  editorViewportReducer,\r\n  entityDeleteReducer,\r\n  entityInsertReducer,\r\n  entityOffsetReducer,\r\n  entityPrototypeInstantiateReducer,\r\n  mapClearReducer,\r\n  mapImportTemplateReducer,\r\n  mapReceiveReducer,\r\n  selectClearReducer,\r\n  selectEntityReducer\r\n);\r\n","import { isMapEditorMapClearAction } from \"@/actions/map-editor/map-clear\";\r\n\r\nimport { createEditorDamageReducer } from \"../state-utils\";\r\n\r\nexport default createEditorDamageReducer((state, action) => {\r\n  if (!isMapEditorMapClearAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  return {\r\n    ...state,\r\n    damageWorldRect: {\r\n      p1: {\r\n        x: Number.NEGATIVE_INFINITY,\r\n        y: Number.NEGATIVE_INFINITY,\r\n      },\r\n      p2: {\r\n        x: Number.POSITIVE_INFINITY,\r\n        y: Number.POSITIVE_INFINITY,\r\n      },\r\n    },\r\n  };\r\n});\r\n","import { isMapEditorMapImportTemplateAction } from \"@/actions/map-editor/map-import-template\";\r\n\r\nimport { createEditorDamageReducer } from \"../state-utils\";\r\n\r\nexport default createEditorDamageReducer((state, action) => {\r\n  if (!isMapEditorMapImportTemplateAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  return {\r\n    ...state,\r\n    damageWorldRect: {\r\n      p1: {\r\n        x: Number.NEGATIVE_INFINITY,\r\n        y: Number.NEGATIVE_INFINITY,\r\n      },\r\n      p2: {\r\n        x: Number.POSITIVE_INFINITY,\r\n        y: Number.POSITIVE_INFINITY,\r\n      },\r\n    },\r\n  };\r\n});\r\n","import { isMapEditorMapReceiveAction } from \"@/actions/map-editor/map-receive\";\r\nimport { createEditorDamageReducer } from \"../state-utils\";\r\n\r\nexport default createEditorDamageReducer((state, action, appState) => {\r\n  if (!isMapEditorMapReceiveAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  return {\r\n    ...state,\r\n    damageWorldRect: {\r\n      p1: {\r\n        x: Number.NEGATIVE_INFINITY,\r\n        y: Number.NEGATIVE_INFINITY,\r\n      },\r\n      p2: {\r\n        x: Number.POSITIVE_INFINITY,\r\n        y: Number.POSITIVE_INFINITY,\r\n      },\r\n    },\r\n  };\r\n});\r\n","import { addPointToRect } from \"@/geometry\";\r\n\r\nimport { PRIORITY_PRE, reducerPriority } from \"@/reducer/priorities\";\r\n\r\nimport { isMapEditorSelectClearAction } from \"@/actions/map-editor/select-clear\";\r\n\r\nimport { selectedEntityKeysSelector } from \"@/services/map-editor/selection/selectors/selection\";\r\nimport { entityFromKeySelector } from \"@/services/map-editor/entities/selectors/entities\";\r\n\r\nimport { createEditorDamageReducer } from \"../state-utils\";\r\n\r\nexport default reducerPriority(\r\n  PRIORITY_PRE,\r\n  createEditorDamageReducer((state, action, appState) => {\r\n    if (!isMapEditorSelectClearAction(action)) {\r\n      return state;\r\n    }\r\n\r\n    const selectedEntityKeys = selectedEntityKeysSelector(appState);\r\n\r\n    const damageRect = selectedEntityKeys.reduce((damageRect, entityKey) => {\r\n      const entity = entityFromKeySelector(appState, entityKey);\r\n      if (!entity) {\r\n        return damageRect;\r\n      }\r\n\r\n      if (damageRect == null) {\r\n        return {\r\n          p1: { x: entity.x, y: entity.y },\r\n          p2: { x: entity.x, y: entity.y },\r\n        };\r\n      } else {\r\n        return addPointToRect(damageRect, entity);\r\n      }\r\n    }, state.damageWorldRect);\r\n\r\n    return {\r\n      ...state,\r\n      damageWorldRect: damageRect,\r\n    };\r\n  })\r\n);\r\n","import { addPointToRect } from \"@/geometry\";\r\n\r\nimport { PRIORITY_PRE, reducerPriority } from \"@/reducer/priorities\";\r\n\r\nimport { isMapEditorSelectEntityAction } from \"@/actions/map-editor/select-entity\";\r\nimport { entityFromKeySelector } from \"@/services/map-editor/entities/selectors/entities\";\r\nimport { selectedEntityKeysSelector } from \"@/services/map-editor/selection/selectors/selection\";\r\n\r\nimport { createEditorDamageReducer } from \"../state-utils\";\r\n\r\nexport default reducerPriority(\r\n  PRIORITY_PRE,\r\n  createEditorDamageReducer((state, action, appState) => {\r\n    if (!isMapEditorSelectEntityAction(action)) {\r\n      return state;\r\n    }\r\n\r\n    const { entityKeys } = action.payload;\r\n\r\n    // Might need to re-render previously selected items to unselect them\r\n    const selectedEntityKeys = selectedEntityKeysSelector(appState);\r\n\r\n    let damageRect = selectedEntityKeys.reduce((damageRect, entityKey) => {\r\n      const entity = entityFromKeySelector(appState, entityKey);\r\n      if (!entity) {\r\n        return damageRect;\r\n      }\r\n\r\n      if (damageRect == null) {\r\n        return {\r\n          p1: { x: entity.x, y: entity.y },\r\n          p2: { x: entity.x, y: entity.y },\r\n        };\r\n      } else {\r\n        return addPointToRect(damageRect, entity);\r\n      }\r\n    }, state.damageWorldRect);\r\n\r\n    damageRect = entityKeys.reduce((damageRect, entityKey) => {\r\n      const entity = entityFromKeySelector(appState, entityKey);\r\n      if (!entity) {\r\n        return damageRect;\r\n      }\r\n\r\n      if (damageRect == null) {\r\n        return {\r\n          p1: { x: entity.x, y: entity.y },\r\n          p2: { x: entity.x, y: entity.y },\r\n        };\r\n      } else {\r\n        return addPointToRect(damageRect, entity);\r\n      }\r\n    }, damageRect);\r\n\r\n    return {\r\n      ...state,\r\n      damageWorldRect: damageRect,\r\n    };\r\n  })\r\n);\r\n","import { createEditorDamageSelector } from \"../state-utils\";\r\n\r\nexport const editorDamageRectSelector = createEditorDamageSelector(\r\n  (state) => state.damageWorldRect\r\n);\r\n","import {\r\n  createServiceReducerCreator,\r\n  createServiceSelectorCreator,\r\n} from \"@/services/state-utils\";\r\n\r\nexport const createEditorDamageReducer = createServiceReducerCreator(\r\n  \"mapEditor\",\r\n  \"damage\"\r\n);\r\nexport const createEditorDamageSelector = createServiceSelectorCreator(\r\n  \"mapEditor\",\r\n  \"damage\"\r\n);\r\n","import { Rectangle } from \"@/geometry\";\r\n\r\nexport interface EditorDamageState {\r\n  damageWorldRect: Rectangle | null;\r\n}\r\n\r\nconst _defaultState: EditorDamageState = {\r\n  damageWorldRect: null,\r\n};\r\n\r\nexport const defaultEditorDamageState = Object.freeze(_defaultState);\r\n","import omit from \"lodash/omit\";\r\n\r\nimport { isMapEditorEntityDeleteAction } from \"@/actions/map-editor/entity-delete\";\r\n\r\nimport { createMapEntitiesReducer } from \"../state-utils\";\r\nimport { removeFromRegionContainer } from \"../regions\";\r\n\r\nexport default createMapEntitiesReducer((state, action) => {\r\n  if (!isMapEditorEntityDeleteAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  const { entityKeys } = action.payload;\r\n\r\n  for (const entityKey of entityKeys) {\r\n    const entity = state.entitiesByKey[entityKey];\r\n    if (!entity) {\r\n      continue;\r\n    }\r\n    state = removeFromRegionContainer(state, entity, entityKey);\r\n  }\r\n\r\n  return {\r\n    ...state,\r\n    entitiesByKey: omit(state.entitiesByKey, entityKeys),\r\n  };\r\n});\r\n","import { isMapEditorEntityInsertAction } from \"@/actions/map-editor/entity-insert\";\r\n\r\nimport { addToRegionContainer } from \"../regions\";\r\n\r\nimport { createMapEntitiesReducer } from \"../state-utils\";\r\n\r\nexport default createMapEntitiesReducer((state, action) => {\r\n  if (!isMapEditorEntityInsertAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  const { entities } = action.payload;\r\n\r\n  for (const entityKey of Object.keys(entities)) {\r\n    const entity = entities[entityKey];\r\n    state = addToRegionContainer(state, entity, entityKey);\r\n  }\r\n\r\n  return {\r\n    ...state,\r\n    entitiesByKey: {\r\n      ...state.entitiesByKey,\r\n      ...entities,\r\n    },\r\n  };\r\n});\r\n","import mapValues from \"lodash/mapValues\";\r\n\r\nimport { pointAdd } from \"@/geometry\";\r\n\r\nimport { isMapEditorEntityOffsetAction } from \"@/actions/map-editor/entity-offset\";\r\n\r\nimport { createMapEntitiesReducer } from \"../state-utils\";\r\nimport { addToRegionContainer, removeFromRegionContainer } from \"../regions\";\r\n\r\nexport default createMapEntitiesReducer((state, action) => {\r\n  if (!isMapEditorEntityOffsetAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  const { entityKeys, offsetX, offsetY } = action.payload;\r\n  const offsetP = { x: offsetX, y: offsetY };\r\n\r\n  for (const entityKey of entityKeys) {\r\n    const entity = state.entitiesByKey[entityKey];\r\n    if (!entity) {\r\n      continue;\r\n    }\r\n    state = removeFromRegionContainer(state, entity, entityKey);\r\n    state = addToRegionContainer(state, pointAdd(entity, offsetP), entityKey);\r\n  }\r\n\r\n  return {\r\n    ...state,\r\n    entitiesByKey: mapValues(state.entitiesByKey, (entity, key) => {\r\n      if (!entityKeys.includes(key)) {\r\n        return entity;\r\n      }\r\n      return {\r\n        ...entity,\r\n        ...pointAdd(entity, offsetP),\r\n      };\r\n    }),\r\n  };\r\n});\r\n","import { concatReducers } from \"@/reducer/utils\";\r\n\r\nimport entityDeleteReducer from \"./entity-delete\";\r\nimport entityInsertReducer from \"./entity-insert\";\r\nimport entityOffsetReducer from \"./entity-offset\";\r\nimport mapClearReducer from \"./map-clear\";\r\nimport mapImportTemplateReducer from \"./map-import-template\";\r\nimport receiveMapConfigReducer from \"./map-receive\";\r\nimport prototypeInstantiateReducer from \"./prototype-instantiate\";\r\n\r\nexport default concatReducers(\r\n  entityDeleteReducer,\r\n  entityInsertReducer,\r\n  entityOffsetReducer,\r\n  mapClearReducer,\r\n  mapImportTemplateReducer,\r\n  receiveMapConfigReducer,\r\n  prototypeInstantiateReducer\r\n);\r\n","import { isMapEditorMapClearAction } from \"@/actions/map-editor/map-clear\";\r\n\r\nimport { defaultMapEntitiesState } from \"../state\";\r\nimport { createMapEntitiesReducer } from \"../state-utils\";\r\n\r\nexport default createMapEntitiesReducer((state, action) => {\r\n  if (!isMapEditorMapClearAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  return defaultMapEntitiesState;\r\n});\r\n","import { v4 as uuidV4 } from \"uuid\";\r\n\r\nimport { TemplatesByName } from \"@/map-templates\";\r\nimport { MapEntity } from \"@/map-config\";\r\n\r\nimport { isMapEditorMapImportTemplateAction } from \"@/actions/map-editor/map-import-template\";\r\n\r\nimport { createMapEntitiesReducer } from \"../state-utils\";\r\nimport { addToRegionContainer } from \"../regions\";\r\nimport { defaultMapEntitiesState } from \"../state\";\r\n\r\nexport default createMapEntitiesReducer((state, action) => {\r\n  if (!isMapEditorMapImportTemplateAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  const { templateId } = action.payload;\r\n\r\n  const entities = TemplatesByName[templateId];\r\n  if (!entities) {\r\n    return state;\r\n  }\r\n\r\n  const entitiesByKey: Record<string, MapEntity> = {};\r\n  for (let entity of entities) {\r\n    entitiesByKey[uuidV4()] = entity;\r\n  }\r\n\r\n  state = {\r\n    ...defaultMapEntitiesState,\r\n    entitiesByKey,\r\n  };\r\n\r\n  for (const entityKey of Object.keys(entitiesByKey)) {\r\n    const entity = entitiesByKey[entityKey];\r\n    state = addToRegionContainer(state, entity, entityKey);\r\n  }\r\n\r\n  return state;\r\n});\r\n","import { v4 as uuidV4 } from \"uuid\";\r\n\r\nimport { MapEntity } from \"@/map-config\";\r\n\r\nimport { isMapEditorMapReceiveAction } from \"@/actions/map-editor/map-receive\";\r\n\r\nimport { createMapEntitiesReducer } from \"../state-utils\";\r\nimport { addToRegionContainer } from \"../regions\";\r\nimport { defaultMapEntitiesState } from \"../state\";\r\n\r\nexport default createMapEntitiesReducer((state, action) => {\r\n  if (!isMapEditorMapReceiveAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  state = defaultMapEntitiesState;\r\n\r\n  const { entities } = action.payload;\r\n\r\n  const entitiesByKey: Record<string, MapEntity> = {};\r\n  for (let entity of entities) {\r\n    entitiesByKey[uuidV4()] = entity;\r\n  }\r\n\r\n  for (const entityKey of Object.keys(entitiesByKey)) {\r\n    const entity = entitiesByKey[entityKey];\r\n    state = addToRegionContainer(state, entity, entityKey);\r\n  }\r\n\r\n  return {\r\n    ...state,\r\n    entitiesByKey,\r\n  };\r\n});\r\n","import { isMapEditorEntityPrototypeInstantiateAction } from \"@/actions/map-editor/entity-prototype-instantiate\";\r\nimport { MapEntity } from \"@/map-config\";\r\nimport { addToRegionContainer } from \"../regions\";\r\n\r\nimport { createMapEntitiesReducer } from \"../state-utils\";\r\n\r\nexport default createMapEntitiesReducer((state, action) => {\r\n  if (!isMapEditorEntityPrototypeInstantiateAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  const { prototype, worldPos, entityKey: key } = action.payload;\r\n\r\n  const entity = {\r\n    ...prototype,\r\n    x: worldPos.x,\r\n    y: worldPos.y,\r\n  } as MapEntity;\r\n\r\n  state = addToRegionContainer(state, entity, key);\r\n\r\n  return {\r\n    ...state,\r\n    entitiesByKey: {\r\n      ...state.entitiesByKey,\r\n      [key]: entity,\r\n    },\r\n  };\r\n});\r\n","import { LargestEntityRadius } from \"@/entities\";\r\nimport { fpSet } from \"@/fp-set\";\r\nimport { Point, pointAdd, Rectangle } from \"@/geometry\";\r\n\r\nexport interface MapRegionContainer {\r\n  entityRegions: MapRegion[];\r\n  outOfBoundsRegion: MapRegion;\r\n}\r\n\r\nexport interface MapRegion {\r\n  entityKeys: string[];\r\n}\r\n\r\nconst MAP_WIDTH = 120;\r\nconst MAP_HEIGHT = 120;\r\nconst REGION_WIDTH = 10;\r\nconst REGION_HEIGHT = 10;\r\n\r\nconst ORIGIN_OFFSET: Point = { x: 60, y: 60 };\r\n\r\nexport const REGION_COUNT =\r\n  (MAP_WIDTH / REGION_WIDTH) * (MAP_HEIGHT / REGION_HEIGHT);\r\n\r\n// FIXME: Entities can be in multiple regions due to their hit radius.  Widen the point and return multiple region indexes from here.\r\nexport function getRegionIndexsFromPoint(p: Point): number[] {\r\n  const r = {\r\n    p1: {\r\n      x: p.x - LargestEntityRadius,\r\n      y: p.y - LargestEntityRadius,\r\n    },\r\n    p2: {\r\n      x: p.x + LargestEntityRadius,\r\n      y: p.y + LargestEntityRadius,\r\n    },\r\n  };\r\n\r\n  return getRegionIndexesFromRect(r);\r\n}\r\n\r\nexport function getEntityKeysFromPoint(\r\n  container: MapRegionContainer,\r\n  p: Point\r\n): string[] {\r\n  const regionIndexes = getRegionIndexsFromPoint(p);\r\n  const regionKeys: string[] = [];\r\n  regionIndexes.forEach((regionIndex) => {\r\n    if (regionIndex === -1) {\r\n      regionKeys.push(...container.outOfBoundsRegion.entityKeys);\r\n    } else {\r\n      regionKeys.push(...container.entityRegions[regionIndex].entityKeys);\r\n    }\r\n  });\r\n\r\n  return regionKeys;\r\n}\r\n\r\nexport function getRegionIndexesFromRect(r: Rectangle): number[] {\r\n  let { p1, p2 } = r;\r\n  p1 = pointAdd(p1, ORIGIN_OFFSET);\r\n  p2 = pointAdd(p2, ORIGIN_OFFSET);\r\n\r\n  let x1 = Math.floor((p1.x - LargestEntityRadius) / REGION_WIDTH);\r\n  let y1 = Math.floor((p1.y - LargestEntityRadius) / REGION_HEIGHT);\r\n  let x2 = Math.floor((p2.x + LargestEntityRadius) / REGION_WIDTH);\r\n  let y2 = Math.floor((p2.y + LargestEntityRadius) / REGION_HEIGHT);\r\n\r\n  const indexes = [];\r\n\r\n  let addedOOB = false;\r\n  const addOOB = () => {\r\n    if (addedOOB) {\r\n      return;\r\n    }\r\n    indexes.push(-1);\r\n    addedOOB = true;\r\n  };\r\n\r\n  if (x1 < 0) {\r\n    x1 = 0;\r\n    addOOB();\r\n  }\r\n\r\n  if (x2 < 0) {\r\n    x2 = 0;\r\n    addOOB();\r\n  }\r\n\r\n  if (x1 >= MAP_WIDTH / REGION_WIDTH) {\r\n    x1 = MAP_WIDTH / REGION_WIDTH - 1;\r\n    addOOB();\r\n  }\r\n\r\n  if (x2 >= MAP_WIDTH / REGION_WIDTH) {\r\n    x2 = MAP_WIDTH / REGION_WIDTH - 1;\r\n    addOOB();\r\n  }\r\n\r\n  if (y1 < 0) {\r\n    y1 = 0;\r\n    addOOB();\r\n  }\r\n\r\n  if (y2 < 0) {\r\n    y2 = 0;\r\n    addOOB();\r\n  }\r\n\r\n  if (y1 >= MAP_HEIGHT / REGION_HEIGHT) {\r\n    y1 = MAP_HEIGHT / REGION_HEIGHT - 1;\r\n    addOOB();\r\n  }\r\n\r\n  if (y2 >= MAP_HEIGHT / REGION_HEIGHT) {\r\n    y2 = MAP_HEIGHT / REGION_HEIGHT - 1;\r\n    addOOB();\r\n  }\r\n\r\n  for (let x = x1; x <= x2; x++) {\r\n    for (let y = y1; y <= y2; y++) {\r\n      indexes.push(x + y * (MAP_WIDTH / REGION_WIDTH));\r\n    }\r\n  }\r\n\r\n  return indexes;\r\n}\r\n\r\nexport function getEntityKeysFromRect(\r\n  container: MapRegionContainer,\r\n  r: Rectangle\r\n): string[] {\r\n  const regionIndexes = getRegionIndexesFromRect(r);\r\n  const regionKeys: string[] = [];\r\n  regionIndexes.forEach((regionIndex) => {\r\n    if (regionIndex === -1) {\r\n      regionKeys.push(...container.outOfBoundsRegion.entityKeys);\r\n    } else {\r\n      regionKeys.push(...container.entityRegions[regionIndex].entityKeys);\r\n    }\r\n  });\r\n\r\n  return regionKeys;\r\n}\r\n\r\nexport function addToRegionContainer<T extends MapRegionContainer>(\r\n  container: T,\r\n  p: Point,\r\n  entityKey: string\r\n) {\r\n  const regionIndexes = getRegionIndexsFromPoint(p);\r\n  return regionIndexes.reduce((container, regionIndex) => {\r\n    if (regionIndex === -1) {\r\n      return fpSet(container, \"outOfBoundsRegion\", (region) =>\r\n        addToRegion(region, entityKey)\r\n      );\r\n    } else {\r\n      return fpSet(container, \"entityRegions\", regionIndex, (region) =>\r\n        addToRegion(region, entityKey)\r\n      );\r\n    }\r\n  }, container);\r\n}\r\n\r\nexport function removeFromRegionContainer<T extends MapRegionContainer>(\r\n  container: T,\r\n  p: Point,\r\n  entityKey: string\r\n) {\r\n  const regionIndexes = getRegionIndexsFromPoint(p);\r\n  return regionIndexes.reduce((container, regionIndex) => {\r\n    if (regionIndex === -1) {\r\n      return fpSet(container, \"outOfBoundsRegion\", (region) =>\r\n        removeFromRegion(region, entityKey)\r\n      );\r\n    } else {\r\n      return fpSet(container, \"entityRegions\", regionIndex, (region) =>\r\n        removeFromRegion(region, entityKey)\r\n      );\r\n    }\r\n  }, container);\r\n}\r\n\r\nfunction addToRegion(region: MapRegion, entityKey: string): MapRegion {\r\n  return {\r\n    ...region,\r\n    entityKeys: [...region.entityKeys, entityKey],\r\n  };\r\n}\r\n\r\nfunction removeFromRegion(region: MapRegion, entityKey: string): MapRegion {\r\n  return {\r\n    ...region,\r\n    entityKeys: region.entityKeys.filter((x) => x !== entityKey),\r\n  };\r\n}\r\n","import { createSelector } from \"reselect\";\r\nimport { AppState } from \"@/state\";\r\nimport {\r\n  magnitude,\r\n  Point,\r\n  pointIntersectsRect,\r\n  pointSubtract,\r\n  Rectangle,\r\n} from \"@/geometry\";\r\nimport { EntityDefsByType } from \"@/entities\";\r\n\r\nimport { createMapEntitiesSelector } from \"../state-utils\";\r\nimport { MapEntitiesState } from \"../state\";\r\nimport { getEntityKeysFromPoint, getEntityKeysFromRect } from \"../regions\";\r\n\r\nexport const entitiesByKeySelector = createMapEntitiesSelector(\r\n  (state) => state.entitiesByKey\r\n);\r\n\r\nexport const entitityKeysSelector = createSelector(\r\n  entitiesByKeySelector,\r\n  (entitiesByKey) => Object.keys(entitiesByKey)\r\n);\r\n\r\nexport const entityFromKeySelector = (state: AppState, entityKey: string) =>\r\n  entitiesByKeySelector(state)[entityKey];\r\n\r\nexport const entityKeyAtPointSelector = createMapEntitiesSelector(\r\n  (state: MapEntitiesState, worldPoint: Point) => {\r\n    const regionKeys = getEntityKeysFromPoint(state, worldPoint);\r\n\r\n    const entitiesByKey = state.entitiesByKey;\r\n    for (const key of regionKeys) {\r\n      const entity = entitiesByKey[key];\r\n      const type = EntityDefsByType[entity.entityType];\r\n      if (!type) {\r\n        continue;\r\n      }\r\n\r\n      const vec = pointSubtract(worldPoint, entity);\r\n      if (magnitude(vec) <= type.hitRadius) {\r\n        return key;\r\n      }\r\n    }\r\n\r\n    return null;\r\n  }\r\n);\r\n\r\nexport const entityKeysAtPointSelector = (\r\n  state: AppState,\r\n  worldPoint: Point,\r\n  radius: number = 0,\r\n  ignoreHitRadius = false\r\n) => {\r\n  const mapEntitiesState = state.services.mapEditor.entities;\r\n  const r: Rectangle = {\r\n    p1: {\r\n      x: worldPoint.x - radius,\r\n      y: worldPoint.y - radius,\r\n    },\r\n    p2: {\r\n      x: worldPoint.x + radius,\r\n      y: worldPoint.y + radius,\r\n    },\r\n  };\r\n  const regionKeys = getEntityKeysFromRect(mapEntitiesState, r);\r\n  const result = [];\r\n  for (const entityKey of regionKeys) {\r\n    const entity = mapEntitiesState.entitiesByKey[entityKey];\r\n    const type = EntityDefsByType[entity.entityType];\r\n    if (!type) {\r\n      continue;\r\n    }\r\n\r\n    const vec = pointSubtract(worldPoint, entity);\r\n    if (magnitude(vec) <= (ignoreHitRadius ? 0 : type.hitRadius) + radius) {\r\n      result.push(entityKey);\r\n    }\r\n  }\r\n\r\n  return result;\r\n};\r\n\r\nexport const entityKeysAtRectSelector = (state: AppState, rect: Rectangle) => {\r\n  const mapEntitiesState = state.services.mapEditor.entities;\r\n  const regionKeys = getEntityKeysFromRect(mapEntitiesState, rect);\r\n\r\n  return regionKeys.filter((entityKey) =>\r\n    pointIntersectsRect(mapEntitiesState.entitiesByKey[entityKey], rect)\r\n  );\r\n};\r\n","import { createSelector } from \"reselect\";\r\n\r\nimport { AppState } from \"@/state\";\r\nimport { PotionEffectMapEntity } from \"@/map-config\";\r\n\r\nimport { packageIdObjectsSelector } from \"@/services/package/selectors/package\";\r\n\r\nimport { SpawnableEntityPrototype } from \"../types\";\r\n\r\nfunction potionEffectPrototype(\r\n  effect: string\r\n): SpawnableEntityPrototype<PotionEffectMapEntity> {\r\n  return {\r\n    i18nKey: `potioncraft:effects.${effect}`,\r\n    entityType: \"PotionEffect\",\r\n    effect,\r\n    angle: 0,\r\n  };\r\n}\r\n\r\nconst defaultPotionEffects = [\r\n  potionEffectPrototype(\"Crop\"),\r\n  potionEffectPrototype(\"Invisibility\"),\r\n  potionEffectPrototype(\"StoneSkin\"),\r\n  potionEffectPrototype(\"Growth\"),\r\n  potionEffectPrototype(\"SlowDown\"),\r\n  potionEffectPrototype(\"Sleep\"),\r\n  potionEffectPrototype(\"SharpVision\"),\r\n  potionEffectPrototype(\"Mana\"),\r\n  potionEffectPrototype(\"Lightning\"),\r\n  potionEffectPrototype(\"Hallucinations\"),\r\n  potionEffectPrototype(\"Fly\"),\r\n  potionEffectPrototype(\"Explosion\"),\r\n  potionEffectPrototype(\"Charm\"),\r\n  potionEffectPrototype(\"Berserker\"),\r\n  potionEffectPrototype(\"Light\"),\r\n  potionEffectPrototype(\"Libido\"),\r\n  potionEffectPrototype(\"Bounce\"),\r\n  potionEffectPrototype(\"Acid\"),\r\n  potionEffectPrototype(\"Fire\"),\r\n  potionEffectPrototype(\"Necromancy\"),\r\n  potionEffectPrototype(\"Frost\"),\r\n  potionEffectPrototype(\"Poison\"),\r\n  potionEffectPrototype(\"Healing\"),\r\n];\r\n\r\nexport const potionEffectEntityPrototypesSelector = createSelector(\r\n  (state: AppState) => packageIdObjectsSelector(state, \"potionEffects\"),\r\n  (potionEffects) => {\r\n    return [\r\n      ...defaultPotionEffects,\r\n      ...potionEffects.map((potionEffect) => ({\r\n        displayName: `${potionEffect.name} (${potionEffect.id})`,\r\n        entityType: \"PotionEffect\" as const,\r\n        effect: potionEffect.id,\r\n        angle: 0,\r\n      })),\r\n    ];\r\n  }\r\n);\r\n","import { Buffer } from \"buffer\";\r\nimport { createSelector } from \"reselect\";\r\n\r\nimport { AppState } from \"@/state\";\r\n\r\nimport { packageIdObjectsSelector } from \"@/services/package/selectors/package\";\r\nimport { packageResourcesSelector } from \"@/services/package/selectors/resources\";\r\n\r\nimport { RenderResources } from \"../types\";\r\n\r\nconst PotionEffectImages: Record<string, string> = {\r\n  \"potionEffect::Acid\": require(\"@/assets/PotionEffects/Acid.webp\"),\r\n  \"potionEffect::Berserker\": require(\"@/assets/PotionEffects/Berserker.webp\"),\r\n  \"potionEffect::Bounce\": require(\"@/assets/PotionEffects/Bounce.webp\"),\r\n  \"potionEffect::Charm\": require(\"@/assets/PotionEffects/Charm.webp\"),\r\n  \"potionEffect::Crop\": require(\"@/assets/PotionEffects/Crop.webp\"),\r\n  \"potionEffect::Explosion\": require(\"@/assets/PotionEffects/Explosion.webp\"),\r\n  \"potionEffect::Fire\": require(\"@/assets/PotionEffects/Fire.webp\"),\r\n  \"potionEffect::Fly\": require(\"@/assets/PotionEffects/Fly.webp\"),\r\n  \"potionEffect::Frost\": require(\"@/assets/PotionEffects/Frost.webp\"),\r\n  \"potionEffect::Growth\": require(\"@/assets/PotionEffects/Growth.webp\"),\r\n  \"potionEffect::Hallucinations\": require(\"@/assets/PotionEffects/Hallucinations.webp\"),\r\n  \"potionEffect::Healing\": require(\"@/assets/PotionEffects/Healing.webp\"),\r\n  \"potionEffect::Invisibility\": require(\"@/assets/PotionEffects/Invisibility.webp\"),\r\n  \"potionEffect::Libido\": require(\"@/assets/PotionEffects/Libido.webp\"),\r\n  \"potionEffect::Light\": require(\"@/assets/PotionEffects/Light.webp\"),\r\n  \"potionEffect::Lightning\": require(\"@/assets/PotionEffects/Lightning.webp\"),\r\n  \"potionEffect::Mana\": require(\"@/assets/PotionEffects/Mana.webp\"),\r\n  \"potionEffect::Necromancy\": require(\"@/assets/PotionEffects/Necromancy.webp\"),\r\n  \"potionEffect::Poison\": require(\"@/assets/PotionEffects/Poison.webp\"),\r\n  \"potionEffect::SharpVision\": require(\"@/assets/PotionEffects/SharpVision.webp\"),\r\n  \"potionEffect::Sleep\": require(\"@/assets/PotionEffects/Sleep.webp\"),\r\n  \"potionEffect::SlowDown\": require(\"@/assets/PotionEffects/SlowDown.webp\"),\r\n  \"potionEffect::StoneSkin\": require(\"@/assets/PotionEffects/StoneSkin.webp\"),\r\n};\r\n\r\nexport const renderResourcesSelector = createSelector(\r\n  (state: AppState) => packageIdObjectsSelector(state, \"potionEffects\"),\r\n  (state: AppState) => packageResourcesSelector(state),\r\n  (potionEffects, resources) => {\r\n    const renderResources: RenderResources = {\r\n      ...PotionEffectImages,\r\n    };\r\n\r\n    for (const effect of potionEffects) {\r\n      if (!effect.icon || !resources[effect.icon]) {\r\n        continue;\r\n      }\r\n\r\n      const effectIcon = resources[effect.icon];\r\n      const iconUrl = `data:image/png;base64,${Buffer.from(effectIcon).toString(\r\n        \"base64\"\r\n      )}`;\r\n      renderResources[`potionEffect::${effect.id}`] = iconUrl;\r\n    }\r\n\r\n    return renderResources;\r\n  }\r\n);\r\n","import {\r\n  createServiceReducerCreator,\r\n  createServiceSelectorCreator,\r\n} from \"@/services/state-utils\";\r\n\r\nexport const createMapEntitiesReducer = createServiceReducerCreator(\r\n  \"mapEditor\",\r\n  \"entities\"\r\n);\r\nexport const createMapEntitiesSelector = createServiceSelectorCreator(\r\n  \"mapEditor\",\r\n  \"entities\"\r\n);\r\n","import { MapEntity } from \"@/map-config\";\r\n\r\nimport { MapRegionContainer, REGION_COUNT } from \"./regions\";\r\n\r\nexport interface MapEntitiesState extends MapRegionContainer {\r\n  entitiesByKey: Record<string, MapEntity>;\r\n}\r\n\r\nconst defaultRegion = Object.freeze({\r\n  entityKeys: [],\r\n});\r\n\r\nconst _defaultState: MapEntitiesState = {\r\n  entitiesByKey: {},\r\n  entityRegions: new Array(REGION_COUNT).fill(defaultRegion),\r\n  outOfBoundsRegion: defaultRegion,\r\n};\r\n\r\nexport const defaultMapEntitiesState = Object.freeze(_defaultState);\r\n","import { concatReducers } from \"@/reducer/utils\";\r\n\r\nimport modifierkeysChangedReducer from \"./modifierkeys-changed\";\r\nimport mouseDownReducer from \"./mouse-down\";\r\nimport mouseMoveReducer from \"./mouse-move\";\r\nimport mouseOutReducer from \"./mouse-out\";\r\nimport mouseUpReducer from \"./mouse-up\";\r\nimport toolRadiusSetReducer from \"./tool-radius-set\";\r\nimport toolSetReducer from \"./tool-set\";\r\n\r\nexport default concatReducers(\r\n  modifierkeysChangedReducer,\r\n  mouseDownReducer,\r\n  mouseMoveReducer,\r\n  mouseOutReducer,\r\n  mouseUpReducer,\r\n  toolRadiusSetReducer,\r\n  toolSetReducer\r\n);\r\n","import { isMapEditorModifierKeysChangedAction } from \"@/actions/map-editor/modifierkeys-changed\";\r\nimport { createEditorMouseReducer } from \"../state-utils\";\r\n\r\nexport default createEditorMouseReducer((state, action) => {\r\n  if (!isMapEditorModifierKeysChangedAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  const { modifiers } = action.payload;\r\n\r\n  return {\r\n    ...state,\r\n    modifierKeys: modifiers,\r\n  };\r\n});\r\n","import { isMapEditorMouseDownAction } from \"@/actions/map-editor/mouse-down\";\r\n\r\nimport { createEditorMouseReducer } from \"../state-utils\";\r\n\r\nexport default createEditorMouseReducer((state, action) => {\r\n  if (!isMapEditorMouseDownAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  const { viewportPos, modifierKeys } = action.payload;\r\n\r\n  return {\r\n    ...state,\r\n    currentPointerGesture: modifierKeys.altKey ? \"pan\" : null,\r\n    mouseDownViewportPos: viewportPos,\r\n    mouseViewportPos: viewportPos,\r\n    modifierKeys,\r\n  };\r\n});\r\n","import { AnyAction } from \"redux\";\r\n\r\nimport { magnitude, pointAdd, pointSubtract } from \"@/geometry\";\r\nimport { getSelectMode } from \"@/selection-mode\";\r\nimport { fpSet } from \"@/fp-set\";\r\n\r\nimport { AppState, defaultAppState } from \"@/state\";\r\n\r\nimport rootReducer from \"@/reducer\";\r\n\r\nimport { generateTileEntities } from \"@/entities/tiles\";\r\n\r\nimport {\r\n  MapEditorMouseMoveAction,\r\n  isMapEditorMouseMoveAction,\r\n} from \"@/actions/map-editor/mouse-move\";\r\nimport { mapEditorSelectEntity } from \"@/actions/map-editor/select-entity\";\r\nimport { mapEditorPan } from \"@/actions/map-editor/pan\";\r\nimport { mapEditorEntityDelete } from \"@/actions/map-editor/entity-delete\";\r\nimport { mapEditorEntityInsert } from \"@/actions/map-editor/entity-insert\";\r\n\r\nimport { clientToWorldSelector } from \"@/services/map-editor/view/selectors/coordinate-mapping\";\r\nimport {\r\n  entityKeyAtPointSelector,\r\n  entityKeysAtPointSelector,\r\n} from \"@/services/map-editor/entities/selectors/entities\";\r\n\r\nimport { EditorMousePointerGesture, EditorMouseTool } from \"../state\";\r\n\r\nconst GESTURE_START_DISTANCE = 5;\r\n\r\nexport default function mouseMoveReducer(\r\n  state: AppState = defaultAppState,\r\n  action: AnyAction\r\n): AppState {\r\n  if (!isMapEditorMouseMoveAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  const { viewportPos, modifierKeys } = action.payload;\r\n\r\n  state = detectGestureReducer(state, action);\r\n\r\n  let { currentTool, currentPointerGesture } = state.services.mapEditor.mouse;\r\n\r\n  // Gestures take priority over tools, so holding alt can pan during tool usage.\r\n  if (currentPointerGesture) {\r\n    state = gestureReducer(state, action, currentPointerGesture);\r\n  } else {\r\n    state = toolReducer(state, action, currentTool);\r\n  }\r\n\r\n  state = fpSet(state, \"services\", \"mapEditor\", \"mouse\", (mouseState) => ({\r\n    ...mouseState,\r\n    mouseViewportPos: viewportPos,\r\n    modifierKeys,\r\n  }));\r\n\r\n  return state;\r\n}\r\n\r\nfunction detectGestureReducer(\r\n  state: AppState,\r\n  action: MapEditorMouseMoveAction\r\n): AppState {\r\n  const { viewportPos, modifierKeys } = action.payload;\r\n\r\n  const { mouseDownViewportPos, currentTool } = state.services.mapEditor.mouse;\r\n  let { currentPointerGesture } = state.services.mapEditor.mouse;\r\n\r\n  // If we are holding the mouse button with the pointer, determine the gesture.\r\n  if (\r\n    mouseDownViewportPos &&\r\n    currentTool == \"pointer\" &&\r\n    currentPointerGesture == null &&\r\n    magnitude(pointSubtract(mouseDownViewportPos, viewportPos)) >\r\n      GESTURE_START_DISTANCE\r\n  ) {\r\n    const mouseDownWorldPos = clientToWorldSelector(\r\n      state,\r\n      mouseDownViewportPos\r\n    );\r\n    const entityKeyAtMouse = entityKeyAtPointSelector(state, mouseDownWorldPos);\r\n\r\n    if (entityKeyAtMouse) {\r\n      const selectionMode = getSelectMode(modifierKeys, \"append\");\r\n      state = rootReducer(\r\n        state,\r\n        mapEditorSelectEntity(entityKeyAtMouse, selectionMode)\r\n      );\r\n      currentPointerGesture = \"drag-move\";\r\n    } else {\r\n      currentPointerGesture = \"drag-select\";\r\n    }\r\n  }\r\n\r\n  state = fpSet(\r\n    state,\r\n    \"services\",\r\n    \"mapEditor\",\r\n    \"mouse\",\r\n    \"currentPointerGesture\",\r\n    currentPointerGesture\r\n  );\r\n\r\n  return state;\r\n}\r\n\r\nfunction gestureReducer(\r\n  state: AppState,\r\n  action: MapEditorMouseMoveAction,\r\n  currentGesture: EditorMousePointerGesture\r\n): AppState {\r\n  switch (currentGesture) {\r\n    case \"pan\":\r\n      return panGestureReducer(state, action);\r\n  }\r\n\r\n  return state;\r\n}\r\n\r\nfunction panGestureReducer(\r\n  state: AppState,\r\n  action: MapEditorMouseMoveAction\r\n): AppState {\r\n  let previousPos = state.services.mapEditor.mouse.mouseViewportPos;\r\n  if (!previousPos) {\r\n    return state;\r\n  }\r\n\r\n  previousPos = clientToWorldSelector(state, previousPos);\r\n  const currentPos = clientToWorldSelector(state, action.payload.viewportPos);\r\n  const offset = pointSubtract(previousPos, currentPos);\r\n  return rootReducer(state, mapEditorPan(offset.x, -offset.y));\r\n}\r\n\r\nfunction toolReducer(\r\n  state: AppState,\r\n  action: MapEditorMouseMoveAction,\r\n  currentTool: EditorMouseTool\r\n): AppState {\r\n  const { mouseDownViewportPos } = state.services.mapEditor.mouse;\r\n  if (mouseDownViewportPos == null) {\r\n    // Mouse is not held\r\n    return state;\r\n  }\r\n\r\n  switch (currentTool) {\r\n    case \"eraser\":\r\n      return eraserReducer(state, action);\r\n    case \"paint-danger-zone\":\r\n      return paintDangerZoneReducer(state, action);\r\n  }\r\n\r\n  return state;\r\n}\r\n\r\nfunction eraserReducer(\r\n  state: AppState,\r\n  action: MapEditorMouseMoveAction\r\n): AppState {\r\n  const { viewportPos } = action.payload;\r\n  const { toolRadius } = state.services.mapEditor.mouse;\r\n  const worldPoint = clientToWorldSelector(state, viewportPos);\r\n  const keys = entityKeysAtPointSelector(state, worldPoint, toolRadius);\r\n  return rootReducer(state, mapEditorEntityDelete(keys));\r\n}\r\n\r\nfunction paintDangerZoneReducer(\r\n  state: AppState,\r\n  action: MapEditorMouseMoveAction\r\n) {\r\n  const { viewportPos } = action.payload;\r\n  const { toolRadius } = state.services.mapEditor.mouse;\r\n  const worldPoint = clientToWorldSelector(state, viewportPos);\r\n  const keys = entityKeysAtPointSelector(state, worldPoint, toolRadius, true);\r\n\r\n  state = rootReducer(state, mapEditorEntityDelete(keys));\r\n\r\n  const p1 = pointSubtract(worldPoint, { x: toolRadius, y: toolRadius });\r\n  const p2 = pointAdd(worldPoint, { x: toolRadius, y: toolRadius });\r\n  const entities = generateTileEntities(\"danger-zone\", { p1, p2 }).filter(\r\n    (entity) => {\r\n      const vec = pointSubtract(entity, worldPoint);\r\n      if (magnitude(vec) >= toolRadius) {\r\n        return false;\r\n      }\r\n      return true;\r\n    }\r\n  );\r\n\r\n  state = rootReducer(state, mapEditorEntityInsert(entities));\r\n  return state;\r\n}\r\n","import { isMapEditorMouseOutAction } from \"@/actions/map-editor/mouse-out\";\r\n\r\nimport { defaultEditorMouseServiceState } from \"../state\";\r\nimport { createEditorMouseReducer } from \"../state-utils\";\r\n\r\nexport default createEditorMouseReducer((state, action) => {\r\n  if (!isMapEditorMouseOutAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  return defaultEditorMouseServiceState;\r\n});\r\n","import { AnyAction } from \"redux\";\r\n\r\nimport { fpSet } from \"@/fp-set\";\r\nimport { AppState, defaultAppState } from \"@/state\";\r\nimport { getSelectMode } from \"@/selection-mode\";\r\nimport { normalizeRectangle, pointSubtract } from \"@/geometry\";\r\n\r\nimport rootReducer from \"@/reducer\";\r\n\r\nimport {\r\n  MapEditorMouseUpAction,\r\n  isMapEditorMouseUpAction,\r\n} from \"@/actions/map-editor/mouse-up\";\r\nimport { mapEditorSelectEntity } from \"@/actions/map-editor/select-entity\";\r\nimport { mapEditorSelectClear } from \"@/actions/map-editor/select-clear\";\r\nimport { mapEditorEntityOffset } from \"@/actions/map-editor/entity-offset\";\r\n\r\nimport {\r\n  entityKeyAtPointSelector,\r\n  entityKeysAtRectSelector,\r\n} from \"@/services/map-editor/entities/selectors/entities\";\r\nimport { clientToWorldSelector } from \"@/services/map-editor/view/selectors/coordinate-mapping\";\r\n\r\nexport default function mouseUpReducer(\r\n  state: AppState = defaultAppState,\r\n  action: AnyAction\r\n): AppState {\r\n  if (!isMapEditorMouseUpAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  const { modifierKeys, viewportPos } = action.payload;\r\n\r\n  const mouseState = state.services.mapEditor.mouse;\r\n\r\n  switch (mouseState.currentPointerGesture) {\r\n    case \"drag-select\":\r\n      state = completeDragSelect(state, action);\r\n      break;\r\n    case \"drag-move\":\r\n      state = completeDragMove(state, action);\r\n      break;\r\n    default:\r\n      state = completeClick(state, action);\r\n      break;\r\n  }\r\n\r\n  return fpSet(state, \"services\", \"mapEditor\", \"mouse\", (mouseState) => ({\r\n    ...mouseState,\r\n    currentPointerGesture: null,\r\n    mouseDownViewportPos: null,\r\n    mouseViewportPos: viewportPos,\r\n    modifierKeys,\r\n  }));\r\n}\r\n\r\nfunction completeDragSelect(\r\n  state: AppState,\r\n  action: MapEditorMouseUpAction\r\n): AppState {\r\n  const { viewportPos, modifierKeys } = action.payload;\r\n\r\n  const { mouseDownViewportPos } = state.services.mapEditor.mouse;\r\n  if (!mouseDownViewportPos) {\r\n    return state;\r\n  }\r\n\r\n  const worldMouseDownPos = clientToWorldSelector(state, mouseDownViewportPos);\r\n  const worldMouseUpPos = clientToWorldSelector(state, viewportPos);\r\n\r\n  const selectionRect = normalizeRectangle(worldMouseDownPos, worldMouseUpPos);\r\n\r\n  const idsToSelect = entityKeysAtRectSelector(state, selectionRect);\r\n\r\n  const mode = getSelectMode(modifierKeys);\r\n  return rootReducer(state, mapEditorSelectEntity(idsToSelect, mode));\r\n}\r\n\r\nfunction completeDragMove(\r\n  state: AppState,\r\n  action: MapEditorMouseUpAction\r\n): AppState {\r\n  const selectedEntityKeys =\r\n    state.services.mapEditor.selection.selectedEntityKeys;\r\n  if (selectedEntityKeys.length === 0) {\r\n    return state;\r\n  }\r\n\r\n  const { viewportPos } = action.payload;\r\n\r\n  const { mouseDownViewportPos } = state.services.mapEditor.mouse;\r\n  if (!mouseDownViewportPos) {\r\n    return state;\r\n  }\r\n\r\n  const worldMouseDownPos = clientToWorldSelector(state, mouseDownViewportPos);\r\n  const worldMouseUpPos = clientToWorldSelector(state, viewportPos);\r\n\r\n  const offset = pointSubtract(worldMouseUpPos, worldMouseDownPos);\r\n\r\n  return rootReducer(\r\n    state,\r\n    mapEditorEntityOffset(selectedEntityKeys, offset.x, offset.y)\r\n  );\r\n}\r\n\r\nfunction completeClick(\r\n  state: AppState,\r\n  action: MapEditorMouseUpAction\r\n): AppState {\r\n  const { viewportPos, modifierKeys } = action.payload;\r\n\r\n  const worldPos = clientToWorldSelector(state, viewportPos);\r\n  const selectedKey = entityKeyAtPointSelector(state, worldPos);\r\n\r\n  const mode = getSelectMode(modifierKeys);\r\n\r\n  if (selectedKey != null) {\r\n    return rootReducer(state, mapEditorSelectEntity(selectedKey, mode));\r\n  } else if (mode === \"set\") {\r\n    return rootReducer(state, mapEditorSelectClear());\r\n  }\r\n\r\n  return state;\r\n}\r\n","import { isMapEditorToolRadiusSetAction } from \"@/actions/map-editor/tool-radius-set\";\r\n\r\nimport { createEditorMouseReducer } from \"../state-utils\";\r\n\r\nexport default createEditorMouseReducer((state, action) => {\r\n  if (!isMapEditorToolRadiusSetAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  const { radius } = action.payload;\r\n\r\n  if (radius <= 0) {\r\n    return state;\r\n  }\r\n\r\n  return {\r\n    ...state,\r\n    toolRadius: radius,\r\n  };\r\n});\r\n","import { isMapEditorToolSetAction } from \"@/actions/map-editor/tool-set\";\r\nimport { createEditorMouseReducer } from \"../state-utils\";\r\n\r\nexport default createEditorMouseReducer((state, action) => {\r\n  if (!isMapEditorToolSetAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  const { tool } = action.payload;\r\n\r\n  return {\r\n    ...state,\r\n    currentTool: tool,\r\n  };\r\n});\r\n","import { pointSubtract } from \"@/geometry\";\r\nimport { AppState } from \"@/state\";\r\nimport { createSelector } from \"reselect\";\r\nimport {\r\n  worldMouseDownPosSelector,\r\n  worldMousePosSelector,\r\n} from \"./world-coords\";\r\n\r\nexport const dragMoveOffsetSelector = createSelector(\r\n  (state: AppState) => state.services.mapEditor.mouse.currentPointerGesture,\r\n  worldMousePosSelector,\r\n  worldMouseDownPosSelector,\r\n  (currentGesture, worldMousePos, worldMouseDownPos) => {\r\n    if (\r\n      currentGesture !== \"drag-move\" ||\r\n      !worldMousePos ||\r\n      !worldMouseDownPos\r\n    ) {\r\n      return null;\r\n    }\r\n\r\n    return pointSubtract(worldMousePos, worldMouseDownPos);\r\n  }\r\n);\r\n","import { createSelector } from \"reselect\";\r\n\r\nimport { normalizeRectangle } from \"@/geometry\";\r\n\r\nimport { createEditorMouseSelector } from \"../state-utils\";\r\nimport { EditorMouseServiceState } from \"../state\";\r\n\r\nexport const dragSelectionRectSelector = createEditorMouseSelector(\r\n  createSelector(\r\n    (state: EditorMouseServiceState) =>\r\n      state.currentPointerGesture == \"drag-select\" &&\r\n      state.mouseDownViewportPos,\r\n    (state: EditorMouseServiceState) =>\r\n      state.currentPointerGesture == \"drag-select\" && state.mouseViewportPos,\r\n    (dragStart, dragEnd) => {\r\n      if (dragStart && dragEnd) {\r\n        return normalizeRectangle(dragStart, dragEnd);\r\n      } else {\r\n        return null;\r\n      }\r\n    }\r\n  )\r\n);\r\n","import { AppState } from \"@/state\";\r\nimport { createEditorMouseSelector } from \"../state-utils\";\r\n\r\nexport const currentToolSelector = createEditorMouseSelector((state) => {\r\n  if (state.currentPointerGesture !== null) {\r\n    return \"pointer\" as const;\r\n  }\r\n\r\n  if (state.mouseDownViewportPos == null && state.modifierKeys.altKey) {\r\n    return \"pointer\" as const;\r\n  }\r\n\r\n  return state.currentTool;\r\n});\r\n\r\nexport const toolRadiusSelector = createEditorMouseSelector(\r\n  (state) => state.toolRadius\r\n);\r\n\r\nexport const toolViewportRadiusSelector = (state: AppState) => {\r\n  const radius = toolRadiusSelector(state);\r\n  return radius * state.services.mapEditor.view.zoomFactor;\r\n};\r\n","import { createEditorMouseSelector } from \"../state-utils\";\r\n\r\nexport const viewportMousePosSelector = createEditorMouseSelector(\r\n  (state) => state.mouseViewportPos\r\n);\r\n","import { clientToWorld } from \"@/services/map-editor/view/utils\";\r\nimport { AppState } from \"@/state\";\r\n\r\nexport const worldMousePosSelector = (state: AppState) => {\r\n  const mouseViewportPos = state.services.mapEditor.mouse.mouseViewportPos;\r\n  if (!mouseViewportPos) {\r\n    return null;\r\n  }\r\n  return clientToWorld(\r\n    mouseViewportPos,\r\n    state.services.mapEditor.view.offsetX,\r\n    state.services.mapEditor.view.offsetY,\r\n    state.services.mapEditor.view.zoomFactor\r\n  );\r\n};\r\n\r\nexport const worldMouseDownPosSelector = (state: AppState) => {\r\n  const mouseDownViewportPos =\r\n    state.services.mapEditor.mouse.mouseDownViewportPos;\r\n  if (!mouseDownViewportPos) {\r\n    return null;\r\n  }\r\n  return clientToWorld(\r\n    mouseDownViewportPos,\r\n    state.services.mapEditor.view.offsetX,\r\n    state.services.mapEditor.view.offsetY,\r\n    state.services.mapEditor.view.zoomFactor\r\n  );\r\n};\r\n","import {\r\n  createServiceReducerCreator,\r\n  createServiceSelectorCreator,\r\n} from \"@/services/state-utils\";\r\n\r\nexport const createEditorMouseReducer = createServiceReducerCreator(\r\n  \"mapEditor\",\r\n  \"mouse\"\r\n);\r\nexport const createEditorMouseSelector = createServiceSelectorCreator(\r\n  \"mapEditor\",\r\n  \"mouse\"\r\n);\r\n","import { Point } from \"@/geometry\";\r\nimport { ModifierKeys, MODIFIER_KEYS_NONE } from \"@/modifier-keys\";\r\n\r\nexport type EditorMouseTool = \"pointer\" | \"eraser\" | \"paint-danger-zone\";\r\nexport type EditorMousePointerGesture = \"pan\" | \"drag-select\" | \"drag-move\";\r\n\r\nexport interface EditorMouseServiceState {\r\n  currentTool: EditorMouseTool;\r\n  toolRadius: number;\r\n  currentPointerGesture: null | EditorMousePointerGesture;\r\n  mouseDownViewportPos: Point | null;\r\n  mouseViewportPos: Point | null;\r\n  modifierKeys: ModifierKeys;\r\n}\r\n\r\nconst _defaultState: EditorMouseServiceState = {\r\n  currentTool: \"pointer\",\r\n  toolRadius: 2,\r\n  currentPointerGesture: null,\r\n  mouseDownViewportPos: null,\r\n  mouseViewportPos: null,\r\n  modifierKeys: MODIFIER_KEYS_NONE,\r\n};\r\n\r\nexport const defaultEditorMouseServiceState = Object.freeze(_defaultState);\r\n","import { concatReducers } from \"@/reducer/utils\";\r\n\r\nimport editorDamageReducer from \"../damage/reducer\";\r\nimport editorEntitiesReducer from \"../entities/reducer\";\r\nimport editorMouseReducer from \"../mouse/reducer\";\r\nimport editorSelectionReducer from \"../selection/reducer\";\r\nimport editorViewReducer from \"../view/reducer\";\r\n\r\nimport mapEditorMapEditReducer from \"./mapeditor-map-edit\";\r\nimport packageNewReducer from \"./package-new\";\r\nimport packageReceiveReducer from \"./package-receive\";\r\n\r\nexport default concatReducers(\r\n  editorDamageReducer,\r\n  editorEntitiesReducer,\r\n  editorMouseReducer,\r\n  editorSelectionReducer,\r\n  editorViewReducer,\r\n\r\n  mapEditorMapEditReducer,\r\n  packageNewReducer,\r\n  packageReceiveReducer\r\n);\r\n","import { isPotionBaseMapEditAction } from \"@/actions/potion-bases/map-edit\";\r\nimport { PRIORITY_PRE, reducerPriority } from \"@/reducer/priorities\";\r\n\r\nimport { defaultMapEditorState } from \"../state\";\r\nimport { createMapEditorReducer } from \"../state-utils\";\r\n\r\nexport default reducerPriority(\r\n  PRIORITY_PRE,\r\n  createMapEditorReducer((state, action) => {\r\n    if (!isPotionBaseMapEditAction(action)) {\r\n      return state;\r\n    }\r\n\r\n    const { potionBaseId } = action.payload;\r\n\r\n    return {\r\n      ...defaultMapEditorState,\r\n      potionBaseId,\r\n    };\r\n  })\r\n);\r\n","import { isPackageNewAction } from \"@/actions/packages/package-new\";\r\n\r\nimport { PRIORITY_PRE, reducerPriority } from \"@/reducer/priorities\";\r\n\r\nimport { defaultMapEditorState } from \"../state\";\r\nimport { createMapEditorReducer } from \"../state-utils\";\r\n\r\nexport default reducerPriority(\r\n  PRIORITY_PRE,\r\n  createMapEditorReducer((state, action) => {\r\n    if (!isPackageNewAction(action)) {\r\n      return state;\r\n    }\r\n\r\n    return defaultMapEditorState;\r\n  })\r\n);\r\n","import { isPackageReceiveAction } from \"@/actions/packages/package-receive\";\r\n\r\nimport { PRIORITY_PRE, reducerPriority } from \"@/reducer/priorities\";\r\n\r\nimport { defaultMapEditorState } from \"../state\";\r\nimport { createMapEditorReducer } from \"../state-utils\";\r\n\r\nexport default reducerPriority(\r\n  PRIORITY_PRE,\r\n  createMapEditorReducer((state, action) => {\r\n    if (!isPackageReceiveAction(action)) {\r\n      return state;\r\n    }\r\n\r\n    return defaultMapEditorState;\r\n  })\r\n);\r\n","import { put, select, takeLatest } from \"redux-saga/effects\";\r\nimport values from \"lodash/values\";\r\n\r\nimport {\r\n  ACTION_EDITOR_COMMIT,\r\n  EditorCommitAction,\r\n} from \"@/actions/editors/commit\";\r\nimport { packageDataSetById } from \"@/actions/packages/package-data-set-byid\";\r\n\r\nimport { entitiesByKeySelector } from \"../entities/selectors/entities\";\r\n\r\nimport { editingPotionIdSelector } from \"../selectors\";\r\n\r\nexport default function* editorCommitSaga() {\r\n  yield takeLatest(ACTION_EDITOR_COMMIT, handleEditorCommit);\r\n}\r\n\r\nfunction* handleEditorCommit(action: EditorCommitAction) {\r\n  const potionId: ReturnType<typeof editingPotionIdSelector> = yield select(\r\n    editingPotionIdSelector\r\n  );\r\n  if (potionId == null) {\r\n    return;\r\n  }\r\n\r\n  const entities: ReturnType<typeof entitiesByKeySelector> = yield select(\r\n    entitiesByKeySelector\r\n  );\r\n\r\n  yield put(\r\n    packageDataSetById(\"potionBases\", potionId, \"mapEntities\", values(entities))\r\n  );\r\n}\r\n","import { fork } from \"redux-saga/effects\";\r\n\r\nimport editorCommitSaga from \"./editor-commit\";\r\nimport mapModifySaga from \"./map-modify\";\r\nimport mapEditorMapEditSaga from \"./mapeditor-map-edit\";\r\n\r\nexport default function* mapEditorSaga() {\r\n  yield fork(editorCommitSaga);\r\n  yield fork(mapModifySaga);\r\n  yield fork(mapEditorMapEditSaga);\r\n}\r\n","import { put, takeLatest } from \"redux-saga/effects\";\r\n\r\nimport { ACTION_MAPEDITOR_ENTITY_DELETE } from \"@/actions/map-editor/entity-delete\";\r\nimport { ACTION_MAPEDITOR_ENTITY_INSERT } from \"@/actions/map-editor/entity-insert\";\r\nimport { ACTION_MAPEDITOR_ENTITY_OFFSET } from \"@/actions/map-editor/entity-offset\";\r\nimport { ACTION_MAPEDITOR_ENTITY_PROTOTYPE_INSTANTIATE } from \"@/actions/map-editor/entity-prototype-instantiate\";\r\nimport { ACTION_MAPEDITOR_MAP_CLEAR } from \"@/actions/map-editor/map-clear\";\r\nimport { ACTION_MAPEDITOR_MAP_IMPORT_TEMPLATE } from \"@/actions/map-editor/map-import-template\";\r\nimport { ACTION_MAPEDITOR_SELECTION_DELETE } from \"@/actions/map-editor/selection-delete\";\r\n\r\nimport { editorCommitQueue } from \"@/actions/editors/commit-queue\";\r\n\r\nconst MapModifyActions = [\r\n  ACTION_MAPEDITOR_ENTITY_DELETE,\r\n  ACTION_MAPEDITOR_ENTITY_INSERT,\r\n  ACTION_MAPEDITOR_ENTITY_OFFSET,\r\n  ACTION_MAPEDITOR_ENTITY_PROTOTYPE_INSTANTIATE,\r\n  ACTION_MAPEDITOR_MAP_CLEAR,\r\n  ACTION_MAPEDITOR_MAP_IMPORT_TEMPLATE,\r\n  ACTION_MAPEDITOR_SELECTION_DELETE,\r\n];\r\n\r\nexport default function* mapModifySaga() {\r\n  yield takeLatest(MapModifyActions, handleMapModified);\r\n}\r\n\r\nfunction* handleMapModified() {\r\n  yield put(editorCommitQueue());\r\n}\r\n","import { put, select, takeLatest } from \"redux-saga/effects\";\r\nimport find from \"lodash/find\";\r\n\r\nimport history from \"@/history\";\r\n\r\nimport {\r\n  ACTION_POTIONBASE_MAP_EDIT,\r\n  PotionBaseMapEditAction,\r\n} from \"@/actions/potion-bases/map-edit\";\r\n\r\nimport { packageDataSelector } from \"@/services/package/selectors/package\";\r\nimport { CruciblePackage } from \"@/services/package/types\";\r\nimport { mapEditorMapReceive } from \"@/actions/map-editor/map-receive\";\r\n\r\nexport default function* mapEditorMapEditSaga() {\r\n  yield takeLatest(ACTION_POTIONBASE_MAP_EDIT, handleMapEdit);\r\n}\r\n\r\nfunction* handleMapEdit(action: PotionBaseMapEditAction) {\r\n  const { potionBaseId } = action.payload;\r\n\r\n  const pkg: CruciblePackage | null = yield select(packageDataSelector);\r\n  if (!pkg) {\r\n    return;\r\n  }\r\n\r\n  const potionBase = find(pkg.potionBases ?? [], (p) => p.id === potionBaseId);\r\n  if (!potionBase) {\r\n    return;\r\n  }\r\n\r\n  yield put(mapEditorMapReceive(potionBase.mapEntities ?? []));\r\n\r\n  const path = `/potion-bases/${potionBaseId}/map-editor`;\r\n  if (history.location.pathname !== path) {\r\n    history.push(path);\r\n  }\r\n}\r\n","import { isMapEditorEntityDeleteAction } from \"@/actions/map-editor/entity-delete\";\r\nimport { createEditorSelectionReducer } from \"../state-utils\";\r\n\r\nexport default createEditorSelectionReducer((state, action) => {\r\n  if (!isMapEditorEntityDeleteAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  const { entityKeys } = action.payload;\r\n\r\n  return {\r\n    ...state,\r\n    selectedEntityKeys: state.selectedEntityKeys.filter(\r\n      (x) => !entityKeys.includes(x)\r\n    ),\r\n  };\r\n});\r\n","import { concatReducers } from \"@/reducer/utils\";\r\n\r\nimport entityDeleteReducer from \"./entity-delete\";\r\nimport selectClearReducer from \"./select-clear\";\r\nimport selectEntityReducer from \"./select-entity\";\r\nimport selectionDeleteReducer from \"./selection-delete\";\r\n\r\nexport default concatReducers(\r\n  entityDeleteReducer,\r\n  selectClearReducer,\r\n  selectEntityReducer,\r\n  selectionDeleteReducer\r\n);\r\n","import { AnyAction } from \"redux\";\r\n\r\nimport { isMapEditorSelectClearAction } from \"@/actions/map-editor/select-clear\";\r\n\r\nimport { defaultEditorSelectionState, EditorSelectionState } from \"../state\";\r\nimport { createEditorSelectionReducer } from \"../state-utils\";\r\n\r\nexport default createEditorSelectionReducer(function selectClearReducer(\r\n  state: EditorSelectionState = defaultEditorSelectionState,\r\n  action: AnyAction\r\n): EditorSelectionState {\r\n  if (!isMapEditorSelectClearAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  return {\r\n    ...state,\r\n    selectedEntityKeys: [],\r\n  };\r\n});\r\n","import { AnyAction } from \"redux\";\r\n\r\nimport { isMapEditorSelectEntityAction } from \"@/actions/map-editor/select-entity\";\r\nimport { combineSelection } from \"@/selection-mode\";\r\n\r\nimport { defaultEditorSelectionState, EditorSelectionState } from \"../state\";\r\nimport { createEditorSelectionReducer } from \"../state-utils\";\r\n\r\nexport default createEditorSelectionReducer(function selectEntityReducer(\r\n  state: EditorSelectionState = defaultEditorSelectionState,\r\n  action: AnyAction\r\n): EditorSelectionState {\r\n  if (!isMapEditorSelectEntityAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  const { entityKeys, mode } = action.payload;\r\n  return {\r\n    ...state,\r\n    selectedEntityKeys: combineSelection(\r\n      state.selectedEntityKeys,\r\n      entityKeys,\r\n      mode\r\n    ),\r\n  };\r\n});\r\n","import { AnyAction } from \"redux\";\r\n\r\nimport { AppState, defaultAppState } from \"@/state\";\r\n\r\nimport { isMapEditorSelectionDeleteAction } from \"@/actions/map-editor/selection-delete\";\r\nimport { mapEditorEntityDelete } from \"@/actions/map-editor/entity-delete\";\r\n\r\nimport rootReducer from \"@/reducer\";\r\n\r\nexport default function selectionDeleteReducer(\r\n  state: AppState = defaultAppState,\r\n  action: AnyAction\r\n): AppState {\r\n  if (!isMapEditorSelectionDeleteAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  const selectedEntityKeys =\r\n    state.services.mapEditor.selection.selectedEntityKeys;\r\n\r\n  if (selectedEntityKeys.length === 0) {\r\n    return state;\r\n  }\r\n\r\n  return rootReducer(state, mapEditorEntityDelete(selectedEntityKeys));\r\n}\r\n","import { EditorSelectionState } from \"../state\";\r\nimport { createEditorSelectionSelector } from \"../state-utils\";\r\n\r\nexport const isEntitySelectedSelector = createEditorSelectionSelector(\r\n  (s: EditorSelectionState, entityKey: string) =>\r\n    s.selectedEntityKeys.includes(entityKey)\r\n);\r\n\r\nexport const selectedEntityKeysSelector = createEditorSelectionSelector(\r\n  (s: EditorSelectionState) => s.selectedEntityKeys\r\n);\r\n","import {\r\n  createServiceReducerCreator,\r\n  createServiceSelectorCreator,\r\n} from \"@/services/state-utils\";\r\n\r\nexport const createEditorSelectionReducer = createServiceReducerCreator(\r\n  \"mapEditor\",\r\n  \"selection\"\r\n);\r\nexport const createEditorSelectionSelector = createServiceSelectorCreator(\r\n  \"mapEditor\",\r\n  \"selection\"\r\n);\r\n","export interface EditorSelectionState {\r\n  selectedEntityKeys: string[];\r\n}\r\n\r\nconst _defaultState: EditorSelectionState = {\r\n  selectedEntityKeys: [],\r\n};\r\n\r\nexport const defaultEditorSelectionState = Object.freeze(_defaultState);\r\n","import { createMapEditorSelector } from \"./state-utils\";\r\n\r\nexport const editingPotionIdSelector = createMapEditorSelector(\r\n  (s) => s.potionBaseId\r\n);\r\n","import {\r\n  createServiceReducerCreator,\r\n  createServiceSelectorCreator,\r\n} from \"../state-utils\";\r\n\r\nexport const createMapEditorReducer = createServiceReducerCreator(\"mapEditor\");\r\nexport const createMapEditorSelector =\r\n  createServiceSelectorCreator(\"mapEditor\");\r\n","import { EditorDamageState, defaultEditorDamageState } from \"./damage/state\";\r\nimport { MapEntitiesState, defaultMapEntitiesState } from \"./entities/state\";\r\nimport {\r\n  EditorMouseServiceState,\r\n  defaultEditorMouseServiceState,\r\n} from \"./mouse/state\";\r\nimport {\r\n  EditorSelectionState,\r\n  defaultEditorSelectionState,\r\n} from \"./selection/state\";\r\nimport { EditorViewState, defaultEditorViewState } from \"./view/state\";\r\n\r\nexport interface MapEditorState {\r\n  potionBaseId: string | null;\r\n  damage: EditorDamageState;\r\n  entities: MapEntitiesState;\r\n  mouse: EditorMouseServiceState;\r\n  selection: EditorSelectionState;\r\n  view: EditorViewState;\r\n}\r\n\r\nconst _defaultState: MapEditorState = {\r\n  potionBaseId: null,\r\n  damage: defaultEditorDamageState,\r\n  entities: defaultMapEntitiesState,\r\n  mouse: defaultEditorMouseServiceState,\r\n  selection: defaultEditorSelectionState,\r\n  view: defaultEditorViewState,\r\n};\r\n\r\nexport const defaultMapEditorState = Object.freeze(_defaultState);\r\n","import * as React from \"react\";\r\n\r\nimport { Point } from \"@/geometry\";\r\n\r\nimport { useSelector } from \"@/hooks/use-selector\";\r\n\r\nimport {\r\n  editorOffsetXSelector,\r\n  editorOffsetYSelector,\r\n  editorZoomFactorSelector,\r\n} from \"../selectors/view\";\r\nimport { clientToWorld } from \"../utils\";\r\n\r\nexport function useClientToWorld() {\r\n  const offsetX = useSelector(editorOffsetXSelector);\r\n  const offsetY = useSelector(editorOffsetYSelector);\r\n  const zoomFactor = useSelector(editorZoomFactorSelector);\r\n\r\n  return React.useCallback(\r\n    (p: Point) => clientToWorld(p, offsetX, offsetY, zoomFactor),\r\n    [offsetX, offsetY, zoomFactor]\r\n  );\r\n}\r\n","import { concatReducers } from \"@/reducer/utils\";\r\n\r\nimport panReducer from \"./pan\";\r\nimport viewportResizeReducer from \"./viewport-resize\";\r\nimport zoomReducer from \"./zoom\";\r\n\r\nexport default concatReducers(panReducer, viewportResizeReducer, zoomReducer);\r\n","import { AnyAction } from \"redux\";\r\n\r\nimport { isMapEditorPanAction } from \"@/actions/map-editor/pan\";\r\n\r\nimport { defaultEditorViewState, EditorViewState } from \"../state\";\r\nimport { createEditorViewReducer } from \"../state-utils\";\r\n\r\nexport default createEditorViewReducer(function panReducer(\r\n  state: EditorViewState = defaultEditorViewState,\r\n  action: AnyAction\r\n): EditorViewState {\r\n  if (!isMapEditorPanAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  const { x, y } = action.payload;\r\n\r\n  return {\r\n    ...state,\r\n    offsetX: state.offsetX + x,\r\n    offsetY: state.offsetY + y,\r\n  };\r\n});\r\n","import { AnyAction } from \"redux\";\r\n\r\nimport { isMapEditorViewportResizeAction } from \"@/actions/map-editor/viewport-resize\";\r\n\r\nimport { defaultEditorViewState, EditorViewState } from \"../state\";\r\nimport { createEditorViewReducer } from \"../state-utils\";\r\n\r\nexport default createEditorViewReducer(function viewportResizeReducer(\r\n  state: EditorViewState = defaultEditorViewState,\r\n  action: AnyAction\r\n): EditorViewState {\r\n  if (!isMapEditorViewportResizeAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  const { height, width } = action.payload;\r\n\r\n  let zoomFactor = state.zoomFactor;\r\n  if (state.viewportWidth === 0) {\r\n    zoomFactor = Math.min(width, height) / 120;\r\n  }\r\n\r\n  return {\r\n    ...state,\r\n    viewportWidth: width,\r\n    viewportHeight: height,\r\n    zoomFactor,\r\n  };\r\n});\r\n","import { AnyAction } from \"redux\";\r\n\r\nimport { AppState, defaultAppState } from \"@/state\";\r\nimport { fpSet } from \"@/fp-set\";\r\nimport { pointSubtract } from \"@/geometry\";\r\n\r\nimport rootReducer from \"@/reducer\";\r\n\r\nimport { worldMousePosSelector } from \"@/services/map-editor/mouse/selectors/world-coords\";\r\n\r\nimport { isMapEditorZoomAction } from \"@/actions/map-editor/zoom\";\r\nimport { mapEditorPan } from \"@/actions/map-editor/pan\";\r\n\r\nexport default function zoomReducer(\r\n  state: AppState = defaultAppState,\r\n  action: AnyAction\r\n): AppState {\r\n  if (!isMapEditorZoomAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  const { zoomFactor } = action.payload;\r\n\r\n  const worldMousePos = worldMousePosSelector(state);\r\n\r\n  state = fpSet(\r\n    state,\r\n    \"services\",\r\n    \"mapEditor\",\r\n    \"view\",\r\n    \"zoomFactor\",\r\n    zoomFactor\r\n  );\r\n\r\n  const newMousePos = worldMousePosSelector(state);\r\n\r\n  if (worldMousePos != null && newMousePos != null) {\r\n    const offset = pointSubtract(worldMousePos, newMousePos);\r\n    state = rootReducer(state, mapEditorPan(offset.x, -offset.y));\r\n  }\r\n\r\n  return state;\r\n}\r\n","import { Point } from \"@/geometry\";\r\n\r\nimport { EditorViewState } from \"../state\";\r\nimport { createEditorViewSelector } from \"../state-utils\";\r\n\r\nimport { clientToWorld, worldToClient } from \"../utils\";\r\n\r\nexport const clientToWorldSelector = createEditorViewSelector(\r\n  (s: EditorViewState, p: Point) =>\r\n    clientToWorld(p, s.offsetX, s.offsetY, s.zoomFactor)\r\n);\r\n\r\nexport const worldToClientSelector = createEditorViewSelector(\r\n  (s: EditorViewState, p: Point) =>\r\n    worldToClient(p, s.offsetX, s.offsetY, s.zoomFactor)\r\n);\r\n","import { createEditorViewSelector } from \"../state-utils\";\r\n\r\nexport const editorOffsetXSelector = createEditorViewSelector((s) => s.offsetX);\r\nexport const editorOffsetYSelector = createEditorViewSelector((s) => s.offsetY);\r\n\r\nexport const editorZoomFactorSelector = createEditorViewSelector(\r\n  (s) => s.zoomFactor\r\n);\r\n","import { createEditorViewSelector } from \"../state-utils\";\r\n\r\nexport const editorViewportWidthSelector = createEditorViewSelector(\r\n  (s) => s.viewportWidth\r\n);\r\nexport const editorViewportHeightSelector = createEditorViewSelector(\r\n  (s) => s.viewportHeight\r\n);\r\n","import {\r\n  createServiceReducerCreator,\r\n  createServiceSelectorCreator,\r\n} from \"@/services/state-utils\";\r\n\r\nexport const createEditorViewReducer = createServiceReducerCreator(\r\n  \"mapEditor\",\r\n  \"view\"\r\n);\r\nexport const createEditorViewSelector = createServiceSelectorCreator(\r\n  \"mapEditor\",\r\n  \"view\"\r\n);\r\n","export interface EditorViewState {\r\n  viewportWidth: number;\r\n  viewportHeight: number;\r\n  offsetX: number;\r\n  offsetY: number;\r\n  zoomFactor: number;\r\n}\r\n\r\nconst _defaultState: EditorViewState = {\r\n  viewportWidth: 0,\r\n  viewportHeight: 0,\r\n  offsetX: 0,\r\n  offsetY: 0,\r\n  zoomFactor: 1,\r\n};\r\n\r\nexport const defaultEditorViewState = Object.freeze(_defaultState);\r\n","import { Point } from \"@/geometry\";\r\n\r\nexport const worldToClient = (\r\n  p: Point,\r\n  offsetX: number,\r\n  offsetY: number,\r\n  zoomFactor: number\r\n) => ({\r\n  x: (p.x - offsetX + 60) * zoomFactor,\r\n  y: (-p.y - offsetY + 60) * zoomFactor,\r\n});\r\n\r\nexport const clientToWorld = (\r\n  p: Point,\r\n  offsetX: number,\r\n  offsetY: number,\r\n  zoomFactor: number\r\n) => ({\r\n  x: p.x / zoomFactor - 60 + offsetX,\r\n  y: (p.y / zoomFactor - 60 + offsetY) * -1,\r\n});\r\n","import navtreeExpandedSetReducer from \"./navtree-expanded-set\";\r\n\r\nexport default navtreeExpandedSetReducer;\r\n","import { isNavtreeExpandedValuesSetAction } from \"@/actions/navigation/navtree-expanded-set\";\r\n\r\nimport { createNavigationReducer } from \"../state-utils\";\r\n\r\nexport default createNavigationReducer((state, action) => {\r\n  if (!isNavtreeExpandedValuesSetAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  return {\r\n    ...state,\r\n    expandedNavTreeValues: action.payload.expandedValues,\r\n  };\r\n});\r\n","import { createNavigationSelector } from \"./state-utils\";\r\n\r\nexport const navtreeExpandedValuesSelector = createNavigationSelector(\r\n  (state) => state.expandedNavTreeValues\r\n);\r\n","import {\r\n  createServiceReducerCreator,\r\n  createServiceSelectorCreator,\r\n} from \"../state-utils\";\r\n\r\nexport const createNavigationReducer =\r\n  createServiceReducerCreator(\"navigation\");\r\nexport const createNavigationSelector =\r\n  createServiceSelectorCreator(\"navigation\");\r\n","export interface NavigationState {\r\n  expandedNavTreeValues: string[];\r\n}\r\n\r\nconst _defaultState: NavigationState = {\r\n  expandedNavTreeValues: [\"home\"],\r\n};\r\n\r\nexport const defaultNavigationState = Object.freeze(_defaultState);\r\n","import * as React from \"react\";\r\nimport { useDispatch } from \"react-redux\";\r\n\r\nimport { extname } from \"@/paths\";\r\nimport { StringKeysOf } from \"@/object-utils\";\r\n\r\nimport { useSelector } from \"@/hooks/use-selector\";\r\n\r\nimport { packageResourceSetById } from \"@/actions/packages/package-resource-set-byid\";\r\n\r\nimport {\r\n  packageIdObjectDataSelector,\r\n  packageIdObjectResourceSelector,\r\n} from \"../selectors/package\";\r\nimport {\r\n  CruciblePackageSectionItem,\r\n  CruciblePackageSectionKey,\r\n} from \"../types\";\r\n\r\n// TODO: Move to utilities.\r\n\r\nexport function useIdObjectResource<T extends CruciblePackageSectionKey>(\r\n  objectType: T,\r\n  objectId: string,\r\n  resourceKey: StringKeysOf<CruciblePackageSectionItem<T>>\r\n): [\r\n  Uint8Array | null,\r\n  string | null,\r\n  (image: Uint8Array, imageName: string) => void\r\n] {\r\n  const dispatch = useDispatch();\r\n  const idObject = useSelector((state) =>\r\n    packageIdObjectDataSelector(state, objectType, objectId)\r\n  );\r\n\r\n  const currentValue = idObject != null ? idObject[resourceKey] : null;\r\n\r\n  return [\r\n    useSelector(\r\n      (state) =>\r\n        packageIdObjectResourceSelector(\r\n          state,\r\n          objectType,\r\n          objectId,\r\n          resourceKey\r\n        ) as any\r\n    ),\r\n    currentValue as any,\r\n    React.useCallback(\r\n      (image: Uint8Array, imageName: string) => {\r\n        dispatch(\r\n          packageResourceSetById(\r\n            objectType,\r\n            objectId,\r\n            resourceKey,\r\n            `${objectId}/${resourceKey}.${extname(imageName)}`,\r\n            image\r\n          )\r\n        );\r\n      },\r\n      [objectId]\r\n    ),\r\n  ];\r\n}\r\n","import * as React from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\n\r\nimport { packageLoadFile } from \"@/actions/packages/package-load-file\";\r\n\r\nimport {\r\n  packageLoadErrorSelector,\r\n  packageLoadStatusSelector,\r\n} from \"../selectors/package\";\r\n\r\nexport interface UseLoadMapConfig {\r\n  loadStatus: \"idle\" | \"loading\" | \"loaded\" | \"error\";\r\n  loadError: string | null;\r\n  onLoadPackage(file: File): void;\r\n}\r\n\r\nexport default function useLoadPackage(): UseLoadMapConfig {\r\n  const dispatch = useDispatch();\r\n  const loadStatus = useSelector(packageLoadStatusSelector);\r\n  const loadError = useSelector(packageLoadErrorSelector);\r\n  const onLoadPackage = React.useCallback(\r\n    (file: File) => {\r\n      dispatch(packageLoadFile(file));\r\n    },\r\n    [dispatch]\r\n  );\r\n  return {\r\n    loadStatus,\r\n    loadError,\r\n    onLoadPackage,\r\n  };\r\n}\r\n","import { concatReducers } from \"@/reducer/utils\";\r\n\r\nimport packageDataSetByIdReducer from \"./package-data-set-byid\";\r\nimport packageDataSetReducer from \"./package-data-set\";\r\nimport packageIdObjectNewReducer from \"./package-idobject-new\";\r\nimport packageLoadErrorReducer from \"./package-load-error\";\r\nimport packageLoadFileReducer from \"./package-load-file\";\r\nimport packageNewReducer from \"./package-new\";\r\nimport packageReceiveReducer from \"./package-receive\";\r\nimport packageResourceSetById from \"./package-resource-set-byid\";\r\n\r\nexport default concatReducers(\r\n  packageDataSetByIdReducer,\r\n  packageDataSetReducer,\r\n  packageIdObjectNewReducer,\r\n  packageLoadErrorReducer,\r\n  packageLoadFileReducer,\r\n  packageNewReducer,\r\n  packageReceiveReducer,\r\n  packageResourceSetById\r\n);\r\n","import findIndex from \"lodash/findIndex\";\r\n\r\nimport { fpSetByArray } from \"@/fp-set\";\r\nimport { Encoder } from \"@/text-encoding\";\r\nimport { stringifyYaml } from \"@/services/yaml/api\";\r\n\r\nimport { isPackageDataSetByIdAction } from \"@/actions/packages/package-data-set-byid\";\r\n\r\nimport { createPackageReducer } from \"../state-utils\";\r\nimport { packageDataSelector } from \"../selectors/package\";\r\n\r\nexport default createPackageReducer((state, action) => {\r\n  if (!isPackageDataSetByIdAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  const { sectionKey, id, path, data } = action.payload;\r\n\r\n  if (state.loadingStatus != \"loaded\") {\r\n    return state;\r\n  }\r\n\r\n  const packageData = packageDataSelector.local(state);\r\n  if (!packageData) {\r\n    return state;\r\n  }\r\n\r\n  const index = findIndex(packageData[sectionKey], (x) => x.id === id);\r\n  if (index == -1) {\r\n    // Should we try to make a new one?\r\n    return state;\r\n  }\r\n\r\n  const newPackageData = fpSetByArray(\r\n    packageData,\r\n    [sectionKey, index, ...path],\r\n    data\r\n  );\r\n  const newPackgeStr = stringifyYaml(newPackageData);\r\n  const newPackageResource = Encoder.encode(newPackgeStr);\r\n  return {\r\n    ...state,\r\n    resources: {\r\n      ...state.resources,\r\n      \"package.yml\": newPackageResource,\r\n    },\r\n  };\r\n});\r\n","import { isPackageDataSetAction } from \"@/actions/packages/package-data-set\";\r\nimport { fpSetByArray } from \"@/fp-set\";\r\nimport { stringifyYaml } from \"@/services/yaml/api\";\r\nimport { Encoder } from \"@/text-encoding\";\r\nimport { packageDataSelector } from \"../selectors/package\";\r\nimport { createPackageReducer } from \"../state-utils\";\r\n\r\nexport default createPackageReducer((state, action) => {\r\n  if (!isPackageDataSetAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  const { path, data } = action.payload;\r\n\r\n  if (state.loadingStatus != \"loaded\") {\r\n    return state;\r\n  }\r\n\r\n  const packageData = packageDataSelector.local(state);\r\n  if (!packageData) {\r\n    return state;\r\n  }\r\n\r\n  const newPackageData = fpSetByArray(packageData, path, data);\r\n  const newPackageStr = stringifyYaml(newPackageData);\r\n  const newPackageResource = Encoder.encode(newPackageStr);\r\n  return {\r\n    ...state,\r\n    resources: {\r\n      ...state.resources,\r\n      \"package.yml\": newPackageResource,\r\n    },\r\n  };\r\n});\r\n","import { stringifyYaml } from \"@/services/yaml/api\";\r\nimport { Encoder } from \"@/text-encoding\";\r\n\r\nimport { isPackageIdObjectNewAction } from \"@/actions/packages/package-idobject-new\";\r\n\r\nimport {\r\n  packageDataSelector,\r\n  packageIdObjectDataSelector,\r\n} from \"../selectors/package\";\r\n\r\nimport { createPackageReducer } from \"../state-utils\";\r\nimport { CruciblePackage, CruciblePackageIdObject } from \"../types\";\r\n\r\nexport default createPackageReducer((state, action, appState) => {\r\n  if (!isPackageIdObjectNewAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  if (state.loadingStatus != \"loaded\") {\r\n    return state;\r\n  }\r\n\r\n  const packageData = packageDataSelector.local(state);\r\n  if (!packageData) {\r\n    return state;\r\n  }\r\n\r\n  const { key, id } = action.payload;\r\n\r\n  const exists = packageIdObjectDataSelector(appState, key, id);\r\n  if (exists != null) {\r\n    return state;\r\n  }\r\n\r\n  const newItem: CruciblePackageIdObject = {\r\n    id,\r\n  };\r\n\r\n  const newPackageData: CruciblePackage = {\r\n    ...packageData,\r\n    [key]: [...(packageData[key] ?? []), newItem],\r\n  };\r\n\r\n  const newPackageStr = stringifyYaml(newPackageData);\r\n  const newResource = Encoder.encode(newPackageStr);\r\n  return {\r\n    ...state,\r\n    resources: {\r\n      ...state.resources,\r\n      \"package.yml\": newResource,\r\n    },\r\n  };\r\n});\r\n","import { isPackageLoadErrorAction } from \"@/actions/packages/package-load-error\";\r\nimport { createPackageReducer } from \"../state-utils\";\r\n\r\nexport default createPackageReducer((state, action) => {\r\n  if (!isPackageLoadErrorAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  return {\r\n    ...state,\r\n    loadingStatus: \"error\",\r\n    loadError: action.payload.errorMessage,\r\n  };\r\n});\r\n","import { AnyAction } from \"redux\";\r\n\r\nimport { isPackageLoadFileAction } from \"@/actions/packages/package-load-file\";\r\n\r\nimport { defaultPackageState, PackageState } from \"../state\";\r\nimport { createPackageReducer } from \"../state-utils\";\r\n\r\nexport default createPackageReducer(\r\n  (state: PackageState, action: AnyAction) => {\r\n    if (!isPackageLoadFileAction(action)) {\r\n      return state;\r\n    }\r\n\r\n    const { file } = action.payload;\r\n\r\n    return {\r\n      ...defaultPackageState,\r\n      packageId: file.name,\r\n      loadingStatus: \"loading\",\r\n    };\r\n  }\r\n);\r\n","import { isPackageNewAction } from \"@/actions/packages/package-new\";\r\nimport { Encoder } from \"@/text-encoding\";\r\nimport { defaultPackageState } from \"../state\";\r\n\r\nimport { createPackageReducer } from \"../state-utils\";\r\n\r\nexport default createPackageReducer((state, action) => {\r\n  if (!isPackageNewAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  return {\r\n    ...defaultPackageState,\r\n    packageId: \"new-package\",\r\n    loadingStatus: \"loaded\",\r\n    resources: {\r\n      \"package.yml\": Encoder.encode(`{}`),\r\n    },\r\n  };\r\n});\r\n","import { AnyAction } from \"redux\";\r\n\r\nimport { isPackageReceiveAction } from \"@/actions/packages/package-receive\";\r\n\r\nimport { defaultPackageState, PackageState } from \"../state\";\r\nimport { createPackageReducer } from \"../state-utils\";\r\n\r\nexport default createPackageReducer(\r\n  (state: PackageState, action: AnyAction) => {\r\n    if (!isPackageReceiveAction(action)) {\r\n      return state;\r\n    }\r\n\r\n    const { packageId, resources } = action.payload;\r\n\r\n    return {\r\n      ...defaultPackageState,\r\n      loadingStatus: \"loaded\",\r\n      packageId,\r\n      resources,\r\n    };\r\n  }\r\n);\r\n","import findIndex from \"lodash/findIndex\";\r\n\r\nimport { fpSetByArray } from \"@/fp-set\";\r\nimport { Encoder } from \"@/text-encoding\";\r\nimport { stringifyYaml } from \"@/services/yaml/api\";\r\n\r\nimport { isPackageResourceSetByIdAction } from \"@/actions/packages/package-resource-set-byid\";\r\n\r\nimport { createPackageReducer } from \"../state-utils\";\r\nimport { packageDataSelector } from \"../selectors/package\";\r\n\r\nexport default createPackageReducer((state, action) => {\r\n  if (!isPackageResourceSetByIdAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  const { sectionKey, id, path, resourceName, resource } = action.payload;\r\n\r\n  if (state.loadingStatus != \"loaded\") {\r\n    return state;\r\n  }\r\n\r\n  const packageData = packageDataSelector.local(state);\r\n  if (!packageData) {\r\n    return state;\r\n  }\r\n\r\n  const index = findIndex(packageData[sectionKey], (x) => x.id === id);\r\n  if (index == -1) {\r\n    // Should we try to make a new one?\r\n    return state;\r\n  }\r\n\r\n  const newPackageData = fpSetByArray(\r\n    packageData,\r\n    [sectionKey, index, ...path],\r\n    resourceName\r\n  );\r\n  const newPackgeStr = stringifyYaml(newPackageData);\r\n  const newPackageResource = Encoder.encode(newPackgeStr);\r\n  return {\r\n    ...state,\r\n    resources: {\r\n      ...state.resources,\r\n      \"package.yml\": newPackageResource,\r\n      [resourceName]: resource,\r\n    },\r\n  };\r\n});\r\n","import { fork } from \"redux-saga/effects\";\r\n\r\nimport packageLoadFileSaga from \"./package-load-file\";\r\nimport packageSaveSaga from \"./package-save\";\r\n\r\nexport default function* packageSaga() {\r\n  yield fork(packageLoadFileSaga);\r\n  yield fork(packageSaveSaga);\r\n}\r\n","import { entries } from \"lodash\";\r\nimport { loadAsync } from \"jszip\";\r\nimport { call, put, takeLatest } from \"@redux-saga/core/effects\";\r\nimport { SagaIterator } from \"@redux-saga/types\";\r\n\r\nimport {\r\n  ACTION_PACKAGE_LOAD_FILE,\r\n  PackageLoadFileAction,\r\n} from \"@/actions/packages/package-load-file\";\r\nimport { packageLoadError } from \"@/actions/packages/package-load-error\";\r\nimport { packageReceive } from \"@/actions/packages/package-receive\";\r\n\r\nexport default function* packageLoadFileSaga() {\r\n  yield takeLatest(ACTION_PACKAGE_LOAD_FILE, handlePackageLoadFile);\r\n}\r\n\r\nfunction* handlePackageLoadFile(action: PackageLoadFileAction): SagaIterator {\r\n  const { file } = action.payload;\r\n\r\n  try {\r\n    if (!file.name.endsWith(\".zip\")) {\r\n      throw new Error(\"Only zipped Crucible packages are supported.\");\r\n    }\r\n\r\n    const packageId = file.name.replace(/\\.zip$/, \"\");\r\n    const buffer: ArrayBuffer = yield call(() => file.arrayBuffer());\r\n\r\n    // jszip typings don't actually export the value returned by loadAsync...\r\n    const zip: Awaited<ReturnType<typeof loadAsync>> = yield call(() =>\r\n      loadAsync(buffer)\r\n    );\r\n\r\n    zip.generateAsync();\r\n\r\n    const resources: Record<string, Uint8Array> = {};\r\n    yield call(() =>\r\n      Promise.all(\r\n        entries(zip.files).map(([resourcePath, resource]) => {\r\n          return resource.async(\"uint8array\").then((data) => {\r\n            resources[resourcePath] = data;\r\n          });\r\n        })\r\n      )\r\n    );\r\n\r\n    if (resources[\"package.yml\"] == null) {\r\n      throw new Error(\"Package does not contain a package.yml file.\");\r\n    }\r\n\r\n    yield put(packageReceive(packageId, resources));\r\n  } catch (e: any) {\r\n    yield put(packageLoadError(e.message ?? String(e)));\r\n  }\r\n}\r\n","import { SagaIterator } from \"redux-saga\";\r\nimport { call, put, select, takeEvery } from \"redux-saga/effects\";\r\nimport { saveAs } from \"file-saver\";\r\nimport JSZip from \"jszip\";\r\n\r\nimport { ACTION_PACKAGE_SAVE } from \"@/actions/packages/package-save\";\r\nimport { editorCommit } from \"@/actions/editors/commit\";\r\n\r\nimport { packageResourcesSelector } from \"../selectors/resources\";\r\nimport { packageIdSelector } from \"../selectors/package\";\r\n\r\nexport default function* projectSaveSaga() {\r\n  yield takeEvery(ACTION_PACKAGE_SAVE, savePackage);\r\n}\r\n\r\nfunction* savePackage() {\r\n  const packageId: string | null = yield select(packageIdSelector);\r\n  if (!packageId) {\r\n    return;\r\n  }\r\n\r\n  yield put(editorCommit());\r\n\r\n  const zipData: Uint8Array = yield call(buildZip);\r\n  try {\r\n    if (window.showSaveFilePicker) {\r\n      yield call(saveNativeFileApi, zipData, packageId);\r\n    } else {\r\n      yield call(saveLegacy, zipData, packageId);\r\n    }\r\n  } catch (e) {\r\n    // TODO: Report error\r\n    console.warn(\"Failed to save project\", e);\r\n  }\r\n}\r\n\r\nfunction* buildZip(): SagaIterator<Uint8Array> {\r\n  const resources: Record<string, Uint8Array> = yield select(\r\n    packageResourcesSelector\r\n  );\r\n\r\n  const zip = new JSZip();\r\n  for (const key of Object.keys(resources)) {\r\n    const resource = resources[key];\r\n    zip.file(key, resource, { binary: true });\r\n  }\r\n\r\n  const result = yield call(() =>\r\n    zip.generateAsync({ type: \"uint8array\", compression: \"DEFLATE\" })\r\n  );\r\n\r\n  return result;\r\n}\r\n\r\nfunction* saveNativeFileApi(\r\n  zipData: Uint8Array,\r\n  packageId: string\r\n): SagaIterator {\r\n  const fileHandle: FileHandle | null = yield call(window.showSaveFilePicker!, {\r\n    // This isn't official yet, even with the not-official showSaveFilePicker\r\n    // https://github.com/WICG/file-system-access/blob/main/SuggestedNameAndDir.md#specifying-suggested-file-name-to-save-as\r\n    // It's so new, chrome does not yet support it, but it will:\r\n    // https://bugs.chromium.org/p/chromium/issues/detail?id=1145102\r\n    suggestedName: packageId,\r\n    types: [\r\n      {\r\n        description: \"Crucible Packages\",\r\n        accept: {\r\n          \"application/zip\": [\".zip\"],\r\n        },\r\n      },\r\n    ],\r\n  });\r\n\r\n  if (!fileHandle) {\r\n    return;\r\n  }\r\n\r\n  const writable: FileSystemWritableStream = yield call(\r\n    fileHandle.createWritable.bind(fileHandle)\r\n  );\r\n  yield call(writable.write.bind(writable), zipData);\r\n  yield call(writable.close.bind(writable));\r\n}\r\n\r\nfunction* saveLegacy(zipData: Uint8Array, packageId: string): SagaIterator {\r\n  const blob = new Blob([zipData], {\r\n    type: \"application/zip\",\r\n  });\r\n\r\n  saveAs(blob, `${packageId}.zip`);\r\n}\r\n","import find from \"lodash/find\";\r\n\r\nimport { AppState } from \"@/state\";\r\nimport { emptyFrozenArray, ItemOf } from \"@/arrays\";\r\n\r\nimport { parseYaml } from \"@/services/yaml/api\";\r\n\r\nimport { createPackageSelector } from \"../state-utils\";\r\nimport {\r\n  CruciblePackage,\r\n  CruciblePackageIdObject,\r\n  CruciblePackageSectionKey,\r\n  CruciblePackageSections,\r\n} from \"../types\";\r\n\r\nimport {\r\n  packageResourceSelector,\r\n  packageTextResourceSelector,\r\n} from \"./resources\";\r\nimport { forEach } from \"lodash\";\r\nimport { createSelector } from \"reselect\";\r\n\r\nexport const packageLoadStatusSelector = createPackageSelector(\r\n  (x) => x.loadingStatus\r\n);\r\n\r\nexport const packageLoadErrorSelector = createPackageSelector(\r\n  (x) => x.loadError\r\n);\r\n\r\nexport const packageIdSelector = createPackageSelector((x) => x.packageId);\r\n\r\nlet cacheResources: any;\r\nlet cacheYaml: CruciblePackage | undefined;\r\nexport const packageDataSelector = createPackageSelector((state) => {\r\n  if (state.loadingStatus !== \"loaded\") {\r\n    return null;\r\n  }\r\n\r\n  if (cacheResources == state.resources) {\r\n    return cacheYaml;\r\n  }\r\n\r\n  const yamlStr = packageTextResourceSelector.local(state, \"package.yml\");\r\n  if (yamlStr == null) {\r\n    return null;\r\n  }\r\n\r\n  const yaml = parseYaml(yamlStr, (resourePath) => {\r\n    const resource = packageTextResourceSelector.local(state, resourePath);\r\n    if (resource == null) {\r\n      // TODO: We need to get this error to the user somehow...\r\n      // This will probably just crash the react renderer.\r\n      throw new Error(`Resource ${resourePath} not found`);\r\n    }\r\n    return resource;\r\n  }) as CruciblePackage;\r\n\r\n  cacheResources = state.resources;\r\n  cacheYaml = yaml;\r\n\r\n  return yaml;\r\n});\r\n\r\nexport function packageIdObjectIdsSelector(\r\n  state: AppState,\r\n  key: CruciblePackageSectionKey\r\n): string[] {\r\n  const data = packageDataSelector(state);\r\n  if (!data) {\r\n    return [];\r\n  }\r\n\r\n  const ids = data[key]?.map(\r\n    (idObject: CruciblePackageIdObject) => idObject.id\r\n  );\r\n  if (ids == null) {\r\n    return emptyFrozenArray<string>();\r\n  }\r\n\r\n  return ids;\r\n}\r\n\r\nexport function packageIdObjectsSelector<\r\n  TKey extends CruciblePackageSectionKey\r\n>(state: AppState, key: TKey): CruciblePackageSections[TKey] {\r\n  const data = packageDataSelector(state);\r\n  if (data == null || data[key] == null) {\r\n    return emptyFrozenArray() as CruciblePackageSections[TKey];\r\n  }\r\n  return data[key];\r\n}\r\n\r\nexport function packageIdObjectDataSelector<\r\n  TKey extends CruciblePackageSectionKey\r\n>(\r\n  state: AppState,\r\n  key: TKey,\r\n  id: string\r\n): ItemOf<CruciblePackageSections[TKey]> | null {\r\n  const data = packageDataSelector(state);\r\n  if (!data) {\r\n    return null;\r\n  }\r\n\r\n  // This cast should be unnecessary, since all CruciblePackageSections are arrays of id objects.\r\n  // Typescript doesnt seem to agree though.\r\n  const entries = data[key] as CruciblePackageIdObject[];\r\n  return (find(entries, (entry) => entry.id === id) as any) ?? null;\r\n}\r\n\r\nexport function packageIdObjectResourceSelector<\r\n  TSection extends CruciblePackageSectionKey,\r\n  TK1 extends keyof ItemOf<CruciblePackageSections[TSection]>\r\n>(state: AppState, key: TSection, id: string, k1: TK1): Uint8Array | null {\r\n  const data = packageIdObjectDataSelector(state, key, id);\r\n  if (!data) {\r\n    return null;\r\n  }\r\n\r\n  const resourcePath = data[k1] as unknown;\r\n  if (typeof resourcePath !== \"string\") {\r\n    return null;\r\n  }\r\n\r\n  return packageResourceSelector(state, resourcePath);\r\n}\r\n","import { Utf8Decoder } from \"@/text-encoding\";\r\n\r\nimport { PackageState } from \"../state\";\r\nimport { createPackageSelector } from \"../state-utils\";\r\n\r\nexport const packageResourcesSelector = createPackageSelector(\r\n  (s) => s.resources\r\n);\r\n\r\nexport const packageResourceSelector = createPackageSelector(\r\n  (state: PackageState, resourcePath: string) => {\r\n    const resource = state.resources[resourcePath];\r\n    if (resource == null) {\r\n      return null;\r\n    }\r\n    return resource;\r\n  }\r\n);\r\n\r\nexport const packageTextResourceSelector = createPackageSelector(\r\n  (state: PackageState, resourcePath: string) => {\r\n    const resource = state.resources[resourcePath];\r\n    if (resource == null) {\r\n      return null;\r\n    }\r\n\r\n    return Utf8Decoder.decode(state.resources[resourcePath]);\r\n  }\r\n);\r\n","import {\r\n  createServiceReducerCreator,\r\n  createServiceSelectorCreator,\r\n} from \"../state-utils\";\r\n\r\nexport const createPackageReducer = createServiceReducerCreator(\"package\");\r\nexport const createPackageSelector = createServiceSelectorCreator(\"package\");\r\n","export interface PackageState {\r\n  packageId: string | null;\r\n  loadingStatus: \"idle\" | \"loading\" | \"loaded\" | \"error\";\r\n  loadError: string | null;\r\n  resources: Record<string, Uint8Array>;\r\n}\r\n\r\nconst _defaultState: PackageState = {\r\n  packageId: null,\r\n  loadingStatus: \"idle\",\r\n  loadError: null,\r\n  resources: {},\r\n};\r\n\r\nexport const defaultPackageState = Object.freeze(_defaultState);\r\n","import { concatReducers } from \"@/reducer/utils\";\r\n\r\nimport i18nReducer from \"./i18n/reducer\";\r\nimport mapEditorReducer from \"./map-editor/reducer\";\r\nimport navigationReducer from \"./navigation/reducer\";\r\nimport packageReducer from \"./package/reducer\";\r\n\r\nexport default concatReducers(\r\n  i18nReducer,\r\n  mapEditorReducer,\r\n  navigationReducer,\r\n  packageReducer\r\n);\r\n","import { fork } from \"redux-saga/effects\";\r\n\r\nimport commitQueueSaga from \"./commit-queue/saga\";\r\nimport mapEditorSaga from \"./map-editor/saga\";\r\nimport packageSaga from \"./package/saga\";\r\n\r\nexport function* servicesSaga() {\r\n  yield fork(commitQueueSaga);\r\n  yield fork(mapEditorSaga);\r\n  yield fork(packageSaga);\r\n}\r\n","import { AnyAction, Reducer } from \"redux\";\r\nimport get from \"lodash/get\";\r\n\r\nimport { AppState, defaultAppState } from \"@/state\";\r\nimport { fpSetByArray } from \"@/fp-set\";\r\n\r\nexport type ServiceKey = keyof AppState[\"services\"];\r\nexport type SubServiceKey<T extends ServiceKey> = keyof AppState[\"services\"][T];\r\nexport type ServiceState<TServiceKey extends ServiceKey> =\r\n  AppState[\"services\"][TServiceKey];\r\nexport type SubServiceState<\r\n  TServiceKey extends ServiceKey,\r\n  TSubServiceKey extends SubServiceKey<TServiceKey>\r\n> = ServiceState<TServiceKey>[TSubServiceKey];\r\n\r\nexport interface ServiceReducer<TServiceState> {\r\n  (\r\n    state: Readonly<TServiceState>,\r\n    action: AnyAction,\r\n    appState: AppState\r\n  ): TServiceState;\r\n}\r\n\r\nexport function createServiceReducerCreator<TServiceKey extends ServiceKey>(\r\n  service: TServiceKey\r\n): (\r\n  reducer: ServiceReducer<ServiceState<TServiceKey>>\r\n) => Reducer<AppState, AnyAction>;\r\nexport function createServiceReducerCreator<\r\n  TServiceKey extends ServiceKey,\r\n  TSubServiceKey extends SubServiceKey<TServiceKey>\r\n>(\r\n  service: TServiceKey,\r\n  service2: TSubServiceKey\r\n): (\r\n  reducer: ServiceReducer<SubServiceState<TServiceKey, TSubServiceKey>>\r\n) => Reducer<AppState, AnyAction>;\r\nexport function createServiceReducerCreator(\r\n  ...serviceKeys: string[]\r\n): (reducer: ServiceReducer<any>) => Reducer<AppState, AnyAction> {\r\n  return (reducer: ServiceReducer<any>) => {\r\n    return (state: AppState = defaultAppState, action: AnyAction) => {\r\n      const oldState = get(state.services, serviceKeys);\r\n      const newState = reducer(oldState, action, state);\r\n      if (oldState != newState) {\r\n        return fpSetByArray(state, [\"services\", ...serviceKeys], newState);\r\n      }\r\n      return state;\r\n    };\r\n  };\r\n}\r\n\r\nexport interface ServiceSelectorA0<TServiceState, TReturn> {\r\n  (s: AppState): TReturn;\r\n  local(s: TServiceState): TReturn;\r\n}\r\n\r\nexport interface ServiceSelectorA1<TServiceState, TA1, TReturn> {\r\n  (s: AppState, a1: TA1): TReturn;\r\n  local(s: TServiceState, a1: TA1): TReturn;\r\n}\r\n\r\nexport interface ServiceSelectorA2<TServiceState, TA1, TA2, TReturn> {\r\n  (s: AppState, a1: TA1, a2: TA2): TReturn;\r\n  local(s: TServiceState, a1: TA1, a2: TA2): TReturn;\r\n}\r\n\r\nexport interface ServiceSelectorCreator<TServiceKey extends ServiceKey> {\r\n  <TReturn>(\r\n    selector: (s: ServiceState<TServiceKey>) => TReturn\r\n  ): ServiceSelectorA0<ServiceState<TServiceKey>, TReturn>;\r\n  <TA1, TReturn>(\r\n    selector: (s: ServiceState<TServiceKey>, a1: TA1) => TReturn\r\n  ): ServiceSelectorA1<ServiceState<TServiceKey>, TA1, TReturn>;\r\n  <TA1, TA2, TReturn>(\r\n    selector: (s: ServiceState<TServiceKey>, a1: TA1, a2: TA2) => TReturn\r\n  ): ServiceSelectorA2<ServiceState<TServiceKey>, TA1, TA2, TReturn>;\r\n}\r\n\r\nexport interface SubServiceSelectorCreator<\r\n  TServiceKey extends ServiceKey,\r\n  TSubServiceKey extends SubServiceKey<TServiceKey>\r\n> {\r\n  <TReturn>(\r\n    selector: (s: SubServiceState<TServiceKey, TSubServiceKey>) => TReturn\r\n  ): ServiceSelectorA0<SubServiceState<TServiceKey, TSubServiceKey>, TReturn>;\r\n  <TA1, TReturn>(\r\n    selector: (\r\n      s: SubServiceState<TServiceKey, TSubServiceKey>,\r\n      a1: TA1\r\n    ) => TReturn\r\n  ): ServiceSelectorA1<\r\n    SubServiceState<TServiceKey, TSubServiceKey>,\r\n    TA1,\r\n    TReturn\r\n  >;\r\n  <TA1, TA2, TReturn>(\r\n    selector: (\r\n      s: SubServiceState<TServiceKey, TSubServiceKey>,\r\n      a1: TA1,\r\n      a2: TA2\r\n    ) => TReturn\r\n  ): ServiceSelectorA2<\r\n    SubServiceState<TServiceKey, TSubServiceKey>,\r\n    TA1,\r\n    TA2,\r\n    TReturn\r\n  >;\r\n}\r\n\r\nexport function createServiceSelectorCreator<TServiceKey extends ServiceKey>(\r\n  service: TServiceKey\r\n): ServiceSelectorCreator<TServiceKey>;\r\nexport function createServiceSelectorCreator<\r\n  TServiceKey extends ServiceKey,\r\n  TSubServiceKey extends SubServiceKey<TServiceKey>\r\n>(\r\n  service: TServiceKey,\r\n  subService: TSubServiceKey\r\n): SubServiceSelectorCreator<TServiceKey, TSubServiceKey>;\r\nexport function createServiceSelectorCreator<TServiceKey extends ServiceKey>(\r\n  ...serviceKeys: string[]\r\n): ServiceSelectorCreator<any> {\r\n  return <TArgs, TReturn>(\r\n    selector: (s: ServiceState<TServiceKey>, ...args: TArgs[]) => TReturn\r\n  ) => {\r\n    const appSelector: any = (s: AppState, ...args: TArgs[]) => {\r\n      const state = get(s.services, serviceKeys);\r\n      return selector(state, ...args);\r\n    };\r\n    appSelector.local = selector;\r\n    return appSelector;\r\n  };\r\n}\r\n","import { I18NState, defaultI18NState } from \"./i18n/state\";\r\nimport { MapEditorState, defaultMapEditorState } from \"./map-editor/state\";\r\nimport { NavigationState, defaultNavigationState } from \"./navigation/state\";\r\nimport { PackageState, defaultPackageState } from \"./package/state\";\r\n\r\nexport interface ServicesState {\r\n  i18n: I18NState;\r\n  mapEditor: MapEditorState;\r\n  navigation: NavigationState;\r\n  package: PackageState;\r\n}\r\n\r\nexport const defaultServicesState: Readonly<ServicesState> = Object.freeze({\r\n  i18n: defaultI18NState,\r\n  mapEditor: defaultMapEditorState,\r\n  navigation: defaultNavigationState,\r\n  package: defaultPackageState,\r\n});\r\n","import { parse, stringify, CST, Document } from \"yaml\";\r\n\r\nexport function parseYaml(\r\n  yaml: string,\r\n  resolveImport: (resourcePath: string) => string\r\n): any {\r\n  // Frustratingly, the Tag interface is not exported from yaml.\r\n  const importTag = {\r\n    identify: (value: any) => false,\r\n    tag: \"!import\",\r\n    resolve: (doc: Document, cst: CST.Node) => {\r\n      const resourcePath = (cst as CST.PlainValue).strValue;\r\n      if (!resourcePath) {\r\n        throw new Error(\"Invalid import path\");\r\n      }\r\n      const imported = resolveImport(resourcePath);\r\n      return parse(imported, { merge: true, customTags: [importTag] });\r\n    },\r\n  };\r\n  return parse(yaml, { merge: true, customTags: [importTag] });\r\n}\r\n\r\nexport function stringifyYaml(data: any) {\r\n  return stringify(data);\r\n}\r\n","export * from \"./utils\";\r\n\r\nimport { ServicesState, defaultServicesState } from \"@/services/state\";\r\n\r\nexport interface AppState {\r\n  services: ServicesState;\r\n}\r\n\r\nexport const defaultAppState: Readonly<AppState> = Object.freeze({\r\n  services: defaultServicesState,\r\n});\r\n","import { Selector } from \"react-redux\";\r\nimport { createStructuredSelector as createSS } from \"reselect\";\r\n\r\nimport { AppState } from \"@/state\";\r\n\r\nexport type StructuredStateProps<\r\n  TSelectors extends Record<string, Selector<AppState, TOwnProps, any>>,\r\n  TOwnProps = {}\r\n> = { [K in keyof TSelectors]: ReturnType<TSelectors[K]> };\r\n\r\n/**\r\n * Type wrangling function to provide better type inferencing\r\n * for createStructuredSelector against our AppState.\r\n *\r\n * By inverting the type relationship from the real cSS, we\r\n * allow the selector to become the primary inferred type\r\n * and generate the state props from its return types.\r\n */\r\nexport function createStructuredSelector<\r\n  TSelectors extends Record<string, Selector<AppState, any, any>>\r\n>(\r\n  selectors: TSelectors\r\n): (state: AppState) => StructuredStateProps<TSelectors> {\r\n  return createSS(selectors as any) as any;\r\n}\r\n","import * as React from \"react\";\r\n\r\nimport { Provider } from \"react-redux\";\r\n\r\nimport store from \"../store\";\r\n\r\nconst StoreProvider: React.FC = ({ children }) => (\r\n  <Provider store={store}>{children}</Provider>\r\n);\r\nexport default StoreProvider;\r\n","import { AnyAction } from \"redux\";\r\n\r\nimport { AppState } from \"@/state\";\r\n\r\nimport { ACTION_MAPEDITOR_MOUSE_MOVE } from \"@/actions/map-editor/mouse-move\";\r\nimport { ACTION_MAPEDITOR_PAN } from \"@/actions/map-editor/pan\";\r\nimport { ACTION_MAPEDITOR_ZOOM } from \"@/actions/map-editor/zoom\";\r\nimport { ACTION_MAPEDITOR_RENDERED } from \"@/actions/map-editor/rendered\";\r\nimport { ACTION_EDITOR_COMMIT_QUEUE } from \"@/actions/editors/commit-queue\";\r\n\r\nexport const actionsBlacklist: string[] = [\r\n  ACTION_MAPEDITOR_MOUSE_MOVE,\r\n  ACTION_MAPEDITOR_PAN,\r\n  ACTION_MAPEDITOR_ZOOM,\r\n  ACTION_MAPEDITOR_RENDERED,\r\n  ACTION_EDITOR_COMMIT_QUEUE,\r\n];\r\n\r\nexport function actionSanitizer(action: AnyAction): AnyAction {\r\n  return action;\r\n}\r\n\r\nexport function stateSanitizer(state: AppState): any {\r\n  return {\r\n    ...state,\r\n    services: {\r\n      ...state.services,\r\n      package: {\r\n        ...state.services.package,\r\n        resources: undefined,\r\n      },\r\n    },\r\n  };\r\n}\r\n","import { AppState, createStructuredSelector } from \"@/state\";\r\n\r\nimport {\r\n  loadState as loadI18nState,\r\n  persistState as persistI18nState\r\n} from \"@/services/i18n/persist\";\r\n\r\nexport function loadPersistedState(state: AppState): AppState {\r\n  const persistedState = getStoredState();\r\n\r\n  return {\r\n    ...state,\r\n    services: {\r\n      ...state.services,\r\n      i18n: loadI18nState(state.services.i18n, persistedState.i18n || {})\r\n    }\r\n  };\r\n}\r\n\r\n// Store the last persisted state to avoid setting the item\r\n//  when no data has changed.\r\nlet lastPersistedState: any = null;\r\n\r\nconst buildPersistedState = createStructuredSelector({\r\n  i18n: persistI18nState\r\n});\r\n\r\nexport function savePersistedState(state: AppState) {\r\n  const persistedState = buildPersistedState(state);\r\n  if (lastPersistedState === persistedState) {\r\n    return;\r\n  }\r\n  setStoredState(persistedState);\r\n  lastPersistedState = persistedState;\r\n}\r\n\r\nconst PERSISTED_STATE_KEY = \"persisted-state\";\r\n\r\nfunction getStoredState(): any {\r\n  const stateJson = localStorage.getItem(PERSISTED_STATE_KEY);\r\n  if (!stateJson) {\r\n    return {};\r\n  }\r\n\r\n  try {\r\n    return JSON.parse(stateJson);\r\n  } catch {\r\n    return {};\r\n  }\r\n}\r\n\r\nfunction setStoredState(state: any) {\r\n  localStorage.setItem(PERSISTED_STATE_KEY, JSON.stringify(state));\r\n}\r\n","import { fork } from \"redux-saga/effects\";\r\n\r\nimport { servicesSaga } from \"@/services/saga\";\r\n\r\nexport default function* rootSaga() {\r\n  yield fork(servicesSaga);\r\n}\r\n","import {\r\n  compose,\r\n  createStore as createReduxStore,\r\n  applyMiddleware,\r\n} from \"redux\";\r\n\r\nimport createSagaMiddleware from \"redux-saga\";\r\n\r\nimport { defaultAppState } from \"@/state\";\r\nimport { initialize } from \"@/actions/initialize\";\r\n\r\nimport reducer from \"@/reducer\";\r\n\r\nimport { loadPersistedState, savePersistedState } from \"./persist\";\r\n\r\nimport {\r\n  actionSanitizer,\r\n  stateSanitizer,\r\n  actionsBlacklist,\r\n} from \"./devtool-sanitizer\";\r\n\r\nimport saga from \"./saga\";\r\n\r\nfunction createStore() {\r\n  const composeEnhancers =\r\n    (window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ &&\r\n      window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({\r\n        actionSanitizer,\r\n        stateSanitizer,\r\n        actionsBlacklist,\r\n      })) ||\r\n    compose;\r\n\r\n  const sagaMiddleware = createSagaMiddleware();\r\n\r\n  const initialState = loadPersistedState(defaultAppState);\r\n\r\n  const store = createReduxStore(\r\n    reducer,\r\n    initialState,\r\n    composeEnhancers(applyMiddleware(sagaMiddleware))\r\n  );\r\n\r\n  sagaMiddleware.run(saga);\r\n\r\n  store.subscribe(() => savePersistedState(store.getState()));\r\n  store.dispatch(initialize());\r\n\r\n  return store;\r\n}\r\n\r\nconst store = createStore();\r\nexport default store;\r\n","import \"normalize.css\";\r\n\r\nimport \"./colors.css\";\r\nimport \"./global.css\";\r\n","export const Utf8Decoder = new TextDecoder(\"utf-8\");\r\nexport const Encoder = new TextEncoder();\r\n"],"names":["ACTION_EDITOR_COMMIT_QUEUE","editorCommitQueue","type","action","ACTION_EDITOR_COMMIT","editorCommit","ACTION_INITIALIZE","initialize","ACTION_MAPEDITOR_ENTITY_DELETE","mapEditorEntityDelete","entityKeys","payload","asArray","ACTION_MAPEDITOR_ENTITY_INSERT","mapEditorEntityInsert","entity","entities","x","ACTION_MAPEDITOR_ENTITY_OFFSET","mapEditorEntityOffset","offsetX","offsetY","ACTION_MAPEDITOR_ENTITY_PROTOTYPE_INSTANTIATE","mapEditorEntityPrototypeInstantiate","prototype","worldPos","entityKey","ACTION_MAPEDITOR_MAP_CLEAR","mapEditorMapClear","ACTION_MAPEDITOR_MAP_IMPORT_TEMPLATE","mapEditorMapImportTemplate","templateId","ACTION_MAPEDITOR_MAP_RECEIVE","mapEditorMapReceive","ACTION_MAPEDITOR_MODIFIERKEYS_CHANGED","mapEditorModifierKeysChanged","modifiers","ACTION_MAPEDITOR_MOUSE_DOWN","mapEditorMouseDown","viewportPos","modifierKeys","ACTION_MAPEDITOR_MOUSE_MOVE","mapEditorMouseMove","ACTION_MAPEDITOR_MOUSE_OUT","mapEditorMouseOut","ACTION_MAPEDITOR_MOUSE_UP","mapEditorMouseUp","ACTION_MAPEDITOR_PAN","mapEditorPan","xOffset","yOffset","y","ACTION_MAPEDITOR_RENDERED","mapEditorRendered","ACTION_MAPEDITOR_SELECT_CLEAR","mapEditorSelectClear","ACTION_MAPEDITOR_SELECT_ENTITY","mapEditorSelectEntity","mode","ACTION_MAPEDITOR_SELECTION_DELETE","mapEditorSelectionDelete","ACTION_MAPEDITOR_TOOL_RADIUS_SET","mapEditorToolRadiusSet","radius","ACTION_MAPEDITOR_TOOL_SET","mapEditorToolSet","tool","ACTION_MAPEDITOR_VIEWPORT_RESIZE","mapEditorViewportResize","width","height","ACTION_MAPEDITOR_ZOOM","mapEditorZoom","zoomFactor","ACTION_NAVTREE_EXPANDEDVALUES_SET","navtreeExpandedValuesSet","expandedValues","ACTION_PACKAGE_DATA_SET_BYID","sectionKey","id","args","path","slice","length","data","ACTION_PACKGE_DATA_SET","ACTION_PACKAGE_IDOBJECT_NEW","packageIdObjectNew","key","ACITON_PACKAGE_LOAD_ERROR","packageLoadError","errorMessage","ACTION_PACKAGE_LOAD_FILE","packageLoadFile","file","ACTION_PACKAGE_NEW","packageNew","ACTION_PACKAGE_RECEIVE","packageReceive","packageId","resources","ACTION_PACKAGE_RESOURCE_SET_BYID","resourceName","resource","ACTION_PACKAGE_SAVE","packageSave","ACTION_POTIONBASE_MAP_EDIT","potionBaseMapEdit","potionBaseId","ACTION_SET_LANGUAGE","setLanguage","language","Array","isArray","_emptyArray","Object","freeze","ctx","handler","save","scale","translate","restore","beginPath","fillStyle","arc","POTION_RADIUS","Math","PI","fill","isSelected","renderResources","EntityDefsByType","entityType","render","accept","onFileLoaded","onInteractionComplete","children","inputRef","React","useRef","onClick","useCallback","current","click","onFileChange","e","files","target","ref","style","display","onChange","content","placement","anchorEl","open","setOpen","useState","onClose","MenuCloseListener","isOpen","onRequestClose","Button","forwardRef","className","variant","size","disabled","props","LinkButton","Link","checked","FontAwesomeIcon","fixedWidth","icon","faCheckSquare","faSquare","color","svgRef","setIsOpen","bufferedColor","setBufferedColor","onSketchColorChange","hex","onSketchColorCommit","cx","cy","r","SketchPicker","onChangeComplete","value","onCommit","editingValue","setEditingValue","onBlur","orientation","useSelector","packageLoadStatusSelector","Redirect","to","label","IdObjectResourceField","objectId","resourceKey","dispatch","useDispatch","obj","state","packageIdObjectDataSelector","arrayBuffer","then","buffer","packageResourceSetById","extname","name","Uint8Array","hasResource","faCheck","faFileUpload","merge","ofType","imageResource","imageResourceName","isLoading","setLoading","imageUrl","useMemo","URL","createObjectURL","Blob","finally","src","toolSize","toolRadiusSelector","currentTool","currentToolSelector","onIncreaseToolSize","useClickAction","onDecreaseToolSize","onPointerClick","onEraserClick","onBonesClick","toFixed","bonePrototype","i18nKey","prefab","angle","boneItems","t","useTranslation","entityPrototypes","setClosed","useBooleanSetState","map","entityPrototype","i","PotionEffectDraggableItem","selfRef","setSelfRef","displayName","canvasRef","dragRef","useDrag","DRAGOBJECT_NEW_ENTITY","item","newEntityDragObject","isShowingTooltip","showTooltip","hideTooltip","renderResourcesSelector","useLayoutEffect","canvas","getContext","onMouseOut","effects","potionEffectEntityPrototypesSelector","vortexPrototype","vortexItems","HotkeysContainer","keyHandlers","KEYMAP_DELETE","defaultPrevented","preventDefault","HotKeys","keyMap","handlers","component","entitiesByKey","entitiesByKeySelector","selectedEntityKeys","selectedEntityKeysSelector","editorOffsetXSelector","editorOffsetYSelector","editorZoomFactorSelector","viewportWidth","editorViewportWidthSelector","viewportHeight","editorViewportHeightSelector","dragMoveOffset","dragMoveOffsetSelector","useEffect","clearRect","transformToMap","renderEntity","store","useStore","pointerRef","canvasBounds","useComponentBounds","clientToWorld","useClientToWorld","eventCanvasPoint","clientX","left","clientY","top","onMouseEnter","focus","onPointerDown","pointerId","currentTarget","setPointerCapture","getModifiers","p","onPointerMove","onPointerUp","releasePointerCapture","onKeyDown","onKeyUp","_","dropRef","useDrop","drop","monitor","isNewEntityDragObject","getClientOffset","worldP","animationFrame","getState","damageRect","editorDamageRectSelector","p1","LargestEntityRadius","p2","redrawRect","clearClientP1","worldToClientSelector","clearClientP2","normalizeRectangle","max","min","lineWidth","setLineDash","moveTo","lineTo","stroke","renderPotionStart","keys","pointIntersectsRect","includes","unsubscribe","subscribe","requestAnimationFrame","cancelAnimationFrame","tabIndex","selectionRect","dragSelectionRectSelector","mousePos","viewportMousePosSelector","toolRadius","toolViewportRadiusSelector","strokeWidth","opacity","strokeDasharray","ZOOM_FACTOR","PAN_FACTOR","containerRef","containerBounds","onWheel","ctrlMetaKey","nextZoom","deltaY","stopPropagation","shiftKey","useNativeEvent","passive","keymap","MenuCloseContext","createContext","useMenuCloseContext","useContext","onCloseProp","onCloseChain","Provider","autoDismissMenu","secondary","requestMenuClose","onItemClick","d","createPortal","FocusOn","onClickOutside","onEscapeKey","AutoFocusInside","document","body","navtreeExpandedValues","navtreeExpandedValuesSelector","onExpandedValuesChanged","values","ingredientIds","packageIdObjectIdsSelector","potionBaseIds","potionEffectIds","potionBottleIds","PackageMenu","loadStatus","onLoadPackage","onNew","useAction","onSave","titlebarContent","showContentTree","noop","popperRef","setPopperRef","attributes","styles","usePopper","usePopperChild","popperChildren","registerPopperChild","unregisterPopperChild","useArrayState","insideRefs","useOutsideMouseEvent","PopperChildContextProvider","popper","noopPopperChildContext","PopperChildContext","usePopperChildContext","contextRegister","contextUnregister","parent","parentRegister","parentUnregister","element","providedContext","popperContext","ctxRef","title","titlebar","arrowRef","setArrowRef","popperStyles","options","offset","role","arrow","pathname","useLocation","useLinkClicked","selected","context","setExpandedValues","TreeChildContext","emptyFrozenArray","useTreeChildContext","isExpanded","indexOf","onChevronClick","filter","v","onLabelClick","faChevronDown","faChevronRight","VORTEX_MEDIUM","VORTEX_LARGE","makeImg","img","Image","onerror","console","error","bind","DangerZoneImages","Bone1","Bone2","Fang1","Fang2","Skull1","DangerZonePartDef","hitRadius","tweakStyles","rotate","fillRect","w","h","drawImage","ExperienceBonusDef","resourceCache","PotionEffectDef","rect","effectId","resourceId","image","resourceToImage","tryGetResourceImage","effect","VortexDef","DangerZonePart","ExperienceBonus","PotionEffect","Vortex","reduce","def","TileDataByType","tileType","tileData","tileEntities","padding","tilePadding","tileBounds","tileSize","calcSize","tileXOrdinal","floor","ceil","tileYOrdinal","tileEntity","push","fpSetByArray","firstPaths","String","lastPath","newData","clone","rollingTarget","seg","assign","ZeroPoint","ZeroRect","sqrt","history","createHashHistory","actionCreator","preBind","defaultValue","items","setItems","addItem","removeItem","defaultState","setState","setSize","right","bottom","observer","ResizeObserver","el","b","getBoundingClientRect","observe","disconnect","listener","listenTarget","addEventListener","removeEventListener","isTruthy","Boolean","onOutsideEvent","when","onEvent","elements","every","contains","selector","rootEl","getElementById","ReactDOM","event","button","isModifierPressed","oil","water","TemplatesByName","MODIFIER_KEYS_NONE","ctrlKey","altKey","metaKey","keyboardModifierUseMeta","extra","loadingState","packageLoadErrorSelector","packageData","packageDataSelector","onSetPackageName","packageDataSet","onSetPackageAuthor","author","onSetPackageDescription","description","newIngredientId","setNewIngredientId","newPotionId","setNewPotionId","onRequestNewPotionBase","onCancelNewPotionBase","onNewPotionBase","autoFocus","match","params","MapMenu","onMapClear","MapImportMenu","MapImportTemplateMenu","onNewWaterMap","onNewOilMap","potionBase","onSetUnlockedOnStart","packageDataSetById","unlockedOnStart","onSetColor","liquidColor","onSetDescription","placeholder","minRows","ingredientListIcon","ingredientListIconName","onSetIngredientListIcon","useIdObjectResource","menuButtonImage","menuButtonImageName","onSetMenuButtonImage","menuButtonHoverImage","menuButtonHoverImageName","onSetMenuButtonHoverImage","menuButtonSelectedImage","menuButtonSelectedImageName","onSetMenuButtonSelectedImage","menuButtonLockedImage","menuButtonLockedImageName","onSetMenuButtonLockedImage","ladleImage","ladleImageName","onSetLadleImage","recipeStepImage","recipeStepImageName","onSetRecipeStepImage","mapOriginImage","mapOriginImageName","onSetMapOriginImage","onSetName","tooltipImage","tooltipImageName","onSetTooltipImage","bottleIds","newBottleId","setNewBottleId","onRequestNewIngredient","onNewBottle","LiquidEditor1","makeLiquidEditor","LiquidEditor2","LiquidEditor3","LiquidEditor4","LiquidEditor5","potionBottleId","potionBottle","iconResource","iconResourceName","onSetIcon","PotionBottleResourceField","artKeys","foreground","packageIdObjectResourceSelector","resourceUrls","resourceUrl","foregroundUrl","bottleForeground","artKey","newEffectId","setNewEffectId","onRequestNewEffect","onCancelNewEffect","onNewPotionEffect","potionEffectId","potionEffect","onColorChange","potionColor","effectIcon","setEffectIcon","imageName","idx","lastIndexOf","substring","finalizedReducer","finalizeReducerList","defaultAppState","PRIORITY_PRE","PRIORITY_POST","priority","reducer","weight","reducers","concat","finalizedList","Router","DndProvider","backend","HTML5Backend","Switch","Route","exact","osPlatform","os","family","OSType","test","isProd","defaultMode","selectedIds","chosenIds","chosen","doCommit","put","debounce","I18nextProvider","i18n","use","initReactI18next","init","fallbackLng","ns","defaultNS","en","common","potioncraft","debug","interpolation","escapeValue","react","wait","persistState","createStructuredSelector","currentLanguageSelector","persisted","changeLanguage","createI18nReducer","defaultI18NState","lang","createI18nSelector","createServiceReducerCreator","createServiceSelectorCreator","createEditorDamageReducer","isMapEditorRenderedAction","damageWorldRect","appState","isMapEditorPanAction","isMapEditorZoomAction","isMapEditorViewportResizeAction","Number","NEGATIVE_INFINITY","POSITIVE_INFINITY","reducerPriority","isMapEditorEntityDeleteAction","entityFromKeySelector","addPointToRect","isMapEditorEntityInsertAction","isMapEditorEntityOffsetAction","isMapEditorEntityPrototypeInstantiateAction","concatReducers","isMapEditorMapClearAction","isMapEditorMapImportTemplateAction","isMapEditorMapReceiveAction","isMapEditorSelectClearAction","isMapEditorSelectEntityAction","createEditorDamageSelector","defaultEditorDamageState","createMapEntitiesReducer","removeFromRegionContainer","addToRegionContainer","offsetP","pointAdd","defaultMapEntitiesState","ORIGIN_OFFSET","getRegionIndexsFromPoint","getRegionIndexesFromRect","x1","y1","x2","y2","indexes","addedOOB","addOOB","MAP_WIDTH","MAP_HEIGHT","addToRegion","region","removeFromRegion","REGION_COUNT","container","regionIndexes","regionKeys","forEach","regionIndex","outOfBoundsRegion","entityRegions","fpSet","createMapEntitiesSelector","entitityKeysSelector","createSelector","entityKeyAtPointSelector","worldPoint","getEntityKeysFromPoint","vec","pointSubtract","magnitude","entityKeysAtPointSelector","ignoreHitRadius","mapEntitiesState","services","mapEditor","getEntityKeysFromRect","result","entityKeysAtRectSelector","potionEffectPrototype","defaultPotionEffects","packageIdObjectsSelector","potionEffects","PotionEffectImages","packageResourcesSelector","iconUrl","Buffer","from","toString","defaultRegion","_defaultState","createEditorMouseReducer","isMapEditorModifierKeysChangedAction","isMapEditorMouseDownAction","currentPointerGesture","mouseDownViewportPos","mouseViewportPos","isMapEditorMouseMoveAction","mouse","mouseDownWorldPos","clientToWorldSelector","entityKeyAtMouse","selectionMode","getSelectMode","detectGestureReducer","currentGesture","previousPos","currentPos","panGestureReducer","gestureReducer","eraserReducer","generateTileEntities","paintDangerZoneReducer","toolReducer","mouseState","isMapEditorMouseOutAction","defaultEditorMouseServiceState","isMapEditorMouseUpAction","worldMouseDownPos","worldMouseUpPos","idsToSelect","completeDragSelect","selection","completeDragMove","selectedKey","completeClick","isMapEditorToolRadiusSetAction","isMapEditorToolSetAction","worldMousePosSelector","worldMouseDownPosSelector","worldMousePos","createEditorMouseSelector","dragStart","dragEnd","view","createMapEditorReducer","isPotionBaseMapEditAction","defaultMapEditorState","isPackageNewAction","isPackageReceiveAction","handleEditorCommit","potionId","select","editingPotionIdSelector","takeLatest","fork","MapModifyActions","handleMapModified","handleMapEdit","pkg","potionBases","mapEntities","location","createEditorSelectionReducer","defaultEditorSelectionState","combineSelection","isMapEditorSelectionDeleteAction","isEntitySelectedSelector","createEditorSelectionSelector","s","createMapEditorSelector","damage","defaultEditorViewState","createEditorViewReducer","newMousePos","createEditorViewSelector","worldToClient","createNavigationReducer","isNavtreeExpandedValuesSetAction","expandedNavTreeValues","createNavigationSelector","defaultNavigationState","objectType","idObject","currentValue","loadError","createPackageReducer","isPackageDataSetByIdAction","loadingStatus","local","index","newPackageData","newPackgeStr","stringifyYaml","newPackageResource","Encoder","encode","isPackageDataSetAction","newPackageStr","isPackageIdObjectNewAction","newItem","newResource","isPackageLoadErrorAction","isPackageLoadFileAction","defaultPackageState","isPackageResourceSetByIdAction","handlePackageLoadFile","endsWith","Error","replace","call","zip","loadAsync","generateAsync","Promise","all","entries","resourcePath","async","message","savePackage","packageIdSelector","zipData","buildZip","window","showSaveFilePicker","saveNativeFileApi","saveLegacy","warn","binary","compression","fileHandle","suggestedName","types","writable","createWritable","write","close","blob","saveAs","takeEvery","cacheResources","cacheYaml","entry","createPackageSelector","yamlStr","packageTextResourceSelector","yaml","parseYaml","resourePath","ids","k1","packageResourceSelector","Utf8Decoder","decode","serviceKeys","oldState","newState","appSelector","defaultServicesState","navigation","package","resolveImport","importTag","identify","tag","resolve","doc","cst","strValue","imported","parse","customTags","stringify","selectors","actionsBlacklist","undefined","persistedState","stateJson","localStorage","getItem","PERSISTED_STATE_KEY","JSON","getStoredState","lastPersistedState","buildPersistedState","setItem","setStoredState","servicesSaga","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","actionSanitizer","stateSanitizer","compose","sagaMiddleware","initialState","loadPersistedState","applyMiddleware","run","savePersistedState","createStore","TextDecoder","TextEncoder"],"sourceRoot":""}